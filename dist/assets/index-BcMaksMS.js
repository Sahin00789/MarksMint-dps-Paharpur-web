import{a as Bh,b as Vh,g as Uh,r as L,u as ps,R as fr,c as mn,L as Qt,d as Hh,N as Wh,e as zh,f as jt,O as Ll,h as si,B as Gh}from"./react-dme7fUNV.js";import{a as $h,y as cr,f as Ks,p as Kh,L as Xh}from"./vendor-6bTaDfbH.js";import"./ui-Dj0Civ93.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function a(s){if(s.ep)return;s.ep=!0;const n=r(s);fetch(s.href,n)}})();var jn={exports:{}},Ca={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r0;function Yh(){if(r0)return Ca;r0=1;var e=Bh(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n={key:!0,ref:!0,__self:!0,__source:!0};function i(o,l,u){var f,d={},h=null,p=null;u!==void 0&&(h=""+u),l.key!==void 0&&(h=""+l.key),l.ref!==void 0&&(p=l.ref);for(f in l)a.call(l,f)&&!n.hasOwnProperty(f)&&(d[f]=l[f]);if(o&&o.defaultProps)for(f in l=o.defaultProps,l)d[f]===void 0&&(d[f]=l[f]);return{$$typeof:t,type:o,key:h,ref:p,props:d,_owner:s.current}}return Ca.Fragment=r,Ca.jsx=i,Ca.jsxs=i,Ca}var a0;function qh(){return a0||(a0=1,jn.exports=Yh()),jn.exports}var c=qh(),Ns={},s0;function Qh(){if(s0)return Ns;s0=1;var e=Vh();return Ns.createRoot=e.createRoot,Ns.hydrateRoot=e.hydrateRoot,Ns}var Jh=Qh();const Zh=Uh(Jh);var pn=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},gn=typeof window>"u"||"Deno"in globalThis;function Wt(){}function ex(e,t){return typeof e=="function"?e(t):e}function tx(e){return typeof e=="number"&&e>=0&&e!==1/0}function rx(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ni(e,t){return typeof e=="function"?e(t):e}function ax(e,t){return typeof e=="function"?e(t):e}function n0(e,t){const{type:r="all",exact:a,fetchStatus:s,predicate:n,queryKey:i,stale:o}=e;if(i){if(a){if(t.queryHash!==Ui(i,t.options))return!1}else if(!Ja(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||n&&!n(t))}function i0(e,t){const{exact:r,status:a,predicate:s,mutationKey:n}=e;if(n){if(!t.options.mutationKey)return!1;if(r){if(Qa(t.options.mutationKey)!==Qa(n))return!1}else if(!Ja(t.options.mutationKey,n))return!1}return!(a&&t.state.status!==a||s&&!s(t))}function Ui(e,t){return(t?.queryKeyHashFn||Qa)(e)}function Qa(e){return JSON.stringify(e,(t,r)=>ii(r)?Object.keys(r).sort().reduce((a,s)=>(a[s]=r[s],a),{}):r)}function Ja(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Ja(e[r],t[r])):!1}var sx=Object.prototype.hasOwnProperty;function Bl(e,t){if(e===t)return e;const r=o0(e)&&o0(t);if(!r&&!(ii(e)&&ii(t)))return t;const s=(r?e:Object.keys(e)).length,n=r?t:Object.keys(t),i=n.length,o=r?new Array(i):{};let l=0;for(let u=0;u<i;u++){const f=r?u:n[u],d=e[f],h=t[f];if(d===h){o[f]=d,(r?u<s:sx.call(e,f))&&l++;continue}if(d===null||h===null||typeof d!="object"||typeof h!="object"){o[f]=h;continue}const p=Bl(d,h);o[f]=p,p===d&&l++}return s===i&&l===s?e:o}function o0(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function ii(e){if(!c0(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!c0(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function c0(e){return Object.prototype.toString.call(e)==="[object Object]"}function nx(e){return new Promise(t=>{setTimeout(t,e)})}function ix(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Bl(e,t):t}function ox(e,t,r=0){const a=[...e,t];return r&&a.length>r?a.slice(1):a}function cx(e,t,r=0){const a=[t,...e];return r&&a.length>r?a.slice(0,-1):a}var Hi=Symbol();function Vl(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===Hi?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var lx=class extends pn{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!gn&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Ul=new lx,fx=class extends pn{#e=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!gn&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(r=>{r(e)}))}isOnline(){return this.#e}},Xs=new fx;function ux(){let e,t;const r=new Promise((s,n)=>{e=s,t=n});r.status="pending",r.catch(()=>{});function a(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{a({status:"fulfilled",value:s}),e(s)},r.reject=s=>{a({status:"rejected",reason:s}),t(s)},r}function dx(e){return Math.min(1e3*2**e,3e4)}function Hl(e){return(e??"online")==="online"?Xs.isOnline():!0}var oi=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function Wl(e){let t=!1,r=0,a;const s=ux(),n=()=>s.status!=="pending",i=m=>{if(!n()){const g=new oi(m);h(g),e.onCancel?.(g)}},o=()=>{t=!0},l=()=>{t=!1},u=()=>Ul.isFocused()&&(e.networkMode==="always"||Xs.isOnline())&&e.canRun(),f=()=>Hl(e.networkMode)&&e.canRun(),d=m=>{n()||(a?.(),s.resolve(m))},h=m=>{n()||(a?.(),s.reject(m))},p=()=>new Promise(m=>{a=g=>{(n()||u())&&m(g)},e.onPause?.()}).then(()=>{a=void 0,n()||e.onContinue?.()}),x=()=>{if(n())return;let m;const g=r===0?e.initialPromise:void 0;try{m=g??e.fn()}catch(y){m=Promise.reject(y)}Promise.resolve(m).then(d).catch(y=>{if(n())return;const T=e.retry??(gn?0:3),v=e.retryDelay??dx,R=typeof v=="function"?v(r,y):v,D=T===!0||typeof T=="number"&&r<T||typeof T=="function"&&T(r,y);if(t||!D){h(y);return}r++,e.onFail?.(r,y),nx(R).then(()=>u()?void 0:p()).then(()=>{t?h(y):x()})})};return{promise:s,status:()=>s.status,cancel:i,continue:()=>(a?.(),s),cancelRetry:o,continueRetry:l,canStart:f,start:()=>(f()?x():p().then(x),s)}}var hx=e=>setTimeout(e,0);function xx(){let e=[],t=0,r=o=>{o()},a=o=>{o()},s=hx;const n=o=>{t?e.push(o):s(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&s(()=>{a(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{n(()=>{o(...l)})},schedule:n,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{a=o},setScheduler:o=>{s=o}}}var pt=xx(),zl=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),tx(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(gn?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},mx=class extends zl{#e;#t;#r;#s;#a;#i;#o;constructor(e){super(),this.#o=!1,this.#i=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#s=e.client,this.#r=this.#s.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=gx(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#a?.promise}setOptions(e){this.options={...this.#i,...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(e,t){const r=ix(this.state.data,e,this.options);return this.#n({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#n({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#a?.promise;return this.#a?.cancel(e),t?t.then(Wt).catch(Wt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>ax(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Hi||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>ni(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!rx(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#a?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#a?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#a&&(this.#o?this.#a.cancel({revert:!0}):this.#a.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#n({type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&this.#a?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#a)return this.#a.continueRetry(),this.#a.promise}if(e&&this.setOptions(e),!this.options.queryFn){const o=this.observers.find(l=>l.options.queryFn);o&&this.setOptions(o.options)}const r=new AbortController,a=o=>{Object.defineProperty(o,"signal",{enumerable:!0,get:()=>(this.#o=!0,r.signal)})},s=()=>{const o=Vl(this.options,t),u=(()=>{const f={client:this.#s,queryKey:this.queryKey,meta:this.meta};return a(f),f})();return this.#o=!1,this.options.persister?this.options.persister(o,u,this):o(u)},i=(()=>{const o={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#s,state:this.state,fetchFn:s};return a(o),o})();this.options.behavior?.onFetch(i,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==i.fetchOptions?.meta)&&this.#n({type:"fetch",meta:i.fetchOptions?.meta}),this.#a=Wl({initialPromise:t?.initialPromise,fn:i.fetchFn,onCancel:o=>{o instanceof oi&&o.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(o,l)=>{this.#n({type:"failed",failureCount:o,error:l})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0});try{const o=await this.#a.start();if(o===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(o),this.#r.config.onSuccess?.(o,this),this.#r.config.onSettled?.(o,this.state.error,this),o}catch(o){if(o instanceof oi){if(o.silent)return this.#a.promise;if(o.revert){if(this.state.data===void 0)throw o;return this.state.data}}throw this.#n({type:"error",error:o}),this.#r.config.onError?.(o,this),this.#r.config.onSettled?.(this.state.data,o,this),o}finally{this.scheduleGc()}}#n(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...px(r.data,this.options),fetchMeta:e.meta??null};case"success":const a={...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const s=e.error;return{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),pt.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:e})})}};function px(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Hl(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function gx(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,a=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var vx=class extends pn{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,r){const a=t.queryKey,s=t.queryHash??Ui(a,t);let n=this.get(s);return n||(n=new mx({client:e,queryKey:a,queryHash:s,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(a)}),this.add(n)),n}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){pt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>n0(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>n0(e,r)):t}notify(e){pt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){pt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){pt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},yx=class extends zl{#e;#t;#r;constructor(e){super(),this.mutationId=e.mutationId,this.#t=e.mutationCache,this.#e=[],this.state=e.state||wx(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#e.includes(e)||(this.#e.push(e),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#e=this.#e.filter(t=>t!==e),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#s({type:"continue"})};this.#r=Wl({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(s,n)=>{this.#s({type:"failed",failureCount:s,error:n})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const r=this.state.status==="pending",a=!this.#r.canStart();try{if(r)t();else{this.#s({type:"pending",variables:e,isPaused:a}),await this.#t.config.onMutate?.(e,this);const n=await this.options.onMutate?.(e);n!==this.state.context&&this.#s({type:"pending",context:n,variables:e,isPaused:a})}const s=await this.#r.start();return await this.#t.config.onSuccess?.(s,e,this.state.context,this),await this.options.onSuccess?.(s,e,this.state.context),await this.#t.config.onSettled?.(s,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(s,null,e,this.state.context),this.#s({type:"success",data:s}),s}catch(s){try{throw await this.#t.config.onError?.(s,e,this.state.context,this),await this.options.onError?.(s,e,this.state.context),await this.#t.config.onSettled?.(void 0,s,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,s,e,this.state.context),s}finally{this.#s({type:"error",error:s})}}finally{this.#t.runNext(this)}}#s(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),pt.batch(()=>{this.#e.forEach(r=>{r.onMutationUpdate(e)}),this.#t.notify({mutation:this,type:"updated",action:e})})}};function wx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var kx=class extends pn{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(e,t,r){const a=new yx({mutationCache:this,mutationId:++this.#r,options:e.defaultMutationOptions(t),state:r});return this.add(a),a}add(e){this.#e.add(e);const t=Cs(e);if(typeof t=="string"){const r=this.#t.get(t);r?r.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=Cs(e);if(typeof t=="string"){const r=this.#t.get(t);if(r)if(r.length>1){const a=r.indexOf(e);a!==-1&&r.splice(a,1)}else r[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=Cs(e);if(typeof t=="string"){const a=this.#t.get(t)?.find(s=>s.state.status==="pending");return!a||a===e}else return!0}runNext(e){const t=Cs(e);return typeof t=="string"?this.#t.get(t)?.find(a=>a!==e&&a.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){pt.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(r=>i0(t,r))}findAll(e={}){return this.getAll().filter(t=>i0(e,t))}notify(e){pt.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return pt.batch(()=>Promise.all(e.map(t=>t.continue().catch(Wt))))}};function Cs(e){return e.options.scope?.id}function l0(e){return{onFetch:(t,r)=>{const a=t.options,s=t.fetchOptions?.meta?.fetchMore?.direction,n=t.state.data?.pages||[],i=t.state.data?.pageParams||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let f=!1;const d=x=>{Object.defineProperty(x,"signal",{enumerable:!0,get:()=>(t.signal.aborted?f=!0:t.signal.addEventListener("abort",()=>{f=!0}),t.signal)})},h=Vl(t.options,t.fetchOptions),p=async(x,m,g)=>{if(f)return Promise.reject();if(m==null&&x.pages.length)return Promise.resolve(x);const T=(()=>{const b={client:t.client,queryKey:t.queryKey,pageParam:m,direction:g?"backward":"forward",meta:t.options.meta};return d(b),b})(),v=await h(T),{maxPages:R}=t.options,D=g?cx:ox;return{pages:D(x.pages,v,R),pageParams:D(x.pageParams,m,R)}};if(s&&n.length){const x=s==="backward",m=x?bx:f0,g={pages:n,pageParams:i},y=m(a,g);o=await p(g,y,x)}else{const x=e??n.length;do{const m=l===0?i[0]??a.initialPageParam:f0(a,o);if(l>0&&m==null)break;o=await p(o,m),l++}while(l<x)}return o};t.options.persister?t.fetchFn=()=>t.options.persister?.(u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=u}}}function f0(e,{pages:t,pageParams:r}){const a=t.length-1;return t.length>0?e.getNextPageParam(t[a],t,r[a],r):void 0}function bx(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var Tx=class{#e;#t;#r;#s;#a;#i;#o;#n;constructor(e={}){this.#e=e.queryCache||new vx,this.#t=e.mutationCache||new kx,this.#r=e.defaultOptions||{},this.#s=new Map,this.#a=new Map,this.#i=0}mount(){this.#i++,this.#i===1&&(this.#o=Ul.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#n=Xs.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#i--,this.#i===0&&(this.#o?.(),this.#o=void 0,this.#n?.(),this.#n=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#e.build(this,t),a=r.state.data;return a===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(ni(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(a))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:r})=>{const a=r.data;return[t,a]})}setQueryData(e,t,r){const a=this.defaultQueryOptions({queryKey:e}),n=this.#e.get(a.queryHash)?.state.data,i=ex(t,n);if(i!==void 0)return this.#e.build(this,a).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return pt.batch(()=>this.#e.findAll(e).map(({queryKey:a})=>[a,this.setQueryData(a,t,r)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;pt.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=this.#e;return pt.batch(()=>(r.findAll(e).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},a=pt.batch(()=>this.#e.findAll(e).map(s=>s.cancel(r)));return Promise.all(a).then(Wt).catch(Wt)}invalidateQueries(e,t={}){return pt.batch(()=>(this.#e.findAll(e).forEach(r=>{r.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},a=pt.batch(()=>this.#e.findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let n=s.fetch(void 0,r);return r.throwOnError||(n=n.catch(Wt)),s.state.fetchStatus==="paused"?Promise.resolve():n}));return Promise.all(a).then(Wt)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=this.#e.build(this,t);return r.isStaleByTime(ni(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Wt).catch(Wt)}fetchInfiniteQuery(e){return e.behavior=l0(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Wt).catch(Wt)}ensureInfiniteQueryData(e){return e.behavior=l0(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Xs.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(e){this.#r=e}setQueryDefaults(e,t){this.#s.set(Qa(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#s.values()],r={};return t.forEach(a=>{Ja(e,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(e,t){this.#a.set(Qa(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#a.values()],r={};return t.forEach(a=>{Ja(e,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#r.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Ui(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Hi&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#r.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},Ex=L.createContext(void 0),_x=({client:e,children:t})=>(L.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(Ex.Provider,{value:e,children:t}));const Gl=L.createContext(),$l=({children:e})=>{const[t,r]=L.useState(()=>{const s=localStorage.getItem("theme");return s||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")});L.useEffect(()=>{document.documentElement.setAttribute("data-theme",t),document.documentElement.classList.toggle("dark",t==="dark"),localStorage.setItem("theme",t)},[t]);const a=()=>{r(s=>s==="light"?"dark":"light")};return c.jsx(Gl.Provider,{value:{theme:t,toggleTheme:a},children:e})},vn=()=>{const e=L.useContext(Gl);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},Sx="https://marksmint-dps-paharpur-server.onrender.com/api",Pe=$h.create({baseURL:Sx,withCredentials:!0,headers:{"Content-Type":"application/json"}});Pe.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Pe.interceptors.response.use(e=>e,e=>(e.response?.status===401&&(localStorage.removeItem("token"),window.location.href="/login"),Promise.reject(e)));const Kl=L.createContext(),Ax=({children:e})=>{const t=x=>{try{if(typeof window>"u")return console.warn("localStorage not available (server-side rendering)"),null;const m=localStorage.getItem(x);return console.debug(`[Auth] Get ${x}:`,m?"(exists)":"null"),m}catch(m){return console.error(`[Auth] Error accessing localStorage key '${x}':`,m),null}},r=(x,m)=>{try{return typeof window>"u"?!1:(console.debug(`[Auth] Set ${x}:`,m),localStorage.setItem(x,m),!0)}catch(g){return console.error(`[Auth] Error setting localStorage key '${x}':`,g),!1}},a=x=>{try{return typeof window>"u"?!1:(console.debug(`[Auth] Remove ${x}`),localStorage.removeItem(x),!0)}catch(m){return console.error(`[Auth] Error removing localStorage key '${x}':`,m),!1}},s=()=>{console.log("[Auth] Clearing authentication data"),a("user"),a("token"),i(null)},[n,i]=L.useState(()=>{try{const x=t("user");if(!x)return null;const m=JSON.parse(x);if(typeof m!="object"||m===null)throw new Error("Invalid user data format");if(!m.id||!m.username)throw new Error("Invalid user data: missing required fields");return m}catch(x){return console.error("Error initializing user:",x),a("user"),a("token"),null}}),[o,l]=L.useState(!1),u=ps(),f=n;L.useEffect(()=>{(async()=>{const m=t("token");if(m)try{const g=await Pe.get("/auth/verify");if(g.data&&g.data.user)r("user",JSON.stringify(g.data.user)),i(g.data.user),Pe.defaults.headers.common.Authorization=`Bearer ${m}`;else throw new Error("Invalid response from server")}catch(g){console.error("Token verification failed:",g),s(),g.response?.status!==401&&console.error("Auth check failed:",new Error("Session expired. Please log in again."))}l(!1)})()},[]);const p={user:n,currentUser:f,loading:o,isAuthenticated:!!n,login:async x=>{try{l(!0),console.log("[Auth] Attempting login with:",x);const m=await Pe.post("/auth/login",x);if(m.data&&m.data.token){const{token:g,user:y}=m.data;if(!r("token",g)||!r("user",JSON.stringify(y)))throw new Error("Failed to store authentication data");return Pe.defaults.headers.common.Authorization=`Bearer ${g}`,console.log("[Auth] Login successful for user:",y.username),await new Promise(T=>{i(y),setTimeout(T,50)}),{success:!0,user:y}}else throw new Error("Invalid response from server")}catch(m){return console.error("Login failed:",m),a("token"),a("user"),localStorage.removeItem("user"),i(null),{success:!1,error:m.message||"Login failed. Please try again."}}},logout:async()=>{try{console.log("[Auth] Logging out user:",n?.username),await Pe.post("/auth/logout")}catch(x){console.error("[Auth] Logout API error (proceeding with local cleanup):",x)}finally{s(),delete Pe.defaults.headers.common.Authorization,u("/login",{replace:!0})}}};return c.jsx(Kl.Provider,{value:p,children:!o&&e})},yn=()=>{const e=L.useContext(Kl);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e},Wi=L.createContext({});function zi(e){const t=L.useRef(null);return t.current===null&&(t.current=e()),t.current}const Gi=typeof window<"u",Xl=Gi?L.useLayoutEffect:L.useEffect,wn=L.createContext(null);function $i(e,t){e.indexOf(t)===-1&&e.push(t)}function Ki(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const hr=(e,t,r)=>r>t?t:r<e?e:r;let Xi=()=>{};const xr={},Yl=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function ql(e){return typeof e=="object"&&e!==null}const Ql=e=>/^0[^.\s]+$/u.test(e);function Yi(e){let t;return()=>(t===void 0&&(t=e()),t)}const It=e=>e,Nx=(e,t)=>r=>t(e(r)),gs=(...e)=>e.reduce(Nx),Za=(e,t,r)=>{const a=t-e;return a===0?1:(r-e)/a};class qi{constructor(){this.subscriptions=[]}add(t){return $i(this.subscriptions,t),()=>Ki(this.subscriptions,t)}notify(t,r,a){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,a);else for(let n=0;n<s;n++){const i=this.subscriptions[n];i&&i(t,r,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Zt=e=>e*1e3,er=e=>e/1e3;function Jl(e,t){return t?e*(1e3/t):0}const Zl=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Cx=1e-7,Fx=12;function jx(e,t,r,a,s){let n,i,o=0;do i=t+(r-t)/2,n=Zl(i,a,s)-e,n>0?r=i:t=i;while(Math.abs(n)>Cx&&++o<Fx);return i}function vs(e,t,r,a){if(e===t&&r===a)return It;const s=n=>jx(n,0,1,e,r);return n=>n===0||n===1?n:Zl(s(n),t,a)}const ef=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,tf=e=>t=>1-e(1-t),rf=vs(.33,1.53,.69,.99),Qi=tf(rf),af=ef(Qi),sf=e=>(e*=2)<1?.5*Qi(e):.5*(2-Math.pow(2,-10*(e-1))),Ji=e=>1-Math.sin(Math.acos(e)),nf=tf(Ji),of=ef(Ji),Px=vs(.42,0,1,1),Dx=vs(0,0,.58,1),cf=vs(.42,0,.58,1),Rx=e=>Array.isArray(e)&&typeof e[0]!="number",lf=e=>Array.isArray(e)&&typeof e[0]=="number",Mx={linear:It,easeIn:Px,easeInOut:cf,easeOut:Dx,circIn:Ji,circInOut:of,circOut:nf,backIn:Qi,backInOut:af,backOut:rf,anticipate:sf},Ox=e=>typeof e=="string",u0=e=>{if(lf(e)){Xi(e.length===4);const[t,r,a,s]=e;return vs(t,r,a,s)}else if(Ox(e))return Mx[e];return e},Fs=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Ix(e,t){let r=new Set,a=new Set,s=!1,n=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(f){i.has(f)&&(u.schedule(f),e()),f(o)}const u={schedule:(f,d=!1,h=!1)=>{const x=h&&s?r:a;return d&&i.add(f),x.has(f)||x.add(f),f},cancel:f=>{a.delete(f),i.delete(f)},process:f=>{if(o=f,s){n=!0;return}s=!0,[r,a]=[a,r],r.forEach(l),r.clear(),s=!1,n&&(n=!1,u.process(f))}};return u}const Lx=40;function ff(e,t){let r=!1,a=!0;const s={delta:0,timestamp:0,isProcessing:!1},n=()=>r=!0,i=Fs.reduce((v,R)=>(v[R]=Ix(n),v),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:f,update:d,preRender:h,render:p,postRender:x}=i,m=()=>{const v=xr.useManualTiming?s.timestamp:performance.now();r=!1,xr.useManualTiming||(s.delta=a?1e3/60:Math.max(Math.min(v-s.timestamp,Lx),1)),s.timestamp=v,s.isProcessing=!0,o.process(s),l.process(s),u.process(s),f.process(s),d.process(s),h.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&t&&(a=!1,e(m))},g=()=>{r=!0,a=!0,s.isProcessing||e(m)};return{schedule:Fs.reduce((v,R)=>{const D=i[R];return v[R]=(b,k=!1,S=!1)=>(r||g(),D.schedule(b,k,S)),v},{}),cancel:v=>{for(let R=0;R<Fs.length;R++)i[Fs[R]].cancel(v)},state:s,steps:i}}const{schedule:De,cancel:Ar,state:tt,steps:Pn}=ff(typeof requestAnimationFrame<"u"?requestAnimationFrame:It,!0);let Ws;function Bx(){Ws=void 0}const Tt={now:()=>(Ws===void 0&&Tt.set(tt.isProcessing||xr.useManualTiming?tt.timestamp:performance.now()),Ws),set:e=>{Ws=e,queueMicrotask(Bx)}},uf=e=>t=>typeof t=="string"&&t.startsWith(e),Zi=uf("--"),Vx=uf("var(--"),eo=e=>Vx(e)?Ux.test(e.split("/*")[0].trim()):!1,Ux=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,va={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},es={...va,transform:e=>hr(0,1,e)},js={...va,default:1},Ia=e=>Math.round(e*1e5)/1e5,to=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Hx(e){return e==null}const Wx=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,ro=(e,t)=>r=>!!(typeof r=="string"&&Wx.test(r)&&r.startsWith(e)||t&&!Hx(r)&&Object.prototype.hasOwnProperty.call(r,t)),df=(e,t,r)=>a=>{if(typeof a!="string")return a;const[s,n,i,o]=a.match(to);return{[e]:parseFloat(s),[t]:parseFloat(n),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},zx=e=>hr(0,255,e),Dn={...va,transform:e=>Math.round(zx(e))},Lr={test:ro("rgb","red"),parse:df("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+Dn.transform(e)+", "+Dn.transform(t)+", "+Dn.transform(r)+", "+Ia(es.transform(a))+")"};function Gx(e){let t="",r="",a="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,a+=a,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:s?parseInt(s,16)/255:1}}const ci={test:ro("#"),parse:Gx,transform:Lr.transform},ys=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),br=ys("deg"),tr=ys("%"),xe=ys("px"),$x=ys("vh"),Kx=ys("vw"),d0={...tr,parse:e=>tr.parse(e)/100,transform:e=>tr.transform(e*100)},ra={test:ro("hsl","hue"),parse:df("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+tr.transform(Ia(t))+", "+tr.transform(Ia(r))+", "+Ia(es.transform(a))+")"},Xe={test:e=>Lr.test(e)||ci.test(e)||ra.test(e),parse:e=>Lr.test(e)?Lr.parse(e):ra.test(e)?ra.parse(e):ci.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Lr.transform(e):ra.transform(e),getAnimatableNone:e=>{const t=Xe.parse(e);return t.alpha=0,Xe.transform(t)}},Xx=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function Yx(e){return isNaN(e)&&typeof e=="string"&&(e.match(to)?.length||0)+(e.match(Xx)?.length||0)>0}const hf="number",xf="color",qx="var",Qx="var(",h0="${}",Jx=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function ts(e){const t=e.toString(),r=[],a={color:[],number:[],var:[]},s=[];let n=0;const o=t.replace(Jx,l=>(Xe.test(l)?(a.color.push(n),s.push(xf),r.push(Xe.parse(l))):l.startsWith(Qx)?(a.var.push(n),s.push(qx),r.push(l)):(a.number.push(n),s.push(hf),r.push(parseFloat(l))),++n,h0)).split(h0);return{values:r,split:o,indexes:a,types:s}}function mf(e){return ts(e).values}function pf(e){const{split:t,types:r}=ts(e),a=t.length;return s=>{let n="";for(let i=0;i<a;i++)if(n+=t[i],s[i]!==void 0){const o=r[i];o===hf?n+=Ia(s[i]):o===xf?n+=Xe.transform(s[i]):n+=s[i]}return n}}const Zx=e=>typeof e=="number"?0:Xe.test(e)?Xe.getAnimatableNone(e):e;function e1(e){const t=mf(e);return pf(e)(t.map(Zx))}const Nr={test:Yx,parse:mf,createTransformer:pf,getAnimatableNone:e1};function Rn(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function t1({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,t/=100,r/=100;let s=0,n=0,i=0;if(!t)s=n=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,l=2*r-o;s=Rn(l,o,e+1/3),n=Rn(l,o,e),i=Rn(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(n*255),blue:Math.round(i*255),alpha:a}}function Ys(e,t){return r=>r>0?t:e}const Oe=(e,t,r)=>e+(t-e)*r,Mn=(e,t,r)=>{const a=e*e,s=r*(t*t-a)+a;return s<0?0:Math.sqrt(s)},r1=[ci,Lr,ra],a1=e=>r1.find(t=>t.test(e));function x0(e){const t=a1(e);if(!t)return!1;let r=t.parse(e);return t===ra&&(r=t1(r)),r}const m0=(e,t)=>{const r=x0(e),a=x0(t);if(!r||!a)return Ys(e,t);const s={...r};return n=>(s.red=Mn(r.red,a.red,n),s.green=Mn(r.green,a.green,n),s.blue=Mn(r.blue,a.blue,n),s.alpha=Oe(r.alpha,a.alpha,n),Lr.transform(s))},li=new Set(["none","hidden"]);function s1(e,t){return li.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function n1(e,t){return r=>Oe(e,t,r)}function ao(e){return typeof e=="number"?n1:typeof e=="string"?eo(e)?Ys:Xe.test(e)?m0:c1:Array.isArray(e)?gf:typeof e=="object"?Xe.test(e)?m0:i1:Ys}function gf(e,t){const r=[...e],a=r.length,s=e.map((n,i)=>ao(n)(n,t[i]));return n=>{for(let i=0;i<a;i++)r[i]=s[i](n);return r}}function i1(e,t){const r={...e,...t},a={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(a[s]=ao(e[s])(e[s],t[s]));return s=>{for(const n in a)r[n]=a[n](s);return r}}function o1(e,t){const r=[],a={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const n=t.types[s],i=e.indexes[n][a[n]],o=e.values[i]??0;r[s]=o,a[n]++}return r}const c1=(e,t)=>{const r=Nr.createTransformer(t),a=ts(e),s=ts(t);return a.indexes.var.length===s.indexes.var.length&&a.indexes.color.length===s.indexes.color.length&&a.indexes.number.length>=s.indexes.number.length?li.has(e)&&!s.values.length||li.has(t)&&!a.values.length?s1(e,t):gs(gf(o1(a,s),s.values),r):Ys(e,t)};function vf(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Oe(e,t,r):ao(e)(e,t)}const l1=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>De.update(t,r),stop:()=>Ar(t),now:()=>tt.isProcessing?tt.timestamp:Tt.now()}},yf=(e,t,r=10)=>{let a="";const s=Math.max(Math.round(t/r),2);for(let n=0;n<s;n++)a+=Math.round(e(n/(s-1))*1e4)/1e4+", ";return`linear(${a.substring(0,a.length-2)})`},qs=2e4;function so(e){let t=0;const r=50;let a=e.next(t);for(;!a.done&&t<qs;)t+=r,a=e.next(t);return t>=qs?1/0:t}function f1(e,t=100,r){const a=r({...e,keyframes:[0,t]}),s=Math.min(so(a),qs);return{type:"keyframes",ease:n=>a.next(s*n).value/t,duration:er(s)}}const u1=5;function wf(e,t,r){const a=Math.max(t-u1,0);return Jl(r-e(a),t-a)}const Ie={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},On=.001;function d1({duration:e=Ie.duration,bounce:t=Ie.bounce,velocity:r=Ie.velocity,mass:a=Ie.mass}){let s,n,i=1-t;i=hr(Ie.minDamping,Ie.maxDamping,i),e=hr(Ie.minDuration,Ie.maxDuration,er(e)),i<1?(s=u=>{const f=u*i,d=f*e,h=f-r,p=fi(u,i),x=Math.exp(-d);return On-h/p*x},n=u=>{const d=u*i*e,h=d*r+r,p=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-d),m=fi(Math.pow(u,2),i);return(-s(u)+On>0?-1:1)*((h-p)*x)/m}):(s=u=>{const f=Math.exp(-u*e),d=(u-r)*e+1;return-On+f*d},n=u=>{const f=Math.exp(-u*e),d=(r-u)*(e*e);return f*d});const o=5/e,l=x1(s,n,o);if(e=Zt(e),isNaN(l))return{stiffness:Ie.stiffness,damping:Ie.damping,duration:e};{const u=Math.pow(l,2)*a;return{stiffness:u,damping:i*2*Math.sqrt(a*u),duration:e}}}const h1=12;function x1(e,t,r){let a=r;for(let s=1;s<h1;s++)a=a-e(a)/t(a);return a}function fi(e,t){return e*Math.sqrt(1-t*t)}const m1=["duration","bounce"],p1=["stiffness","damping","mass"];function p0(e,t){return t.some(r=>e[r]!==void 0)}function g1(e){let t={velocity:Ie.velocity,stiffness:Ie.stiffness,damping:Ie.damping,mass:Ie.mass,isResolvedFromDuration:!1,...e};if(!p0(e,p1)&&p0(e,m1))if(e.visualDuration){const r=e.visualDuration,a=2*Math.PI/(r*1.2),s=a*a,n=2*hr(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Ie.mass,stiffness:s,damping:n}}else{const r=d1(e);t={...t,...r,mass:Ie.mass},t.isResolvedFromDuration=!0}return t}function Qs(e=Ie.visualDuration,t=Ie.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:s}=r;const n=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:n},{stiffness:l,damping:u,mass:f,duration:d,velocity:h,isResolvedFromDuration:p}=g1({...r,velocity:-er(r.velocity||0)}),x=h||0,m=u/(2*Math.sqrt(l*f)),g=i-n,y=er(Math.sqrt(l/f)),T=Math.abs(g)<5;a||(a=T?Ie.restSpeed.granular:Ie.restSpeed.default),s||(s=T?Ie.restDelta.granular:Ie.restDelta.default);let v;if(m<1){const D=fi(y,m);v=b=>{const k=Math.exp(-m*y*b);return i-k*((x+m*y*g)/D*Math.sin(D*b)+g*Math.cos(D*b))}}else if(m===1)v=D=>i-Math.exp(-y*D)*(g+(x+y*g)*D);else{const D=y*Math.sqrt(m*m-1);v=b=>{const k=Math.exp(-m*y*b),S=Math.min(D*b,300);return i-k*((x+m*y*g)*Math.sinh(S)+D*g*Math.cosh(S))/D}}const R={calculatedDuration:p&&d||null,next:D=>{const b=v(D);if(p)o.done=D>=d;else{let k=D===0?x:0;m<1&&(k=D===0?Zt(x):wf(v,D,b));const S=Math.abs(k)<=a,P=Math.abs(i-b)<=s;o.done=S&&P}return o.value=o.done?i:b,o},toString:()=>{const D=Math.min(so(R),qs),b=yf(k=>R.next(D*k).value,D,30);return D+"ms "+b},toTransition:()=>{}};return R}Qs.applyToOptions=e=>{const t=f1(e,100,Qs);return e.ease=t.ease,e.duration=Zt(t.duration),e.type="keyframes",e};function ui({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:s=10,bounceStiffness:n=500,modifyTarget:i,min:o,max:l,restDelta:u=.5,restSpeed:f}){const d=e[0],h={done:!1,value:d},p=S=>o!==void 0&&S<o||l!==void 0&&S>l,x=S=>o===void 0?l:l===void 0||Math.abs(o-S)<Math.abs(l-S)?o:l;let m=r*t;const g=d+m,y=i===void 0?g:i(g);y!==g&&(m=y-d);const T=S=>-m*Math.exp(-S/a),v=S=>y+T(S),R=S=>{const P=T(S),H=v(S);h.done=Math.abs(P)<=u,h.value=h.done?y:H};let D,b;const k=S=>{p(h.value)&&(D=S,b=Qs({keyframes:[h.value,x(h.value)],velocity:wf(v,S,h.value),damping:s,stiffness:n,restDelta:u,restSpeed:f}))};return k(0),{calculatedDuration:null,next:S=>{let P=!1;return!b&&D===void 0&&(P=!0,R(S),k(S)),D!==void 0&&S>=D?b.next(S-D):(!P&&R(S),h)}}}function v1(e,t,r){const a=[],s=r||xr.mix||vf,n=e.length-1;for(let i=0;i<n;i++){let o=s(e[i],e[i+1]);if(t){const l=Array.isArray(t)?t[i]||It:t;o=gs(l,o)}a.push(o)}return a}function y1(e,t,{clamp:r=!0,ease:a,mixer:s}={}){const n=e.length;if(Xi(n===t.length),n===1)return()=>t[0];if(n===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[n-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=v1(t,a,s),l=o.length,u=f=>{if(i&&f<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(f<e[d+1]);d++);const h=Za(e[d],e[d+1],f);return o[d](h)};return r?f=>u(hr(e[0],e[n-1],f)):u}function w1(e,t){const r=e[e.length-1];for(let a=1;a<=t;a++){const s=Za(0,t,a);e.push(Oe(r,1,s))}}function k1(e){const t=[0];return w1(t,e.length-1),t}function b1(e,t){return e.map(r=>r*t)}function T1(e,t){return e.map(()=>t||cf).splice(0,e.length-1)}function La({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){const s=Rx(a)?a.map(u0):u0(a),n={done:!1,value:t[0]},i=b1(r&&r.length===t.length?r:k1(t),e),o=y1(i,t,{ease:Array.isArray(s)?s:T1(t,s)});return{calculatedDuration:e,next:l=>(n.value=o(l),n.done=l>=e,n)}}const E1=e=>e!==null;function no(e,{repeat:t,repeatType:r="loop"},a,s=1){const n=e.filter(E1),o=s<0||t&&r!=="loop"&&t%2===1?0:n.length-1;return!o||a===void 0?n[o]:a}const _1={decay:ui,inertia:ui,tween:La,keyframes:La,spring:Qs};function kf(e){typeof e.type=="string"&&(e.type=_1[e.type])}class io{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const S1=e=>e/100;class oo extends io{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==Tt.now()&&this.tick(Tt.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;kf(t);const{type:r=La,repeat:a=0,repeatDelay:s=0,repeatType:n,velocity:i=0}=t;let{keyframes:o}=t;const l=r||La;l!==La&&typeof o[0]!="number"&&(this.mixKeyframes=gs(S1,vf(o[0],o[1])),o=[0,100]);const u=l({...t,keyframes:o});n==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=so(u));const{calculatedDuration:f}=u;this.calculatedDuration=f,this.resolvedDuration=f+s,this.totalDuration=this.resolvedDuration*(a+1)-s,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:a,totalDuration:s,mixKeyframes:n,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return a.next(0);const{delay:u=0,keyframes:f,repeat:d,repeatType:h,repeatDelay:p,type:x,onUpdate:m,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const y=this.currentTime-u*(this.playbackSpeed>=0?1:-1),T=this.playbackSpeed>=0?y<0:y>s;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let v=this.currentTime,R=a;if(d){const S=Math.min(this.currentTime,s)/o;let P=Math.floor(S),H=S%1;!H&&S>=1&&(H=1),H===1&&P--,P=Math.min(P,d+1),!!(P%2)&&(h==="reverse"?(H=1-H,p&&(H-=p/o)):h==="mirror"&&(R=i)),v=hr(0,1,H)*o}const D=T?{done:!1,value:f[0]}:R.next(v);n&&(D.value=n(D.value));let{done:b}=D;!T&&l!==null&&(b=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&b);return k&&x!==ui&&(D.value=no(f,this.options,g,this.speed)),m&&m(D.value),k&&this.finish(),D}then(t,r){return this.finished.then(t,r)}get duration(){return er(this.calculatedDuration)}get time(){return er(this.currentTime)}set time(t){t=Zt(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Tt.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=er(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=l1,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const a=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=a):this.holdTime!==null?this.startTime=a-this.holdTime:this.startTime||(this.startTime=r??a),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Tt.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function A1(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Br=e=>e*180/Math.PI,di=e=>{const t=Br(Math.atan2(e[1],e[0]));return hi(t)},N1={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:di,rotateZ:di,skewX:e=>Br(Math.atan(e[1])),skewY:e=>Br(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},hi=e=>(e=e%360,e<0&&(e+=360),e),g0=di,v0=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),y0=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),C1={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:v0,scaleY:y0,scale:e=>(v0(e)+y0(e))/2,rotateX:e=>hi(Br(Math.atan2(e[6],e[5]))),rotateY:e=>hi(Br(Math.atan2(-e[2],e[0]))),rotateZ:g0,rotate:g0,skewX:e=>Br(Math.atan(e[4])),skewY:e=>Br(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function xi(e){return e.includes("scale")?1:0}function mi(e,t){if(!e||e==="none")return xi(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,s;if(r)a=C1,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=N1,s=o}if(!s)return xi(t);const n=a[t],i=s[1].split(",").map(j1);return typeof n=="function"?n(i):i[n]}const F1=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return mi(r,t)};function j1(e){return parseFloat(e.trim())}const ya=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],wa=new Set(ya),w0=e=>e===va||e===xe,P1=new Set(["x","y","z"]),D1=ya.filter(e=>!P1.has(e));function R1(e){const t=[];return D1.forEach(r=>{const a=e.getValue(r);a!==void 0&&(t.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),t}const Ur={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>mi(t,"x"),y:(e,{transform:t})=>mi(t,"y")};Ur.translateX=Ur.x;Ur.translateY=Ur.y;const Hr=new Set;let pi=!1,gi=!1,vi=!1;function bf(){if(gi){const e=Array.from(Hr).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),r=new Map;t.forEach(a=>{const s=R1(a);s.length&&(r.set(a,s),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const s=r.get(a);s&&s.forEach(([n,i])=>{a.getValue(n)?.set(i)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}gi=!1,pi=!1,Hr.forEach(e=>e.complete(vi)),Hr.clear()}function Tf(){Hr.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(gi=!0)})}function M1(){vi=!0,Tf(),bf(),vi=!1}class co{constructor(t,r,a,s,n,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=a,this.motionValue=s,this.element=n,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Hr.add(this),pi||(pi=!0,De.read(Tf),De.resolveKeyframes(bf))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:a,motionValue:s}=this;if(t[0]===null){const n=s?.get(),i=t[t.length-1];if(n!==void 0)t[0]=n;else if(a&&r){const o=a.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&n===void 0&&s.set(t[0])}A1(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Hr.delete(this)}cancel(){this.state==="scheduled"&&(Hr.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const O1=e=>e.startsWith("--");function I1(e,t,r){O1(t)?e.style.setProperty(t,r):e.style[t]=r}const L1=Yi(()=>window.ScrollTimeline!==void 0),B1={};function V1(e,t){const r=Yi(e);return()=>B1[t]??r()}const Ef=V1(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Pa=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,k0={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Pa([0,.65,.55,1]),circOut:Pa([.55,0,1,.45]),backIn:Pa([.31,.01,.66,-.59]),backOut:Pa([.33,1.53,.69,.99])};function _f(e,t){if(e)return typeof e=="function"?Ef()?yf(e,t):"ease-out":lf(e)?Pa(e):Array.isArray(e)?e.map(r=>_f(r,t)||k0.easeOut):k0[e]}function U1(e,t,r,{delay:a=0,duration:s=300,repeat:n=0,repeatType:i="loop",ease:o="easeOut",times:l}={},u=void 0){const f={[t]:r};l&&(f.offset=l);const d=_f(o,s);Array.isArray(d)&&(f.easing=d);const h={delay:a,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:n+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),e.animate(f,h)}function Sf(e){return typeof e=="function"&&"applyToOptions"in e}function H1({type:e,...t}){return Sf(e)&&Ef()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class W1 extends io{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:a,keyframes:s,pseudoElement:n,allowFlatten:i=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!n,this.allowFlatten=i,this.options=t,Xi(typeof t.type!="string");const u=H1(t);this.animation=U1(r,a,s,u,n),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!n){const f=no(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(f):I1(r,a,f),this.animation.cancel()}l?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return er(Number(t))}get time(){return er(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Zt(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&L1()?(this.animation.timeline=t,It):r(this)}}const Af={anticipate:sf,backInOut:af,circInOut:of};function z1(e){return e in Af}function G1(e){typeof e.ease=="string"&&z1(e.ease)&&(e.ease=Af[e.ease])}const b0=10;class $1 extends W1{constructor(t){G1(t),kf(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:a,onComplete:s,element:n,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new oo({...i,autoplay:!1}),l=Zt(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-b0).value,o.sample(l).value,b0),o.stop()}}const T0=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Nr.test(e)||e==="0")&&!e.startsWith("url("));function K1(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function X1(e,t,r,a){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const n=e[e.length-1],i=T0(s,t),o=T0(n,t);return!i||!o?!1:K1(e)||(r==="spring"||Sf(r))&&a}function yi(e){e.duration=0,e.type}const Y1=new Set(["opacity","clipPath","filter","transform"]),q1=Yi(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Q1(e){const{motionValue:t,name:r,repeatDelay:a,repeatType:s,damping:n,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=t.owner.getProps();return q1()&&r&&Y1.has(r)&&(r!=="transform"||!u)&&!l&&!a&&s!=="mirror"&&n!==0&&i!=="inertia"}const J1=40;class Z1 extends io{constructor({autoplay:t=!0,delay:r=0,type:a="keyframes",repeat:s=0,repeatDelay:n=0,repeatType:i="loop",keyframes:o,name:l,motionValue:u,element:f,...d}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Tt.now();const h={autoplay:t,delay:r,type:a,repeat:s,repeatDelay:n,repeatType:i,name:l,motionValue:u,element:f,...d},p=f?.KeyframeResolver||co;this.keyframeResolver=new p(o,(x,m,g)=>this.onKeyframesResolved(x,m,h,!g),l,u,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,a,s){this.keyframeResolver=void 0;const{name:n,type:i,velocity:o,delay:l,isHandoff:u,onUpdate:f}=a;this.resolvedAt=Tt.now(),X1(t,n,i,o)||((xr.instantAnimations||!l)&&f?.(no(t,a,r)),t[0]=t[t.length-1],yi(a),a.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>J1?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...a,keyframes:t},p=!u&&Q1(h)?new $1({...h,element:h.motionValue.owner.current}):new oo(h);p.finished.then(()=>this.notifyFinished()).catch(It),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),M1()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const em=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function tm(e){const t=em.exec(e);if(!t)return[,];const[,r,a,s]=t;return[`--${r??a}`,s]}function Nf(e,t,r=1){const[a,s]=tm(e);if(!a)return;const n=window.getComputedStyle(t).getPropertyValue(a);if(n){const i=n.trim();return Yl(i)?parseFloat(i):i}return eo(s)?Nf(s,t,r+1):s}function lo(e,t){return e?.[t]??e?.default??e}const Cf=new Set(["width","height","top","left","right","bottom",...ya]),rm={test:e=>e==="auto",parse:e=>e},Ff=e=>t=>t.test(e),jf=[va,xe,tr,br,Kx,$x,rm],E0=e=>jf.find(Ff(e));function am(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Ql(e):!0}const sm=new Set(["brightness","contrast","saturate","opacity"]);function nm(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=r.match(to)||[];if(!a)return e;const s=r.replace(a,"");let n=sm.has(t)?1:0;return a!==r&&(n*=100),t+"("+n+s+")"}const im=/\b([a-z-]*)\(.*?\)/gu,wi={...Nr,getAnimatableNone:e=>{const t=e.match(im);return t?t.map(nm).join(" "):e}},_0={...va,transform:Math.round},om={rotate:br,rotateX:br,rotateY:br,rotateZ:br,scale:js,scaleX:js,scaleY:js,scaleZ:js,skew:br,skewX:br,skewY:br,distance:xe,translateX:xe,translateY:xe,translateZ:xe,x:xe,y:xe,z:xe,perspective:xe,transformPerspective:xe,opacity:es,originX:d0,originY:d0,originZ:xe},fo={borderWidth:xe,borderTopWidth:xe,borderRightWidth:xe,borderBottomWidth:xe,borderLeftWidth:xe,borderRadius:xe,radius:xe,borderTopLeftRadius:xe,borderTopRightRadius:xe,borderBottomRightRadius:xe,borderBottomLeftRadius:xe,width:xe,maxWidth:xe,height:xe,maxHeight:xe,top:xe,right:xe,bottom:xe,left:xe,padding:xe,paddingTop:xe,paddingRight:xe,paddingBottom:xe,paddingLeft:xe,margin:xe,marginTop:xe,marginRight:xe,marginBottom:xe,marginLeft:xe,backgroundPositionX:xe,backgroundPositionY:xe,...om,zIndex:_0,fillOpacity:es,strokeOpacity:es,numOctaves:_0},cm={...fo,color:Xe,backgroundColor:Xe,outlineColor:Xe,fill:Xe,stroke:Xe,borderColor:Xe,borderTopColor:Xe,borderRightColor:Xe,borderBottomColor:Xe,borderLeftColor:Xe,filter:wi,WebkitFilter:wi},Pf=e=>cm[e];function Df(e,t){let r=Pf(e);return r!==wi&&(r=Nr),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const lm=new Set(["auto","none","0"]);function fm(e,t,r){let a=0,s;for(;a<e.length&&!s;){const n=e[a];typeof n=="string"&&!lm.has(n)&&ts(n).values.length&&(s=e[a]),a++}if(s&&r)for(const n of t)e[n]=Df(r,s)}class um extends co{constructor(t,r,a,s,n){super(t,r,a,s,n,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:a}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let u=t[l];if(typeof u=="string"&&(u=u.trim(),eo(u))){const f=Nf(u,r.current);f!==void 0&&(t[l]=f),l===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!Cf.has(a)||t.length!==2)return;const[s,n]=t,i=E0(s),o=E0(n);if(i!==o)if(w0(i)&&w0(o))for(let l=0;l<t.length;l++){const u=t[l];typeof u=="string"&&(t[l]=parseFloat(u))}else Ur[a]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,a=[];for(let s=0;s<t.length;s++)(t[s]===null||am(t[s]))&&a.push(s);a.length&&fm(t,a,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Ur[a](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(a,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const n=a.length-1,i=a[n];a[n]=Ur[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,l])=>{t.getValue(o).set(l)}),this.resolveNoneKeyframes()}}function dm(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const s=r?.[e]??a.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const Rf=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function Mf(e){return ql(e)&&"offsetHeight"in e}const S0=30,hm=e=>!isNaN(parseFloat(e));class xm{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=a=>{const s=Tt.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const n of this.dependents)n.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Tt.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=hm(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new qi);const a=this.events[t].add(r);return t==="change"?()=>{a(),De.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,a){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Tt.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>S0)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,S0);return Jl(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xa(e,t){return new xm(e,t)}const{schedule:uo}=ff(queueMicrotask,!1),Ht={x:!1,y:!1};function Of(){return Ht.x||Ht.y}function mm(e){return e==="x"||e==="y"?Ht[e]?null:(Ht[e]=!0,()=>{Ht[e]=!1}):Ht.x||Ht.y?null:(Ht.x=Ht.y=!0,()=>{Ht.x=Ht.y=!1})}function If(e,t){const r=dm(e),a=new AbortController,s={passive:!0,...t,signal:a.signal};return[r,s,()=>a.abort()]}function A0(e){return!(e.pointerType==="touch"||Of())}function pm(e,t,r={}){const[a,s,n]=If(e,r),i=o=>{if(!A0(o))return;const{target:l}=o,u=t(l,o);if(typeof u!="function"||!l)return;const f=d=>{A0(d)&&(u(d),l.removeEventListener("pointerleave",f))};l.addEventListener("pointerleave",f,s)};return a.forEach(o=>{o.addEventListener("pointerenter",i,s)}),n}const Lf=(e,t)=>t?e===t?!0:Lf(e,t.parentElement):!1,ho=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,gm=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function vm(e){return gm.has(e.tagName)||e.tabIndex!==-1}const zs=new WeakSet;function N0(e){return t=>{t.key==="Enter"&&e(t)}}function In(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const ym=(e,t)=>{const r=e.currentTarget;if(!r)return;const a=N0(()=>{if(zs.has(r))return;In(r,"down");const s=N0(()=>{In(r,"up")}),n=()=>In(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",n,t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)};function C0(e){return ho(e)&&!Of()}function wm(e,t,r={}){const[a,s,n]=If(e,r),i=o=>{const l=o.currentTarget;if(!C0(o))return;zs.add(l);const u=t(l,o),f=(p,x)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),zs.has(l)&&zs.delete(l),C0(p)&&typeof u=="function"&&u(p,{success:x})},d=p=>{f(p,l===window||l===document||r.useGlobalTarget||Lf(l,p.target))},h=p=>{f(p,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return a.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),Mf(o)&&(o.addEventListener("focus",u=>ym(u,s)),!vm(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),n}function Bf(e){return ql(e)&&"ownerSVGElement"in e}function km(e){return Bf(e)&&e.tagName==="svg"}const lt=e=>!!(e&&e.getVelocity),bm=[...jf,Xe,Nr],Tm=e=>bm.find(Ff(e)),xo=L.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Em extends L.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const a=r.offsetParent,s=Mf(a)&&a.offsetWidth||0,n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft,n.right=s-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function _m({children:e,isPresent:t,anchorX:r,root:a}){const s=L.useId(),n=L.useRef(null),i=L.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=L.useContext(xo);return L.useInsertionEffect(()=>{const{width:l,height:u,top:f,left:d,right:h}=i.current;if(t||!n.current||!l||!u)return;const p=r==="left"?`left: ${d}`:`right: ${h}`;n.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const m=a??document.head;return m.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${f}px !important;
          }
        `),()=>{m.contains(x)&&m.removeChild(x)}},[t]),c.jsx(Em,{isPresent:t,childRef:n,sizeRef:i,children:L.cloneElement(e,{ref:n})})}const Sm=({children:e,initial:t,isPresent:r,onExitComplete:a,custom:s,presenceAffectsLayout:n,mode:i,anchorX:o,root:l})=>{const u=zi(Am),f=L.useId();let d=!0,h=L.useMemo(()=>(d=!1,{id:f,initial:t,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;a&&a()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,a]);return n&&d&&(h={...h}),L.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),L.useEffect(()=>{!r&&!u.size&&a&&a()},[r]),i==="popLayout"&&(e=c.jsx(_m,{isPresent:r,anchorX:o,root:l,children:e})),c.jsx(wn.Provider,{value:h,children:e})};function Am(){return new Map}function Vf(e=!0){const t=L.useContext(wn);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:a,register:s}=t,n=L.useId();L.useEffect(()=>{if(e)return s(n)},[e]);const i=L.useCallback(()=>e&&a&&a(n),[n,a,e]);return!r&&a?[!1,i]:[!0]}const Ps=e=>e.key||"";function F0(e){const t=[];return L.Children.forEach(e,r=>{L.isValidElement(r)&&t.push(r)}),t}const mr=({children:e,custom:t,initial:r=!0,onExitComplete:a,presenceAffectsLayout:s=!0,mode:n="sync",propagate:i=!1,anchorX:o="left",root:l})=>{const[u,f]=Vf(i),d=L.useMemo(()=>F0(e),[e]),h=i&&!u?[]:d.map(Ps),p=L.useRef(!0),x=L.useRef(d),m=zi(()=>new Map),[g,y]=L.useState(d),[T,v]=L.useState(d);Xl(()=>{p.current=!1,x.current=d;for(let b=0;b<T.length;b++){const k=Ps(T[b]);h.includes(k)?m.delete(k):m.get(k)!==!0&&m.set(k,!1)}},[T,h.length,h.join("-")]);const R=[];if(d!==g){let b=[...d];for(let k=0;k<T.length;k++){const S=T[k],P=Ps(S);h.includes(P)||(b.splice(k,0,S),R.push(S))}return n==="wait"&&R.length&&(b=R),v(F0(b)),y(d),null}const{forceRender:D}=L.useContext(Wi);return c.jsx(c.Fragment,{children:T.map(b=>{const k=Ps(b),S=i&&!u?!1:d===T||h.includes(k),P=()=>{if(m.has(k))m.set(k,!0);else return;let H=!0;m.forEach(O=>{O||(H=!1)}),H&&(D?.(),v(x.current),i&&f?.(),a&&a())};return c.jsx(Sm,{isPresent:S,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:n,root:l,onExitComplete:S?void 0:P,anchorX:o,children:b},k)})})},Uf=L.createContext({strict:!1}),j0={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ma={};for(const e in j0)ma[e]={isEnabled:t=>j0[e].some(r=>!!t[r])};function Nm(e){for(const t in e)ma[t]={...ma[t],...e[t]}}const Cm=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Js(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Cm.has(e)}let Hf=e=>!Js(e);function Fm(e){typeof e=="function"&&(Hf=t=>t.startsWith("on")?!Js(t):e(t))}try{Fm(require("@emotion/is-prop-valid").default)}catch{}function jm(e,t,r){const a={};for(const s in e)s==="values"&&typeof e.values=="object"||(Hf(s)||r===!0&&Js(s)||!t&&!Js(s)||e.draggable&&s.startsWith("onDrag"))&&(a[s]=e[s]);return a}const kn=L.createContext({});function bn(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function rs(e){return typeof e=="string"||Array.isArray(e)}const mo=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],po=["initial",...mo];function Tn(e){return bn(e.animate)||po.some(t=>rs(e[t]))}function Wf(e){return!!(Tn(e)||e.variants)}function Pm(e,t){if(Tn(e)){const{initial:r,animate:a}=e;return{initial:r===!1||rs(r)?r:void 0,animate:rs(a)?a:void 0}}return e.inherit!==!1?t:{}}function Dm(e){const{initial:t,animate:r}=Pm(e,L.useContext(kn));return L.useMemo(()=>({initial:t,animate:r}),[P0(t),P0(r)])}function P0(e){return Array.isArray(e)?e.join(" "):e}const as={};function Rm(e){for(const t in e)as[t]=e[t],Zi(t)&&(as[t].isCSSVariable=!0)}function zf(e,{layout:t,layoutId:r}){return wa.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!as[e]||e==="opacity")}const Mm={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Om=ya.length;function Im(e,t,r){let a="",s=!0;for(let n=0;n<Om;n++){const i=ya[n],o=e[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const u=Rf(o,fo[i]);if(!l){s=!1;const f=Mm[i]||i;a+=`${f}(${u}) `}r&&(t[i]=u)}}return a=a.trim(),r?a=r(t,s?"":a):s&&(a="none"),a}function go(e,t,r){const{style:a,vars:s,transformOrigin:n}=e;let i=!1,o=!1;for(const l in t){const u=t[l];if(wa.has(l)){i=!0;continue}else if(Zi(l)){s[l]=u;continue}else{const f=Rf(u,fo[l]);l.startsWith("origin")?(o=!0,n[l]=f):a[l]=f}}if(t.transform||(i||r?a.transform=Im(t,e.transform,r):a.transform&&(a.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:f=0}=n;a.transformOrigin=`${l} ${u} ${f}`}}const vo=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Gf(e,t,r){for(const a in t)!lt(t[a])&&!zf(a,r)&&(e[a]=t[a])}function Lm({transformTemplate:e},t){return L.useMemo(()=>{const r=vo();return go(r,t,e),Object.assign({},r.vars,r.style)},[t])}function Bm(e,t){const r=e.style||{},a={};return Gf(a,r,e),Object.assign(a,Lm(e,t)),a}function Vm(e,t){const r={},a=Bm(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const Um={offset:"stroke-dashoffset",array:"stroke-dasharray"},Hm={offset:"strokeDashoffset",array:"strokeDasharray"};function Wm(e,t,r=1,a=0,s=!0){e.pathLength=1;const n=s?Um:Hm;e[n.offset]=xe.transform(-a);const i=xe.transform(t),o=xe.transform(r);e[n.array]=`${i} ${o}`}function $f(e,{attrX:t,attrY:r,attrScale:a,pathLength:s,pathSpacing:n=1,pathOffset:i=0,...o},l,u,f){if(go(e,o,u),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=f?.transformBox??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),r!==void 0&&(d.y=r),a!==void 0&&(d.scale=a),s!==void 0&&Wm(d,s,n,i,!1)}const Kf=()=>({...vo(),attrs:{}}),Xf=e=>typeof e=="string"&&e.toLowerCase()==="svg";function zm(e,t,r,a){const s=L.useMemo(()=>{const n=Kf();return $f(n,t,Xf(a),e.transformTemplate,e.style),{...n.attrs,style:{...n.style}}},[t]);if(e.style){const n={};Gf(n,e.style,e),s.style={...n,...s.style}}return s}const Gm=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function yo(e){return typeof e!="string"||e.includes("-")?!1:!!(Gm.indexOf(e)>-1||/[A-Z]/u.test(e))}function $m(e,t,r,{latestValues:a},s,n=!1){const o=(yo(e)?zm:Vm)(t,a,s,e),l=jm(t,typeof e=="string",n),u=e!==L.Fragment?{...l,...o,ref:r}:{},{children:f}=t,d=L.useMemo(()=>lt(f)?f.get():f,[f]);return L.createElement(e,{...u,children:d})}function D0(e){const t=[{},{}];return e?.values.forEach((r,a)=>{t[0][a]=r.get(),t[1][a]=r.getVelocity()}),t}function wo(e,t,r,a){if(typeof t=="function"){const[s,n]=D0(a);t=t(r!==void 0?r:e.custom,s,n)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,n]=D0(a);t=t(r!==void 0?r:e.custom,s,n)}return t}function Gs(e){return lt(e)?e.get():e}function Km({scrapeMotionValuesFromProps:e,createRenderState:t},r,a,s){return{latestValues:Xm(r,a,s,e),renderState:t()}}function Xm(e,t,r,a){const s={},n=a(e,{});for(const h in n)s[h]=Gs(n[h]);let{initial:i,animate:o}=e;const l=Tn(e),u=Wf(e);t&&u&&!l&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let f=r?r.initial===!1:!1;f=f||i===!1;const d=f?o:i;if(d&&typeof d!="boolean"&&!bn(d)){const h=Array.isArray(d)?d:[d];for(let p=0;p<h.length;p++){const x=wo(e,h[p]);if(x){const{transitionEnd:m,transition:g,...y}=x;for(const T in y){let v=y[T];if(Array.isArray(v)){const R=f?v.length-1:0;v=v[R]}v!==null&&(s[T]=v)}for(const T in m)s[T]=m[T]}}}return s}const Yf=e=>(t,r)=>{const a=L.useContext(kn),s=L.useContext(wn),n=()=>Km(e,t,a,s);return r?n():zi(n)};function ko(e,t,r){const{style:a}=e,s={};for(const n in a)(lt(a[n])||t.style&&lt(t.style[n])||zf(n,e)||r?.getValue(n)?.liveStyle!==void 0)&&(s[n]=a[n]);return s}const Ym=Yf({scrapeMotionValuesFromProps:ko,createRenderState:vo});function qf(e,t,r){const a=ko(e,t,r);for(const s in e)if(lt(e[s])||lt(t[s])){const n=ya.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;a[n]=e[s]}return a}const qm=Yf({scrapeMotionValuesFromProps:qf,createRenderState:Kf}),Qm=Symbol.for("motionComponentSymbol");function aa(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function Jm(e,t,r){return L.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),r&&(typeof r=="function"?r(a):aa(r)&&(r.current=a))},[t])}const bo=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Zm="framerAppearId",Qf="data-"+bo(Zm),Jf=L.createContext({});function ep(e,t,r,a,s){const{visualElement:n}=L.useContext(kn),i=L.useContext(Uf),o=L.useContext(wn),l=L.useContext(xo).reducedMotion,u=L.useRef(null);a=a||i.renderer,!u.current&&a&&(u.current=a(e,{visualState:t,parent:n,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const f=u.current,d=L.useContext(Jf);f&&!f.projection&&s&&(f.type==="html"||f.type==="svg")&&tp(u.current,r,s,d);const h=L.useRef(!1);L.useInsertionEffect(()=>{f&&h.current&&f.update(r,o)});const p=r[Qf],x=L.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return Xl(()=>{f&&(h.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),x.current&&f.animationState&&f.animationState.animateChanges())}),L.useEffect(()=>{f&&(!x.current&&f.animationState&&f.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),x.current=!1),f.enteringChildren=void 0)}),f}function tp(e,t,r,a){const{layoutId:s,layout:n,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:f}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:Zf(e.parent)),e.projection.setOptions({layoutId:s,layout:n,alwaysMeasureLayout:!!i||o&&aa(o),visualElement:e,animationType:typeof n=="string"?n:"both",initialPromotionConfig:a,crossfade:f,layoutScroll:l,layoutRoot:u})}function Zf(e){if(e)return e.options.allowProjection!==!1?e.projection:Zf(e.parent)}function Ln(e,{forwardMotionProps:t=!1}={},r,a){r&&Nm(r);const s=yo(e)?qm:Ym;function n(o,l){let u;const f={...L.useContext(xo),...o,layoutId:rp(o)},{isStatic:d}=f,h=Dm(o),p=s(o,d);if(!d&&Gi){ap();const x=sp(f);u=x.MeasureLayout,h.visualElement=ep(e,p,f,a,x.ProjectionNode)}return c.jsxs(kn.Provider,{value:h,children:[u&&h.visualElement?c.jsx(u,{visualElement:h.visualElement,...f}):null,$m(e,o,Jm(p,h.visualElement,l),p,d,t)]})}n.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=L.forwardRef(n);return i[Qm]=e,i}function rp({layoutId:e}){const t=L.useContext(Wi).id;return t&&e!==void 0?t+"-"+e:e}function ap(e,t){L.useContext(Uf).strict}function sp(e){const{drag:t,layout:r}=ma;if(!t&&!r)return{};const a={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}function np(e,t){if(typeof Proxy>"u")return Ln;const r=new Map,a=(n,i)=>Ln(n,i,e,t),s=(n,i)=>a(n,i);return new Proxy(s,{get:(n,i)=>i==="create"?a:(r.has(i)||r.set(i,Ln(i,void 0,e,t)),r.get(i))})}function eu({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}function ip({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function op(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}function Bn(e){return e===void 0||e===1}function ki({scale:e,scaleX:t,scaleY:r}){return!Bn(e)||!Bn(t)||!Bn(r)}function Or(e){return ki(e)||tu(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function tu(e){return R0(e.x)||R0(e.y)}function R0(e){return e&&e!=="0%"}function Zs(e,t,r){const a=e-r,s=t*a;return r+s}function M0(e,t,r,a,s){return s!==void 0&&(e=Zs(e,s,a)),Zs(e,r,a)+t}function bi(e,t=0,r=1,a,s){e.min=M0(e.min,t,r,a,s),e.max=M0(e.max,t,r,a,s)}function ru(e,{x:t,y:r}){bi(e.x,t.translate,t.scale,t.originPoint),bi(e.y,r.translate,r.scale,r.originPoint)}const O0=.999999999999,I0=1.0000000000001;function cp(e,t,r,a=!1){const s=r.length;if(!s)return;t.x=t.y=1;let n,i;for(let o=0;o<s;o++){n=r[o],i=n.projectionDelta;const{visualElement:l}=n.options;l&&l.props.style&&l.props.style.display==="contents"||(a&&n.options.layoutScroll&&n.scroll&&n!==n.root&&na(e,{x:-n.scroll.offset.x,y:-n.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,ru(e,i)),a&&Or(n.latestValues)&&na(e,n.latestValues))}t.x<I0&&t.x>O0&&(t.x=1),t.y<I0&&t.y>O0&&(t.y=1)}function sa(e,t){e.min=e.min+t,e.max=e.max+t}function L0(e,t,r,a,s=.5){const n=Oe(e.min,e.max,s);bi(e,t,r,n,a)}function na(e,t){L0(e.x,t.x,t.scaleX,t.scale,t.originX),L0(e.y,t.y,t.scaleY,t.scale,t.originY)}function au(e,t){return eu(op(e.getBoundingClientRect(),t))}function lp(e,t,r){const a=au(e,r),{scroll:s}=t;return s&&(sa(a.x,s.offset.x),sa(a.y,s.offset.y)),a}const B0=()=>({translate:0,scale:1,origin:0,originPoint:0}),ia=()=>({x:B0(),y:B0()}),V0=()=>({min:0,max:0}),ze=()=>({x:V0(),y:V0()}),Ti={current:null},su={current:!1};function fp(){if(su.current=!0,!!Gi)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Ti.current=e.matches;e.addEventListener("change",t),t()}else Ti.current=!1}const up=new WeakMap;function dp(e,t,r){for(const a in t){const s=t[a],n=r[a];if(lt(s))e.addValue(a,s);else if(lt(n))e.addValue(a,xa(s,{owner:e}));else if(n!==s)if(e.hasValue(a)){const i=e.getValue(a);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(a);e.addValue(a,xa(i!==void 0?i:s,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const U0=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class hp{scrapeMotionValuesFromProps(t,r,a){return{}}constructor({parent:t,props:r,presenceContext:a,reducedMotionConfig:s,blockInitialAnimation:n,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=co,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Tt.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,De.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!n,this.isControllingVariants=Tn(r),this.isVariantNode=Wf(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...d}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in d){const p=d[h];l[h]!==void 0&&lt(p)&&p.set(l[h])}}mount(t){this.current=t,up.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,a)=>this.bindToMotionValue(a,r)),su.current||fp(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ti.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ar(this.notifyUpdate),Ar(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=wa.has(t);a&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&De.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let n;window.MotionCheckAppearSync&&(n=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),n&&n(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in ma){const r=ma[t];if(!r)continue;const{isEnabled:a,Feature:s}=r;if(!this.features[t]&&s&&a(this.props)&&(this.features[t]=new s(this)),this.features[t]){const n=this.features[t];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ze()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let a=0;a<U0.length;a++){const s=U0[a];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const n="on"+s,i=t[n];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=dp(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const a=this.values.get(t);r!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&r!==void 0&&(a=xa(r===null?void 0:r,{owner:this}),this.addValue(t,a)),a}readValue(t,r){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(Yl(a)||Ql(a))?a=parseFloat(a):!Tm(a)&&Nr.test(r)&&(a=Df(t,r)),this.setBaseTarget(t,lt(a)?a.get():a)),lt(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let a;if(typeof r=="string"||typeof r=="object"){const n=wo(this.props,r,this.presenceContext?.custom);n&&(a=n[t])}if(r&&a!==void 0)return a;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!lt(s)?s:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new qi),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){uo.render(this.render)}}class nu extends hp{constructor(){super(...arguments),this.KeyframeResolver=um}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:a}){delete r[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;lt(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function iu(e,{style:t,vars:r},a,s){const n=e.style;let i;for(i in t)n[i]=t[i];s?.applyProjectionStyles(n,a);for(i in r)n.setProperty(i,r[i])}function xp(e){return window.getComputedStyle(e)}class mp extends nu{constructor(){super(...arguments),this.type="html",this.renderInstance=iu}readValueFromInstance(t,r){if(wa.has(r))return this.projection?.isProjecting?xi(r):F1(t,r);{const a=xp(t),s=(Zi(r)?a.getPropertyValue(r):a[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return au(t,r)}build(t,r,a){go(t,r,a.transformTemplate)}scrapeMotionValuesFromProps(t,r,a){return ko(t,r,a)}}const ou=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function pp(e,t,r,a){iu(e,t,void 0,a);for(const s in t.attrs)e.setAttribute(ou.has(s)?s:bo(s),t.attrs[s])}class gp extends nu{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ze}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(wa.has(r)){const a=Pf(r);return a&&a.default||0}return r=ou.has(r)?r:bo(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,a){return qf(t,r,a)}build(t,r,a){$f(t,r,this.isSVGTag,a.transformTemplate,a.style)}renderInstance(t,r,a,s){pp(t,r,a,s)}mount(t){this.isSVGTag=Xf(t.tagName),super.mount(t)}}const vp=(e,t)=>yo(e)?new gp(t):new mp(t,{allowProjection:e!==L.Fragment});function ca(e,t,r){const a=e.getProps();return wo(a,t,r!==void 0?r:a.custom,e)}const Ei=e=>Array.isArray(e);function yp(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,xa(r))}function wp(e){return Ei(e)?e[e.length-1]||0:e}function kp(e,t){const r=ca(e,t);let{transitionEnd:a={},transition:s={},...n}=r||{};n={...n,...a};for(const i in n){const o=wp(n[i]);yp(e,i,o)}}function bp(e){return!!(lt(e)&&e.add)}function _i(e,t){const r=e.getValue("willChange");if(bp(r))return r.add(t);if(!r&&xr.WillChange){const a=new xr.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function cu(e){return e.props[Qf]}const Tp=e=>e!==null;function Ep(e,{repeat:t,repeatType:r="loop"},a){const s=e.filter(Tp),n=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[n]}const _p={type:"spring",stiffness:500,damping:25,restSpeed:10},Sp=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Ap={type:"keyframes",duration:.8},Np={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Cp=(e,{keyframes:t})=>t.length>2?Ap:wa.has(e)?e.startsWith("scale")?Sp(t[1]):_p:Np;function Fp({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:s,repeat:n,repeatType:i,repeatDelay:o,from:l,elapsed:u,...f}){return!!Object.keys(f).length}const To=(e,t,r,a={},s,n)=>i=>{const o=lo(a,e)||{},l=o.delay||a.delay||0;let{elapsed:u=0}=a;u=u-Zt(l);const f={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:n?void 0:s};Fp(o)||Object.assign(f,Cp(e,f)),f.duration&&(f.duration=Zt(f.duration)),f.repeatDelay&&(f.repeatDelay=Zt(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let d=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(yi(f),f.delay===0&&(d=!0)),(xr.instantAnimations||xr.skipAnimations)&&(d=!0,yi(f),f.delay=0),f.allowFlatten=!o.type&&!o.ease,d&&!n&&t.get()!==void 0){const h=Ep(f.keyframes,o);if(h!==void 0){De.update(()=>{f.onUpdate(h),f.onComplete()});return}}return o.isSync?new oo(f):new Z1(f)};function jp({protectedKeys:e,needsAnimating:t},r){const a=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,a}function lu(e,t,{delay:r=0,transitionOverride:a,type:s}={}){let{transition:n=e.getDefaultTransition(),transitionEnd:i,...o}=t;a&&(n=a);const l=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const f in o){const d=e.getValue(f,e.latestValues[f]??null),h=o[f];if(h===void 0||u&&jp(u,f))continue;const p={delay:r,...lo(n||{},f)},x=d.get();if(x!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===x&&!p.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const y=cu(e);if(y){const T=window.MotionHandoffAnimation(y,f,De);T!==null&&(p.startTime=T,m=!0)}}_i(e,f),d.start(To(f,d,h,e.shouldReduceMotion&&Cf.has(f)?{type:!1}:p,e,m));const g=d.animation;g&&l.push(g)}return i&&Promise.all(l).then(()=>{De.update(()=>{i&&kp(e,i)})}),l}function fu(e,t,r,a=0,s=1){const n=Array.from(e).sort((u,f)=>u.sortNodePosition(f)).indexOf(t),i=e.size,o=(i-1)*a;return typeof r=="function"?r(n,i):s===1?n*a:o-n*a}function Si(e,t,r={}){const a=ca(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(s=r.transitionOverride);const n=a?()=>Promise.all(lu(e,a,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:u=0,staggerChildren:f,staggerDirection:d}=s;return Pp(e,t,l,u,f,d,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[l,u]=o==="beforeChildren"?[n,i]:[i,n];return l().then(()=>u())}else return Promise.all([n(),i(r.delay)])}function Pp(e,t,r=0,a=0,s=0,n=1,i){const o=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),o.push(Si(l,t,{...i,delay:r+(typeof a=="function"?0:a)+fu(e.variantChildren,l,a,s,n)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}function Dp(e,t,r={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const s=t.map(n=>Si(e,n,r));a=Promise.all(s)}else if(typeof t=="string")a=Si(e,t,r);else{const s=typeof t=="function"?ca(e,t,r.custom):t;a=Promise.all(lu(e,s,r))}return a.then(()=>{e.notify("AnimationComplete",t)})}function uu(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const Rp=po.length;function du(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?du(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<Rp;r++){const a=po[r],s=e.props[a];(rs(s)||s===!1)&&(t[a]=s)}return t}const Mp=[...mo].reverse(),Op=mo.length;function Ip(e){return t=>Promise.all(t.map(({animation:r,options:a})=>Dp(e,r,a)))}function Lp(e){let t=Ip(e),r=H0(),a=!0;const s=l=>(u,f)=>{const d=ca(e,f,l==="exit"?e.presenceContext?.custom:void 0);if(d){const{transition:h,transitionEnd:p,...x}=d;u={...u,...x,...p}}return u};function n(l){t=l(e)}function i(l){const{props:u}=e,f=du(e.parent)||{},d=[],h=new Set;let p={},x=1/0;for(let g=0;g<Op;g++){const y=Mp[g],T=r[y],v=u[y]!==void 0?u[y]:f[y],R=rs(v),D=y===l?T.isActive:null;D===!1&&(x=g);let b=v===f[y]&&v!==u[y]&&R;if(b&&a&&e.manuallyAnimateOnMount&&(b=!1),T.protectedKeys={...p},!T.isActive&&D===null||!v&&!T.prevProp||bn(v)||typeof v=="boolean")continue;const k=Bp(T.prevProp,v);let S=k||y===l&&T.isActive&&!b&&R||g>x&&R,P=!1;const H=Array.isArray(v)?v:[v];let O=H.reduce(s(y),{});D===!1&&(O={});const{prevResolvedValues:C={}}=T,W={...C,...O},q=Z=>{S=!0,h.has(Z)&&(P=!0,h.delete(Z)),T.needsAnimating[Z]=!0;const de=e.getValue(Z);de&&(de.liveStyle=!1)};for(const Z in W){const de=O[Z],U=C[Z];if(p.hasOwnProperty(Z))continue;let ue=!1;Ei(de)&&Ei(U)?ue=!uu(de,U):ue=de!==U,ue?de!=null?q(Z):h.add(Z):de!==void 0&&h.has(Z)?q(Z):T.protectedKeys[Z]=!0}T.prevProp=v,T.prevResolvedValues=O,T.isActive&&(p={...p,...O}),a&&e.blockInitialAnimation&&(S=!1);const Q=b&&k;S&&(!Q||P)&&d.push(...H.map(Z=>{const de={type:y};if(typeof Z=="string"&&a&&!Q&&e.manuallyAnimateOnMount&&e.parent){const{parent:U}=e,ue=ca(U,Z);if(U.enteringChildren&&ue){const{delayChildren:he}=ue.transition||{};de.delay=fu(U.enteringChildren,e,he)}}return{animation:Z,options:de}}))}if(h.size){const g={};if(typeof u.initial!="boolean"){const y=ca(e,Array.isArray(u.initial)?u.initial[0]:u.initial);y&&y.transition&&(g.transition=y.transition)}h.forEach(y=>{const T=e.getBaseTarget(y),v=e.getValue(y);v&&(v.liveStyle=!0),g[y]=T??null}),d.push({animation:g})}let m=!!d.length;return a&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(m=!1),a=!1,m?t(d):Promise.resolve()}function o(l,u){if(r[l].isActive===u)return Promise.resolve();e.variantChildren?.forEach(d=>d.animationState?.setActive(l,u)),r[l].isActive=u;const f=i(l);for(const d in r)r[d].protectedKeys={};return f}return{animateChanges:i,setActive:o,setAnimateFunction:n,getState:()=>r,reset:()=>{r=H0(),a=!0}}}function Bp(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!uu(t,e):!1}function Mr(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function H0(){return{animate:Mr(!0),whileInView:Mr(),whileHover:Mr(),whileTap:Mr(),whileDrag:Mr(),whileFocus:Mr(),exit:Mr()}}class jr{constructor(t){this.isMounted=!1,this.node=t}update(){}}class Vp extends jr{constructor(t){super(t),t.animationState||(t.animationState=Lp(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();bn(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Up=0;class Hp extends jr{constructor(){super(...arguments),this.id=Up++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const Wp={animation:{Feature:Vp},exit:{Feature:Hp}};function ss(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}function ws(e){return{point:{x:e.pageX,y:e.pageY}}}const zp=e=>t=>ho(t)&&e(t,ws(t));function Ba(e,t,r,a){return ss(e,t,zp(r),a)}const hu=1e-4,Gp=1-hu,$p=1+hu,xu=.01,Kp=0-xu,Xp=0+xu;function vt(e){return e.max-e.min}function Yp(e,t,r){return Math.abs(e-t)<=r}function W0(e,t,r,a=.5){e.origin=a,e.originPoint=Oe(t.min,t.max,e.origin),e.scale=vt(r)/vt(t),e.translate=Oe(r.min,r.max,e.origin)-e.originPoint,(e.scale>=Gp&&e.scale<=$p||isNaN(e.scale))&&(e.scale=1),(e.translate>=Kp&&e.translate<=Xp||isNaN(e.translate))&&(e.translate=0)}function Va(e,t,r,a){W0(e.x,t.x,r.x,a?a.originX:void 0),W0(e.y,t.y,r.y,a?a.originY:void 0)}function z0(e,t,r){e.min=r.min+t.min,e.max=e.min+vt(t)}function qp(e,t,r){z0(e.x,t.x,r.x),z0(e.y,t.y,r.y)}function G0(e,t,r){e.min=t.min-r.min,e.max=e.min+vt(t)}function Ua(e,t,r){G0(e.x,t.x,r.x),G0(e.y,t.y,r.y)}function Mt(e){return[e("x"),e("y")]}const mu=({current:e})=>e?e.ownerDocument.defaultView:null,$0=(e,t)=>Math.abs(e-t);function Qp(e,t){const r=$0(e.x,t.x),a=$0(e.y,t.y);return Math.sqrt(r**2+a**2)}class pu{constructor(t,r,{transformPagePoint:a,contextWindow:s=window,dragSnapToOrigin:n=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Un(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=Qp(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:m}=h,{timestamp:g}=tt;this.history.push({...m,timestamp:g});const{onStart:y,onMove:T}=this.handlers;p||(y&&y(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),T&&T(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=Vn(p,this.transformPagePoint),De.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:m,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const y=Un(h.type==="pointercancel"?this.lastMoveEventInfo:Vn(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,y),m&&m(h,y)},!ho(t))return;this.dragSnapToOrigin=n,this.handlers=r,this.transformPagePoint=a,this.distanceThreshold=i,this.contextWindow=s||window;const o=ws(t),l=Vn(o,this.transformPagePoint),{point:u}=l,{timestamp:f}=tt;this.history=[{...u,timestamp:f}];const{onSessionStart:d}=r;d&&d(t,Un(l,this.history)),this.removeListeners=gs(Ba(this.contextWindow,"pointermove",this.handlePointerMove),Ba(this.contextWindow,"pointerup",this.handlePointerUp),Ba(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ar(this.updatePoint)}}function Vn(e,t){return t?{point:t(e.point)}:e}function K0(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Un({point:e},t){return{point:e,delta:K0(e,gu(t)),offset:K0(e,Jp(t)),velocity:Zp(t,.1)}}function Jp(e){return e[0]}function gu(e){return e[e.length-1]}function Zp(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null;const s=gu(e);for(;r>=0&&(a=e[r],!(s.timestamp-a.timestamp>Zt(t)));)r--;if(!a)return{x:0,y:0};const n=er(s.timestamp-a.timestamp);if(n===0)return{x:0,y:0};const i={x:(s.x-a.x)/n,y:(s.y-a.y)/n};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function eg(e,{min:t,max:r},a){return t!==void 0&&e<t?e=a?Oe(t,e,a.min):Math.max(e,t):r!==void 0&&e>r&&(e=a?Oe(r,e,a.max):Math.min(e,r)),e}function X0(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function tg(e,{top:t,left:r,bottom:a,right:s}){return{x:X0(e.x,r,s),y:X0(e.y,t,a)}}function Y0(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function rg(e,t){return{x:Y0(e.x,t.x),y:Y0(e.y,t.y)}}function ag(e,t){let r=.5;const a=vt(e),s=vt(t);return s>a?r=Za(t.min,t.max-a,e.min):a>s&&(r=Za(e.min,e.max-s,t.min)),hr(0,1,r)}function sg(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Ai=.35;function ng(e=Ai){return e===!1?e=0:e===!0&&(e=Ai),{x:q0(e,"left","right"),y:q0(e,"top","bottom")}}function q0(e,t,r){return{min:Q0(e,t),max:Q0(e,r)}}function Q0(e,t){return typeof e=="number"?e:e[t]||0}const ig=new WeakMap;class og{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ze(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:a}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const n=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(ws(d).point)},i=(d,h)=>{const{drag:p,dragPropagation:x,onDragStart:m}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=mm(p),!this.openDragLock))return;this.latestPointerEvent=d,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Mt(y=>{let T=this.getAxisMotionValue(y).get()||0;if(tr.test(T)){const{projection:v}=this.visualElement;if(v&&v.layout){const R=v.layout.layoutBox[y];R&&(T=vt(R)*(parseFloat(T)/100))}}this.originPoint[y]=T}),m&&De.postRender(()=>m(d,h)),_i(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},o=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:m,onDrag:g}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:y}=h;if(x&&this.currentDirection===null){this.currentDirection=cg(y),this.currentDirection!==null&&m&&m(this.currentDirection);return}this.updateAxis("x",h.point,y),this.updateAxis("y",h.point,y),this.visualElement.render(),g&&g(d,h)},l=(d,h)=>{this.latestPointerEvent=d,this.latestPanInfo=h,this.stop(d,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Mt(d=>this.getAnimationState(d)==="paused"&&this.getAxisMotionValue(d).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new pu(t,{onSessionStart:n,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:a,contextWindow:mu(this.visualElement)})}stop(t,r){const a=t||this.latestPointerEvent,s=r||this.latestPanInfo,n=this.isDragging;if(this.cancel(),!n||!s||!a)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&De.postRender(()=>o(a,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,a){const{drag:s}=this.getProps();if(!a||!Ds(t,s,this.currentDirection))return;const n=this.getAxisMotionValue(t);let i=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(i=eg(i,this.constraints[t],this.elastic[t])),n.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&aa(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=tg(a.layoutBox,t):this.constraints=!1,this.elastic=ng(r),s!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Mt(n=>{this.constraints!==!1&&this.getAxisMotionValue(n)&&(this.constraints[n]=sg(a.layoutBox[n],this.constraints[n]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!aa(t))return!1;const a=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const n=lp(a,s.root,this.visualElement.getTransformPagePoint());let i=rg(s.layout.layoutBox,n);if(r){const o=r(ip(i));this.hasMutatedConstraints=!!o,o&&(i=eu(o))}return i}startAnimation(t){const{drag:r,dragMomentum:a,dragElastic:s,dragTransition:n,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=Mt(f=>{if(!Ds(f,r,this.currentDirection))return;let d=l&&l[f]||{};i&&(d={min:0,max:0});const h=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:a?t[f]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...n,...d};return this.startAxisValueAnimation(f,x)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const a=this.getAxisMotionValue(t);return _i(this.visualElement,t),a.start(To(t,a,0,r,this.visualElement,!1))}stopAnimation(){Mt(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Mt(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),s=a[r];return s||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){Mt(r=>{const{drag:a}=this.getProps();if(!Ds(r,a,this.currentDirection))return;const{projection:s}=this.visualElement,n=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];n.set(t[r]-Oe(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:a}=this.visualElement;if(!aa(r)||!a||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Mt(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();s[i]=ag({min:l,max:l},this.constraints[i])}});const{transformTemplate:n}=this.visualElement.getProps();this.visualElement.current.style.transform=n?n({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),Mt(i=>{if(!Ds(i,t,null))return;const o=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];o.set(Oe(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;ig.set(this.visualElement,this);const t=this.visualElement.current,r=Ba(t,"pointerdown",l=>{const{drag:u,dragListener:f=!0}=this.getProps();u&&f&&this.start(l)}),a=()=>{const{dragConstraints:l}=this.getProps();aa(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,n=s.addEventListener("measure",a);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),De.read(a);const i=ss(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(Mt(f=>{const d=this.getAxisMotionValue(f);d&&(this.originPoint[f]+=l[f].translate,d.set(d.get()+l[f].translate))}),this.visualElement.render())}));return()=>{i(),r(),n(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:a=!1,dragPropagation:s=!1,dragConstraints:n=!1,dragElastic:i=Ai,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:a,dragPropagation:s,dragConstraints:n,dragElastic:i,dragMomentum:o}}}function Ds(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function cg(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class lg extends jr{constructor(t){super(t),this.removeGroupControls=It,this.removeListeners=It,this.controls=new og(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||It}unmount(){this.removeGroupControls(),this.removeListeners()}}const J0=e=>(t,r)=>{e&&De.postRender(()=>e(t,r))};class fg extends jr{constructor(){super(...arguments),this.removePointerDownListener=It}onPointerDown(t){this.session=new pu(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:mu(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:a,onPanEnd:s}=this.node.getProps();return{onSessionStart:J0(t),onStart:J0(r),onMove:a,onEnd:(n,i)=>{delete this.session,s&&De.postRender(()=>s(n,i))}}}mount(){this.removePointerDownListener=Ba(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const $s={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Z0(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Fa={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(xe.test(e))e=parseFloat(e);else return e;const r=Z0(e,t.target.x),a=Z0(e,t.target.y);return`${r}% ${a}%`}},ug={correct:(e,{treeScale:t,projectionDelta:r})=>{const a=e,s=Nr.parse(e);if(s.length>5)return a;const n=Nr.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=l;const u=Oe(o,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),n(s)}};let Hn=!1;class dg extends L.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a,layoutId:s}=this.props,{projection:n}=t;Rm(hg),n&&(r.group&&r.group.add(n),a&&a.register&&s&&a.register(n),Hn&&n.root.didUpdate(),n.addEventListener("animationComplete",()=>{this.safeToRemove()}),n.setOptions({...n.options,onExitComplete:()=>this.safeToRemove()})),$s.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:a,drag:s,isPresent:n}=this.props,{projection:i}=a;return i&&(i.isPresent=n,Hn=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==n?i.willUpdate():this.safeToRemove(),t.isPresent!==n&&(n?i.promote():i.relegate()||De.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),uo.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a}=this.props,{projection:s}=t;Hn=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),a&&a.deregister&&a.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function vu(e){const[t,r]=Vf(),a=L.useContext(Wi);return c.jsx(dg,{...e,layoutGroup:a,switchLayoutGroup:L.useContext(Jf),isPresent:t,safeToRemove:r})}const hg={borderRadius:{...Fa,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Fa,borderTopRightRadius:Fa,borderBottomLeftRadius:Fa,borderBottomRightRadius:Fa,boxShadow:ug};function xg(e,t,r){const a=lt(e)?e:xa(e);return a.start(To("",a,t,r)),a.animation}const mg=(e,t)=>e.depth-t.depth;class pg{constructor(){this.children=[],this.isDirty=!1}add(t){$i(this.children,t),this.isDirty=!0}remove(t){Ki(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(mg),this.isDirty=!1,this.children.forEach(t)}}function gg(e,t){const r=Tt.now(),a=({timestamp:s})=>{const n=s-r;n>=t&&(Ar(a),e(n-t))};return De.setup(a,!0),()=>Ar(a)}const yu=["TopLeft","TopRight","BottomLeft","BottomRight"],vg=yu.length,ec=e=>typeof e=="string"?parseFloat(e):e,tc=e=>typeof e=="number"||xe.test(e);function yg(e,t,r,a,s,n){s?(e.opacity=Oe(0,r.opacity??1,wg(a)),e.opacityExit=Oe(t.opacity??1,0,kg(a))):n&&(e.opacity=Oe(t.opacity??1,r.opacity??1,a));for(let i=0;i<vg;i++){const o=`border${yu[i]}Radius`;let l=rc(t,o),u=rc(r,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||tc(l)===tc(u)?(e[o]=Math.max(Oe(ec(l),ec(u),a),0),(tr.test(u)||tr.test(l))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=Oe(t.rotate||0,r.rotate||0,a))}function rc(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const wg=wu(0,.5,nf),kg=wu(.5,.95,It);function wu(e,t,r){return a=>a<e?0:a>t?1:r(Za(e,t,a))}function ac(e,t){e.min=t.min,e.max=t.max}function Pt(e,t){ac(e.x,t.x),ac(e.y,t.y)}function sc(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function nc(e,t,r,a,s){return e-=t,e=Zs(e,1/r,a),s!==void 0&&(e=Zs(e,1/s,a)),e}function bg(e,t=0,r=1,a=.5,s,n=e,i=e){if(tr.test(t)&&(t=parseFloat(t),t=Oe(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=Oe(n.min,n.max,a);e===n&&(o-=t),e.min=nc(e.min,t,r,o,s),e.max=nc(e.max,t,r,o,s)}function ic(e,t,[r,a,s],n,i){bg(e,t[r],t[a],t[s],t.scale,n,i)}const Tg=["x","scaleX","originX"],Eg=["y","scaleY","originY"];function oc(e,t,r,a){ic(e.x,t,Tg,r?r.x:void 0,a?a.x:void 0),ic(e.y,t,Eg,r?r.y:void 0,a?a.y:void 0)}function cc(e){return e.translate===0&&e.scale===1}function ku(e){return cc(e.x)&&cc(e.y)}function lc(e,t){return e.min===t.min&&e.max===t.max}function _g(e,t){return lc(e.x,t.x)&&lc(e.y,t.y)}function fc(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function bu(e,t){return fc(e.x,t.x)&&fc(e.y,t.y)}function uc(e){return vt(e.x)/vt(e.y)}function dc(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Sg{constructor(){this.members=[]}add(t){$i(this.members,t),t.scheduleRender()}remove(t){if(Ki(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let a;for(let s=r;s>=0;s--){const n=this.members[s];if(n.isPresent!==!1){a=n;break}}return a?(this.promote(a),!0):!1}promote(t,r){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,r&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:a}=t;r.onExitComplete&&r.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Ag(e,t,r){let a="";const s=e.x.translate/t.x,n=e.y.translate/t.y,i=r?.z||0;if((s||n||i)&&(a=`translate3d(${s}px, ${n}px, ${i}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:f,rotateX:d,rotateY:h,skewX:p,skewY:x}=r;u&&(a=`perspective(${u}px) ${a}`),f&&(a+=`rotate(${f}deg) `),d&&(a+=`rotateX(${d}deg) `),h&&(a+=`rotateY(${h}deg) `),p&&(a+=`skewX(${p}deg) `),x&&(a+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(a+=`scale(${o}, ${l})`),a||"none"}const Wn=["","X","Y","Z"],Ng=1e3;let Cg=0;function zn(e,t,r,a){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),a&&(a[e]=0))}function Tu(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=cu(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:n}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",De,!(s||n))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&Tu(a)}function Eu({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=Cg++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Pg),this.nodes.forEach(Og),this.nodes.forEach(Ig),this.nodes.forEach(Dg)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new pg)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new qi),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=Bf(i)&&!km(i),this.instance=i;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let f,d=0;const h=()=>this.root.updateBlockedByResize=!1;De.read(()=>{d=window.innerWidth}),e(i,()=>{const p=window.innerWidth;p!==d&&(d=p,this.root.updateBlockedByResize=!0,f&&f(),f=gg(h,250),$s.hasAnimatedSinceResize&&($s.hasAnimatedSinceResize=!1,this.nodes.forEach(mc)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||Hg,{onLayoutAnimationStart:m,onLayoutAnimationComplete:g}=u.getProps(),y=!this.targetLayout||!bu(this.targetLayout,p),T=!d&&h;if(this.options.layoutRoot||this.resumeFrom||T||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const v={...lo(x,"layout"),onPlay:m,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v),this.setAnimationOrigin(f,T)}else d||mc(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ar(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Lg),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Tu(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const d=this.path[f];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(hc);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(xc);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Mg),this.nodes.forEach(Fg),this.nodes.forEach(jg)):this.nodes.forEach(xc),this.clearAllSnapshots();const o=Tt.now();tt.delta=hr(0,1e3/60,o-tt.timestamp),tt.timestamp=o,tt.isProcessing=!0,Pn.update.process(tt),Pn.preRender.process(tt),Pn.render.process(tt),tt.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,uo.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Rg),this.sharedNodes.forEach(Bg)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,De.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){De.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!vt(this.snapshot.measuredBox.x)&&!vt(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=ze(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const l=a(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!ku(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,f=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||Or(this.latestValues)||f)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),Wg(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return ze();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(zg))){const{scroll:u}=this.root;u&&(sa(o.x,u.offset.x),sa(o.y,u.offset.y))}return o}removeElementScroll(i){const o=ze();if(Pt(o,i),this.scroll?.wasRoot)return o;for(let l=0;l<this.path.length;l++){const u=this.path[l],{scroll:f,options:d}=u;u!==this.root&&f&&d.layoutScroll&&(f.wasRoot&&Pt(o,i),sa(o.x,f.offset.x),sa(o.y,f.offset.y))}return o}applyTransform(i,o=!1){const l=ze();Pt(l,i);for(let u=0;u<this.path.length;u++){const f=this.path[u];!o&&f.options.layoutScroll&&f.scroll&&f!==f.root&&na(l,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Or(f.latestValues)&&na(l,f.latestValues)}return Or(this.latestValues)&&na(l,this.latestValues),l}removeTransform(i){const o=ze();Pt(o,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Or(u.latestValues))continue;ki(u.latestValues)&&u.updateSnapshot();const f=ze(),d=u.measurePageBox();Pt(f,d),oc(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,f)}return Or(this.latestValues)&&oc(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==tt.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:d}=this.options;if(!(!this.layout||!(f||d))){if(this.resolvedRelativeTargetAt=tt.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ze(),this.relativeTargetOrigin=ze(),Ua(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),Pt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ze(),this.targetWithTransforms=ze()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),qp(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pt(this.target,this.layout.layoutBox),ru(this.target,this.targetDelta)):Pt(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ze(),this.relativeTargetOrigin=ze(),Ua(this.relativeTargetOrigin,this.target,h.target),Pt(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||ki(this.parent.latestValues)||tu(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===tt.timestamp&&(l=!1),l)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;Pt(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;cp(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=ze());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(sc(this.prevProjectionDelta.x,this.projectionDelta.x),sc(this.prevProjectionDelta.y,this.projectionDelta.y)),Va(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!dc(this.projectionDelta.x,this.prevProjectionDelta.x)||!dc(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ia(),this.projectionDelta=ia(),this.projectionDeltaWithTransform=ia()}setAnimationOrigin(i,o=!1){const l=this.snapshot,u=l?l.latestValues:{},f={...this.latestValues},d=ia();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=ze(),p=l?l.source:void 0,x=this.layout?this.layout.source:void 0,m=p!==x,g=this.getStack(),y=!g||g.members.length<=1,T=!!(m&&!y&&this.options.crossfade===!0&&!this.path.some(Ug));this.animationProgress=0;let v;this.mixTargetDelta=R=>{const D=R/1e3;pc(d.x,i.x,D),pc(d.y,i.y,D),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ua(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Vg(this.relativeTarget,this.relativeTargetOrigin,h,D),v&&_g(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=ze()),Pt(v,this.relativeTarget)),m&&(this.animationValues=f,yg(f,u,this.latestValues,D,T,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=D},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ar(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=De.update(()=>{$s.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=xa(0)),this.currentAnimation=xg(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(Ng),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:f}=i;if(!(!o||!l||!u)){if(this!==i&&this.layout&&u&&_u(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||ze();const d=vt(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+d;const h=vt(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+h}Pt(o,l),na(o,f),Va(this.projectionDeltaWithTransform,this.layoutCorrected,o,f)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new Sg),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&zn("z",i,u,this.animationValues);for(let f=0;f<Wn.length;f++)zn(`rotate${Wn[f]}`,i,u,this.animationValues),zn(`skew${Wn[f]}`,i,u,this.animationValues);i.render();for(const f in u)i.setStaticValue(f,u[f]),this.animationValues&&(this.animationValues[f]=u[f]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Gs(o?.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Gs(o?.pointerEvents)||""),this.hasProjected&&!Or(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const f=u.animationValues||u.latestValues;this.applyTransformsToTarget();let d=Ag(this.projectionDeltaWithTransform,this.treeScale,f);l&&(d=l(f,d)),i.transform=d;const{x:h,y:p}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:i.opacity=u===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in as){if(f[x]===void 0)continue;const{correct:m,applyTo:g,isCSSVariable:y}=as[x],T=d==="none"?f[x]:m(f[x],u);if(g){const v=g.length;for(let R=0;R<v;R++)i[g[R]]=T}else y?this.options.visualElement.renderState.vars[x]=T:i[x]=T}this.options.layoutId&&(i.pointerEvents=u===this?Gs(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(hc),this.root.sharedNodes.clear()}}}function Fg(e){e.updateLayout()}function jg(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:a}=e.layout,{animationType:s}=e.options,n=t.source!==e.layout.source;s==="size"?Mt(f=>{const d=n?t.measuredBox[f]:t.layoutBox[f],h=vt(d);d.min=r[f].min,d.max=d.min+h}):_u(s,t.layoutBox,r)&&Mt(f=>{const d=n?t.measuredBox[f]:t.layoutBox[f],h=vt(r[f]);d.max=d.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+h)});const i=ia();Va(i,r,t.layoutBox);const o=ia();n?Va(o,e.applyTransform(a,!0),t.measuredBox):Va(o,r,t.layoutBox);const l=!ku(i);let u=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:d,layout:h}=f;if(d&&h){const p=ze();Ua(p,t.layoutBox,d.layoutBox);const x=ze();Ua(x,r,h.layoutBox),bu(p,x)||(u=!0),f.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function Pg(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function Dg(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Rg(e){e.clearSnapshot()}function hc(e){e.clearMeasurements()}function xc(e){e.isLayoutDirty=!1}function Mg(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function mc(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Og(e){e.resolveTargetDelta()}function Ig(e){e.calcProjection()}function Lg(e){e.resetSkewAndRotation()}function Bg(e){e.removeLeadSnapshot()}function pc(e,t,r){e.translate=Oe(t.translate,0,r),e.scale=Oe(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function gc(e,t,r,a){e.min=Oe(t.min,r.min,a),e.max=Oe(t.max,r.max,a)}function Vg(e,t,r,a){gc(e.x,t.x,r.x,a),gc(e.y,t.y,r.y,a)}function Ug(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const Hg={duration:.45,ease:[.4,0,.1,1]},vc=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),yc=vc("applewebkit/")&&!vc("chrome/")?Math.round:It;function wc(e){e.min=yc(e.min),e.max=yc(e.max)}function Wg(e){wc(e.x),wc(e.y)}function _u(e,t,r){return e==="position"||e==="preserve-aspect"&&!Yp(uc(t),uc(r),.2)}function zg(e){return e!==e.root&&e.scroll?.wasRoot}const Gg=Eu({attachResizeListener:(e,t)=>ss(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Gn={current:void 0},Su=Eu({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!Gn.current){const e=new Gg({});e.mount(window),e.setOptions({layoutScroll:!0}),Gn.current=e}return Gn.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),$g={pan:{Feature:fg},drag:{Feature:lg,ProjectionNode:Su,MeasureLayout:vu}};function kc(e,t,r){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,n=a[s];n&&De.postRender(()=>n(t,ws(t)))}class Kg extends jr{mount(){const{current:t}=this.node;t&&(this.unmount=pm(t,(r,a)=>(kc(this.node,a,"Start"),s=>kc(this.node,s,"End"))))}unmount(){}}class Xg extends jr{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=gs(ss(this.node.current,"focus",()=>this.onFocus()),ss(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function bc(e,t,r){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),n=a[s];n&&De.postRender(()=>n(t,ws(t)))}class Yg extends jr{mount(){const{current:t}=this.node;t&&(this.unmount=wm(t,(r,a)=>(bc(this.node,a,"Start"),(s,{success:n})=>bc(this.node,s,n?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Ni=new WeakMap,$n=new WeakMap,qg=e=>{const t=Ni.get(e.target);t&&t(e)},Qg=e=>{e.forEach(qg)};function Jg({root:e,...t}){const r=e||document;$n.has(r)||$n.set(r,{});const a=$n.get(r),s=JSON.stringify(t);return a[s]||(a[s]=new IntersectionObserver(Qg,{root:e,...t})),a[s]}function Zg(e,t,r){const a=Jg(t);return Ni.set(e,r),a.observe(e),()=>{Ni.delete(e),a.unobserve(e)}}const e2={some:0,all:1};class t2 extends jr{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:a,amount:s="some",once:n}=t,i={root:r?r.current:void 0,rootMargin:a,threshold:typeof s=="number"?s:e2[s]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,n&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:f,onViewportLeave:d}=this.node.getProps(),h=u?f:d;h&&h(l)};return Zg(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(r2(t,r))&&this.startObserver()}unmount(){}}function r2({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const a2={inView:{Feature:t2},tap:{Feature:Yg},focus:{Feature:Xg},hover:{Feature:Kg}},s2={layout:{ProjectionNode:Su,MeasureLayout:vu}},n2={...Wp,...a2,...$g,...s2},ke=np(n2,vp);var Au={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Tc=fr.createContext&&fr.createContext(Au),i2=["attr","size","title"];function o2(e,t){if(e==null)return{};var r=c2(e,t),a,s;if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function c2(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function en(){return en=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},en.apply(this,arguments)}function Ec(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,a)}return r}function tn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ec(Object(r),!0).forEach(function(a){l2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ec(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function l2(e,t,r){return t=f2(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f2(e){var t=u2(e,"string");return typeof t=="symbol"?t:t+""}function u2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nu(e){return e&&e.map((t,r)=>fr.createElement(t.tag,tn({key:r},t.attr),Nu(t.child)))}function ye(e){return t=>fr.createElement(d2,en({attr:tn({},e.attr)},t),Nu(e.child))}function d2(e){var t=r=>{var{attr:a,size:s,title:n}=e,i=o2(e,i2),o=s||r.size||"1em",l;return r.className&&(l=r.className),e.className&&(l=(l?l+" ":"")+e.className),fr.createElement("svg",en({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,i,{className:l,style:tn(tn({color:e.color||r.color},r.style),e.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),n&&fr.createElement("title",null,n),e.children)};return Tc!==void 0?fr.createElement(Tc.Consumer,null,r=>t(r)):t(Au)}function h2(e){return ye({attr:{viewBox:"0 0 496 512"},child:[{tag:"path",attr:{d:"M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"},child:[]}]})(e)}function x2(e){return ye({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(e)}function Cu(e){return ye({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379 0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628 0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628 0l-22.627 22.627c-6.248 6.248-6.248 16.379 0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"},child:[]}]})(e)}function m2(e){return ye({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M278.9 511.5l-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2l43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6l144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"},child:[]}]})(e)}function Fu(e){return ye({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"},child:[]}]})(e)}function Ci(e){return ye({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"},child:[]}]})(e)}function p2(e){return ye({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm60.1 106.5L224 336l60.1 93.5c5.1 8-.6 18.5-10.1 18.5h-34.9c-4.4 0-8.5-2.4-10.6-6.3C208.9 405.5 192 373 192 373c-6.4 14.8-10 20-36.6 68.8-2.1 3.9-6.1 6.3-10.5 6.3H110c-9.5 0-15.2-10.5-10.1-18.5l60.3-93.5-60.3-93.5c-5.2-8 .6-18.5 10.1-18.5h34.8c4.4 0 8.5 2.4 10.6 6.3 26.1 48.8 20 33.6 36.6 68.5 0 0 6.1-11.7 36.6-68.5 2.1-3.9 6.2-6.3 10.6-6.3H274c9.5-.1 15.2 10.4 10.1 18.4zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function g2(e){return ye({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M528 32H48C21.5 32 0 53.5 0 80v16h576V80c0-26.5-21.5-48-48-48zM0 432c0 26.5 21.5 48 48 48h480c26.5 0 48-21.5 48-48V128H0v304zm352-232c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zm0 64c0-4.4 3.6-8 8-8h144c4.4 0 8 3.6 8 8v16c0 4.4-3.6 8-8 8H360c-4.4 0-8-3.6-8-8v-16zM176 192c35.3 0 64 28.7 64 64s-28.7 64-64 64-64-28.7-64-64 28.7-64 64-64zM67.1 396.2C75.5 370.5 99.6 352 128 352h8.2c12.3 5.1 25.7 8 39.8 8s27.6-2.9 39.8-8h8.2c28.4 0 52.5 18.5 60.9 44.2 3.2 9.9-5.2 19.8-15.6 19.8H82.7c-10.4 0-18.8-10-15.6-19.8z"},child:[]}]})(e)}function v2(e){return ye({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M480 416v16c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V176c0-26.51 21.49-48 48-48h16v208c0 44.112 35.888 80 80 80h336zm96-80V80c0-26.51-21.49-48-48-48H144c-26.51 0-48 21.49-48 48v256c0 26.51 21.49 48 48 48h384c26.51 0 48-21.49 48-48zM256 128c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-96 144l55.515-55.515c4.686-4.686 12.284-4.686 16.971 0L272 256l135.515-135.515c4.686-4.686 12.284-4.686 16.971 0L512 208v112H160v-48z"},child:[]}]})(e)}function y2(e){return ye({attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0zM192 272c44.183 0 80-35.817 80-80s-35.817-80-80-80-80 35.817-80 80 35.817 80 80 80z"},child:[]}]})(e)}function w2(e){return ye({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function k2(e){return ye({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M0 224v272c0 8.84 7.16 16 16 16h80V192H32c-17.67 0-32 14.33-32 32zm360-48h-24v-40c0-4.42-3.58-8-8-8h-16c-4.42 0-8 3.58-8 8v64c0 4.42 3.58 8 8 8h48c4.42 0 8-3.58 8-8v-16c0-4.42-3.58-8-8-8zm137.75-63.96l-160-106.67a32.02 32.02 0 0 0-35.5 0l-160 106.67A32.002 32.002 0 0 0 128 138.66V512h128V368c0-8.84 7.16-16 16-16h96c8.84 0 16 7.16 16 16v144h128V138.67c0-10.7-5.35-20.7-14.25-26.63zM320 256c-44.18 0-80-35.82-80-80s35.82-80 80-80 80 35.82 80 80-35.82 80-80 80zm288-64h-64v320h80c8.84 0 16-7.16 16-16V224c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function b2(e){return ye({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"},child:[]}]})(e)}function T2(e){return ye({attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M624 208h-64v-64c0-8.8-7.2-16-16-16h-32c-8.8 0-16 7.2-16 16v64h-64c-8.8 0-16 7.2-16 16v32c0 8.8 7.2 16 16 16h64v64c0 8.8 7.2 16 16 16h32c8.8 0 16-7.2 16-16v-64h64c8.8 0 16-7.2 16-16v-32c0-8.8-7.2-16-16-16zm-400 48c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm89.6 32h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-74.2-60.2-134.4-134.4-134.4z"},child:[]}]})(e)}function ju(e){return ye({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm95.8 32.6L272 480l-32-136 32-56h-96l32 56-32 136-47.8-191.4C56.9 292 0 350.3 0 422.4V464c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48v-41.6c0-72.1-56.9-130.4-128.2-133.8z"},child:[]}]})(e)}function En(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(e)}function E2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 5 19 12 12 19"},child:[]}]})(e)}function Pu(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(e)}function _2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"},child:[]},{tag:"path",attr:{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"},child:[]}]})(e)}function Du(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function _c(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function Ru(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"20 6 9 17 4 12"},child:[]}]})(e)}function Mu(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"6 9 12 15 18 9"},child:[]}]})(e)}function Ou(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"18 15 12 9 6 15"},child:[]}]})(e)}function Iu(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"},child:[]},{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"},child:[]}]})(e)}function Lu(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]}]})(e)}function Fi(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function S2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"4",y1:"9",x2:"20",y2:"9"},child:[]},{tag:"line",attr:{x1:"4",y1:"15",x2:"20",y2:"15"},child:[]},{tag:"line",attr:{x1:"10",y1:"3",x2:"8",y2:"21"},child:[]},{tag:"line",attr:{x1:"16",y1:"3",x2:"14",y2:"21"},child:[]}]})(e)}function A2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(e)}function Sc(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"},child:[]}]})(e)}function N2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(e)}function C2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"},child:[]},{tag:"polyline",attr:{points:"10 17 15 12 10 7"},child:[]},{tag:"line",attr:{x1:"15",y1:"12",x2:"3",y2:"12"},child:[]}]})(e)}function Ac(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(e)}function F2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"3",y1:"12",x2:"21",y2:"12"},child:[]},{tag:"line",attr:{x1:"3",y1:"6",x2:"21",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"18",x2:"21",y2:"18"},child:[]}]})(e)}function Nc(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},child:[]}]})(e)}function j2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}function Cc(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"5"},child:[]},{tag:"line",attr:{x1:"12",y1:"1",x2:"12",y2:"3"},child:[]},{tag:"line",attr:{x1:"12",y1:"21",x2:"12",y2:"23"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"},child:[]},{tag:"line",attr:{x1:"1",y1:"12",x2:"3",y2:"12"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"23",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"},child:[]},{tag:"line",attr:{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"},child:[]}]})(e)}function ns(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"17 8 12 3 7 8"},child:[]},{tag:"line",attr:{x1:"12",y1:"3",x2:"12",y2:"15"},child:[]}]})(e)}function Eo(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function P2(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function Fc(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(e)}function is(e){return ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}const _t={name:"Dina Public school",branch:"Paharpur",Address:"Paharpur, Banshihari, Dakshin Dinajpur, 733125",regNumber:"IV006608/IV",runBy:"M.M.D.C.T.",mobileNumber:"+91 6295884463",email:"dinapublicschool.paharpur@gmail.com"},la=["LKG","UKG","I","II","III","IV","V","VI","VII"],D2={hidden:{opacity:0,y:-20,height:0},visible:{opacity:1,y:0,height:"auto",transition:{duration:.3,ease:"easeInOut"}},exit:{opacity:0,y:-20,height:0,transition:{duration:.2,ease:"easeInOut"}}},R2={hidden:{opacity:0,y:10,scale:.95},visible:{opacity:1,y:0,scale:1,transition:{duration:.15,ease:"easeOut"}},exit:{opacity:0,y:10,scale:.95,transition:{duration:.1,ease:"easeIn"}}},M2=({toggleSidebar:e})=>{const{theme:t,toggleTheme:r}=vn(),{user:a,isAuthenticated:s,logout:n}=yn(),[i,o]=L.useState(!1),[l,u]=L.useState(!1),[f,d]=L.useState(!1),h=mn(),p=ps(),x=L.useRef(null),m=L.useRef(null);L.useEffect(()=>{const v=()=>{o(window.scrollY>10)};return window.addEventListener("scroll",v,{passive:!0}),()=>window.removeEventListener("scroll",v)},[]),L.useEffect(()=>{u(!1),d(!1)},[h]),L.useEffect(()=>{const v=R=>{x.current&&!x.current.contains(R.target)&&d(!1),m.current&&!m.current.contains(R.target)&&!R.target.closest('button[aria-label^="Toggle"]')&&u(!1)};return document.addEventListener("mousedown",v),document.addEventListener("touchstart",v),()=>{document.removeEventListener("mousedown",v),document.removeEventListener("touchstart",v)}},[x,m]);const g=()=>{n(),p("/")},y=()=>{d(!f)},T=v=>v?v.split(" ").map(R=>R[0]).join("").toUpperCase().substring(0,2):"U";return c.jsxs("header",{className:`fixed top-0 left-0 right-0 z-50 transition-all duration-300 ${i?"bg-white/95 dark:bg-gray-900/95 backdrop-blur-md shadow-lg":"bg-white/90 dark:bg-gray-900/90 backdrop-blur-sm shadow-sm"}`,children:[c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between h-16",children:[c.jsx("div",{className:"flex items-center",children:c.jsxs(Qt,{to:"/",className:"flex-shrink-0 flex items-center space-x-3 group","aria-label":"Home",children:[c.jsx("div",{className:"bg-gradient-to-br from-primary-500 to-primary-600 p-2 rounded-xl group-hover:scale-105 transition-transform duration-300 shadow-md",children:c.jsx(Pu,{className:"h-6 w-6 text-white"})}),c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{className:"text-xl font-bold bg-gradient-to-r from-primary-600 to-primary-700 dark:from-primary-400 dark:to-primary-300 bg-clip-text text-transparent",children:_t.name}),c.jsx("span",{className:"text-xs px-2 py-0.5 bg-primary-50 dark:bg-primary-900/30 text-primary-600 dark:text-primary-300 rounded-full font-medium",children:_t.branch})]})]})}),c.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[c.jsx("nav",{className:"hidden md:flex items-center space-x-1",children:s&&c.jsx(Qt,{to:"/dashboard/students",className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${h.pathname.startsWith("/dashboard")?"text-primary-600 dark:text-primary-400 bg-primary-50 dark:bg-primary-900/20":"text-gray-700 dark:text-gray-300 hover:text-primary-600 dark:hover:text-primary-400 hover:bg-gray-100 dark:hover:bg-gray-800/50"}`,children:"Dashboard"})}),c.jsx("button",{onClick:r,className:"hidden md:flex items-center justify-center p-2 rounded-full text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 transition-colors","aria-label":`Switch to ${t==="dark"?"light":"dark"} mode`,children:t==="dark"?c.jsx(Cc,{className:"h-5 w-5"}):c.jsx(Nc,{className:"h-5 w-5"})}),s?c.jsx("div",{className:"flex items-center space-x-2",ref:x,children:c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:y,className:"flex items-center space-x-2 p-1 pr-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900","aria-expanded":f,"aria-haspopup":"true",children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center text-white font-medium text-sm",children:T(a?.name||a?.email)}),c.jsx("span",{className:"hidden md:inline text-sm font-medium text-gray-700 dark:text-gray-300",children:a?.name||"User"}),f?c.jsx(Ou,{className:"h-4 w-4 text-gray-500"}):c.jsx(Mu,{className:"h-4 w-4 text-gray-500"})]}),c.jsx(mr,{children:f&&c.jsxs(ke.div,{initial:"hidden",animate:"visible",exit:"exit",variants:R2,className:"absolute right-0 mt-2 w-56 rounded-lg bg-white dark:bg-gray-800 shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none z-50 overflow-hidden",role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu-button",tabIndex:"-1",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a?.name||"User"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:a?.email||""}),c.jsx("p",{className:"mt-1 text-xs font-medium text-primary-600 dark:text-primary-400",children:a.role?a.role.charAt(0).toUpperCase()+a.role.slice(1):"User"})]}),c.jsxs("div",{className:"py-1",children:[c.jsxs(Qt,{to:"/dashboard/profile",className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",role:"menuitem",children:[c.jsx(Eo,{className:"mr-3 h-5 w-5 text-gray-400"}),"Your Profile"]}),c.jsxs(Qt,{to:"/dashboard/settings",className:"flex items-center px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",role:"menuitem",children:[c.jsx(j2,{className:"mr-3 h-5 w-5 text-gray-400"}),"Settings"]})]}),c.jsx("div",{className:"py-1 border-t border-gray-100 dark:border-gray-700",children:c.jsxs("button",{onClick:g,className:"w-full text-left flex items-center px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors",role:"menuitem",children:[c.jsx(Ac,{className:"mr-3 h-5 w-5"}),"Sign out"]})})]})})]})}):c.jsxs("div",{className:"hidden md:flex items-center space-x-3",children:[c.jsx(Qt,{to:"/login",className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:text-primary-600 dark:hover:text-primary-400 transition-colors",children:"Sign in"}),c.jsx(Qt,{to:"/register",className:"px-4 py-2 text-sm font-medium text-white bg-gradient-to-r from-primary-500 to-primary-600 rounded-lg hover:from-primary-600 hover:to-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 transition-all shadow-md hover:shadow-lg",children:"Get started"})]}),c.jsx("button",{onClick:()=>u(!l),className:"md:hidden p-2 rounded-full text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-900 transition-colors","aria-label":l?"Close menu":"Open menu","aria-expanded":l,"aria-controls":"mobile-menu",children:l?c.jsx(is,{className:"h-6 w-6","aria-hidden":"true"}):c.jsx(F2,{className:"h-6 w-6","aria-hidden":"true"})})]})]})}),c.jsx(mr,{children:l&&c.jsxs(ke.div,{ref:m,initial:"hidden",animate:"visible",exit:"exit",variants:D2,className:"md:hidden bg-white dark:bg-gray-800 shadow-xl border-t border-gray-100 dark:border-gray-700 overflow-hidden",children:[c.jsxs("div",{className:"px-4 py-3 border-b border-gray-100 dark:border-gray-700",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:a?.name||"User"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:a?.email||""})]}),c.jsxs("nav",{className:"py-2",children:[c.jsx(Qt,{to:"/dashboard/students",className:"block px-4 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-700/50 rounded-lg transition-colors",onClick:()=>u(!1),children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(A2,{className:"h-5 w-5 text-primary-500"}),c.jsx("span",{children:"Dashboard"})]})}),c.jsx(Qt,{to:"/dashboard/students",className:"block px-4 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-700/50 rounded-lg transition-colors",onClick:()=>u(!1),children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(P2,{className:"h-5 w-5 text-primary-500"}),c.jsx("span",{children:"Students"})]})}),c.jsx(Qt,{to:"/dashboard/subjects",className:"block px-4 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 dark:text-gray-200 dark:hover:bg-gray-700/50 rounded-lg transition-colors",onClick:()=>u(!1),children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(_2,{className:"h-5 w-5 text-primary-500"}),c.jsx("span",{children:"Subjects"})]})}),c.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:t==="dark"?"Light Mode":"Dark Mode"}),c.jsx("button",{onClick:r,className:"p-2 rounded-full text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors","aria-label":`Switch to ${t==="dark"?"light":"dark"} mode`,children:t==="dark"?c.jsx(Cc,{className:"h-5 w-5"}):c.jsx(Nc,{className:"h-5 w-5"})})]}),s&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"border-t border-gray-100 dark:border-gray-700 my-1"}),c.jsxs("button",{onClick:g,className:"w-full text-left px-4 py-3 text-base font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors flex items-center space-x-3",children:[c.jsx(Ac,{className:"h-5 w-5"}),c.jsx("span",{children:"Sign out"})]})]})]})]})})]})};function O2(){const[e,t]=L.useState([]),[r,a]=L.useState(!0),[s,n]=L.useState(null);return L.useEffect(()=>{if(window.location.hash==="#results"){const o=document.getElementById("results");o&&o.scrollIntoView({behavior:"smooth"})}(async()=>{try{a(!0);const{data:o}=await Pe.get("/public/results/status"),l=o.items?o.items.filter(u=>u.isPublished):[];t(l)}catch(o){console.error("Error fetching public statuses:",o),n("Failed to load published results. Please try again later.")}finally{a(!1)}})()},[]),c.jsxs("div",{className:"min-h-[calc(100vh-4rem)] w-full bg-gray-100 dark:bg-gray-900  overflow-x-hidden",children:[c.jsx("div",{className:"fixed w-full z-50",children:c.jsx(M2,{})}),c.jsxs("div",{className:"max-w-7xl mx-auto mt-14 w-full px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[c.jsxs("section",{id:"results",className:"py-8",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-6 flex items-center",children:[c.jsx(Cu,{className:"mr-2 text-blue-500"}),"Published Results"]}),c.jsx(L2,{publicResultStatuses:e,loading:r,error:s})]}),c.jsx(B2,{}),c.jsx(I2,{})]})]})}const I2=()=>c.jsx(ke.div,{className:"w-full",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},children:c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden border border-gray-100 dark:border-gray-700",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 p-4 text-white",children:c.jsxs("h2",{className:"text-2xl font-bold",children:[c.jsx("span",{className:"text-blue-100",children:"Marks"}),c.jsx("span",{className:"text-purple-100",children:"Mint"}),c.jsx("span",{className:"text-sm font-normal ml-2 opacity-90",children:"Student Management System"})]})}),c.jsxs("div",{className:"p-5",children:[c.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-blue-100 to-purple-100 p-1",children:c.jsx("div",{className:"w-full h-full rounded-full bg-white dark:bg-gray-700 flex items-center justify-center",children:c.jsx(ju,{className:"h-10 w-10 text-blue-600 dark:text-blue-400"})})}),c.jsx("div",{className:"absolute -bottom-1 -right-1 bg-white dark:bg-gray-800 p-1.5 rounded-full shadow-md",children:c.jsx(m2,{className:"h-3 w-3 text-purple-600 dark:text-purple-400"})})]}),c.jsxs("div",{className:"flex-1 text-center md:text-left",children:[c.jsxs("div",{className:"mb-2",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Sahin Arman"}),c.jsx("p",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"Full Stack Developer & Creator"})]}),c.jsxs("div",{className:"flex flex-wrap justify-center md:justify-start gap-4 text-sm",children:[c.jsxs("a",{href:"mailto:sahin401099@gmail.com",className:"flex items-center text-gray-600 hover:text-blue-600 dark:text-gray-300 dark:hover:text-blue-400 transition-colors",children:[c.jsx(Fu,{className:"mr-1.5"})," Email"]}),c.jsxs("a",{href:"https://github.com/sahin-arman",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-gray-600 hover:text-gray-800 dark:text-gray-300 dark:hover:text-gray-100 transition-colors",children:[c.jsx(h2,{className:"mr-1.5"})," GitHub"]}),c.jsxs("a",{href:"https://linkedin.com/in/sahin-arman",target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-gray-600 hover:text-blue-700 dark:text-gray-300 dark:hover:text-blue-400 transition-colors",children:[c.jsx(x2,{className:"mr-1.5"})," LinkedIn"]})]})]})]}),c.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-100 dark:border-gray-700",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"Built With"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("span",{className:"px-3 py-1.5 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-sm rounded-full font-medium",children:"React.js"}),c.jsx("span",{className:"px-3 py-1.5 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 text-sm rounded-full font-medium",children:"Node.js"}),c.jsx("span",{className:"px-3 py-1.5 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-300 text-sm rounded-full font-medium",children:"MongoDB"}),c.jsx("span",{className:"px-3 py-1.5 bg-amber-50 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300 text-sm rounded-full font-medium",children:"Tailwind CSS"})]})]})]})]})});function L2({publicResultStatuses:e=[],loading:t,error:r}){const a=ps(),s=["from-blue-500 to-blue-600","from-purple-500 to-pink-500","from-green-500 to-teal-500","from-yellow-500 to-orange-500","from-red-500 to-pink-600","from-indigo-500 to-purple-600"];return t?c.jsx("div",{className:"flex justify-center items-center py-12",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r?c.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-6",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(En,{className:"h-5 w-5 text-red-400"})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm text-red-700",children:r})})]})}):c.jsx("div",{className:"space-y-8",children:e.length>0&&c.jsx("div",{children:c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.length>0?e.map((n,i)=>{const o=i%s.length;return c.jsx(ke.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:i*.1},whileHover:{y:-5},className:"cursor-pointer",onClick:()=>a(`/results/term/${n.term}`),children:c.jsx("div",{className:`bg-gradient-to-r ${s[o]} rounded-xl shadow-lg overflow-hidden h-full transform transition-all duration-300 hover:shadow-xl`,children:c.jsxs("div",{className:"p-6 text-white",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-bold",children:n.term}),c.jsxs("p",{className:"text-white/80 text-sm mt-1",children:[n.stats?.totalStudents||0," students"]})]}),c.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-white/20",children:[c.jsx(Cu,{className:"mr-1"})," Published"]})]}),c.jsx("div",{className:"mt-6"}),c.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[c.jsx("span",{className:"text-sm opacity-80",children:n.publishedAt?`Published ${new Date(n.publishedAt).toLocaleDateString()}`:"Recently published"}),c.jsxs("button",{type:"button",className:"inline-flex items-center px-3 py-1.5 border border-white/30 rounded-md text-xs font-medium text-white hover:bg-white/10 focus:outline-none",onClick:l=>{l.stopPropagation(),a(`/results/term/${n.term}`)},children:["View Results",c.jsx(Ci,{className:"ml-1.5 h-3.5 w-3.5"})]})]})]})})},n.term)}):c.jsxs("div",{className:"col-span-full text-center py-8",children:[c.jsx(FiCalendar,{className:"mx-auto h-12 w-12 text-gray-400"}),c.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900 dark:text-white",children:"No published results"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Check back later for updates."})]})})})})}const B2=()=>{const e={name:_t?.name,branch:_t?.branch,address:_t?.Address,regNumber:_t?.regNumber,mobileNumber:_t?.mobileNumber,email:_t?.email,runBy:_t?.runBy};return c.jsxs("div",{className:"relative w-full bg-white/70 dark:bg-gray-800/60 backdrop-blur rounded-2xl shadow-sm ring-1 ring-gray-200 dark:ring-gray-700 overflow-hidden transition-all duration-300 hover:shadow-md",children:[c.jsx("div",{className:"flex items-center justify-between px-6 pt-6",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-blue-500 to-indigo-600 text-white mr-3",children:c.jsx(k2,{className:"h-6 w-6"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:e.name}),c.jsx("span",{className:"inline-block mt-1 text-xs px-2 py-0.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300",children:e.branch})]})]})}),c.jsxs("div",{className:"p-6 space-y-4",children:[c.jsxs("div",{className:"flex items-start",children:[c.jsx(y2,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mt-0.5 mr-3 flex-shrink-0"}),c.jsx("p",{className:"text-gray-700 dark:text-gray-300",children:e.address})]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Ci,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-3 flex-shrink-0"}),c.jsxs("a",{href:"https://dpspaharpur.web.app/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors flex items-center",children:["Visit School Website",c.jsx(Ci,{className:"ml-1 h-3 w-3"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(g2,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-3 flex-shrink-0"}),c.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["Reg: ",e.regNumber]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(ju,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-3 flex-shrink-0"}),c.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["Run By: ",e.runBy]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(w2,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-3 flex-shrink-0"}),c.jsx("a",{href:`tel:${e.mobileNumber}`,className:"text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:e.mobileNumber})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx(Fu,{className:"h-5 w-5 text-gray-500 dark:text-gray-400 mr-3 flex-shrink-0"}),c.jsx("a",{href:`mailto:${e.email}`,className:"text-gray-700 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-colors",children:e.email})]})]})]})]})};function V2(){const[e,t]=L.useState({username:"",password:""}),[r,a]=L.useState(!1),[s,n]=L.useState(!1),{login:i,currentUser:o}=yn(),l=ps();L.useEffect(()=>{o&&l("/dashboard",{replace:!0})},[o,l]);const u=async d=>{d.preventDefault(),a(!0);try{const h=await i(e);if(h.success)cr.success("Login successful!"),setTimeout(()=>{l("/dashboard/students",{replace:!0})},100);else throw new Error(h.error||"Login failed. Please try again.")}catch(h){console.error("Login error:",h),cr.error(h.message||"Login failed. Please check your credentials.")}finally{a(!1)}},f=d=>{const{name:h,value:p}=d.target;t(x=>({...x,[h]:p}))};return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-500 to-purple-600 p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl overflow-hidden",children:[c.jsxs("div",{className:"bg-indigo-600 py-6 px-8 text-center",children:[c.jsx("h1",{className:"text-2xl font-bold text-white",children:"MarksMint"}),c.jsx("p",{className:"text-indigo-100 mt-1",children:"Sign in to your admin account"})]}),c.jsxs("div",{className:"p-8",children:[c.jsxs("form",{onSubmit:u,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),c.jsxs("div",{className:"relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Eo,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"text",id:"username",name:"username",value:e.username,onChange:f,className:"focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md",placeholder:"Enter your username",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsxs("div",{className:"relative rounded-md shadow-sm",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(N2,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:s?"text":"password",id:"password",name:"password",value:e.password,onChange:f,className:"focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-md",placeholder:"Enter your password",required:!0}),c.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:c.jsx("button",{type:"button",onClick:()=>n(!s),className:"text-gray-400 hover:text-gray-500 focus:outline-none",children:s?c.jsx(Iu,{className:"h-5 w-5"}):c.jsx(Lu,{className:"h-5 w-5"})})})]})]}),c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{id:"remember-me",name:"remember-me",type:"checkbox",className:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),c.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-700",children:"Remember me"})]})}),c.jsx("div",{children:c.jsxs("button",{type:"submit",disabled:r,className:`group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200 ${r?"opacity-70 cursor-not-allowed":""}`,children:[c.jsx("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3",children:c.jsx(C2,{className:`h-5 w-5 text-indigo-300 group-hover:text-indigo-200 transition-colors ${r?"animate-pulse":""}`})}),r?"Signing in...":"Sign in"]})})]}),c.jsxs("div",{className:"mt-8 space-y-4",children:[c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-200"})}),c.jsx("div",{className:"relative flex justify-center",children:c.jsx("span",{className:"px-3 bg-white text-sm text-gray-500",children:"Need help?"})})]}),c.jsxs("div",{className:"grid gap-3",children:[c.jsxs(Qt,{to:"/",className:"group relative w-full flex justify-center py-2 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200",children:[c.jsx("svg",{className:"h-5 w-5 text-gray-500 group-hover:text-gray-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Back to Home"]}),c.jsxs("a",{href:"mailto:sahin401099@gmail.com",className:"group relative w-full flex justify-center py-2 px-4 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-colors duration-200",children:[c.jsx("svg",{className:"h-5 w-5 text-gray-500 group-hover:text-gray-600 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Contact Support"]})]})]})]}),c.jsx("div",{className:"bg-gray-50 px-8 py-4 text-center",children:c.jsxs("p",{className:"text-xs text-gray-500",children:[" ",new Date().getFullYear()," MarksMint. All rights reserved."]})})]})})})}function jc(){const{term:e}=Hh(),[t,r]=L.useState({class:"",roll:"",dob:""}),[a,s]=L.useState(!1),[n,i]=L.useState(""),[o,l]=L.useState([]),[u,f]=L.useState({}),[d,h]=L.useState(!0),[p,x]=L.useState(null),[m,g]=L.useState(100);L.useEffect(()=>{(async()=>{try{const S=await Pe.get("/configs"),P=S.data.items||[],H=P.map(C=>C.class);l(H),console.log(S.data);const O={};P.forEach(C=>{C.class&&C.fullMarks&&(O[C.class]=C.fullMarks)}),f(O)}catch(S){console.error("Error fetching classes:",S),cr.error("Failed to load classes")}finally{h(!1)}})()},[]);const y=k=>{const{name:S,value:P}=k.target;r(H=>({...H,[S]:P}))},T=async k=>{if(k.preventDefault(),!e){cr.error("No exam term specified");return}if(!t.class||!t.roll||!t.dob){cr.error("Please fill in all fields");return}s(!0),i(""),x(null);try{const S=await Pe.get("/public/results",{params:{class:t.class,roll:t.roll,dob:t.dob,term:e}});x(S.data)}catch(S){console.error("Error fetching result:",S),i(S.response?.data?.message||"Failed to fetch result. Please check your details and try again."),cr.error("Failed to fetch results. Please check your details and try again.")}finally{s(!1)}},v=k=>{if(!k)return"";try{const S={year:"numeric",month:"long",day:"numeric"};return new Date(k).toLocaleDateString(void 0,S)}catch{return""}},R={totalMarks:0,maxMarks:0,percentage:"0.00",grade:"N/A"};L.useEffect(()=>{if(t.class&&e&&u[t.class]?.[e]){const k=u[t.class][e];g(parseInt(k)||100)}else p?.fullMarks&&g(parseInt(p.fullMarks)||100)},[t.class,e,u,p?.fullMarks]);const D=()=>{try{if(!p||!p.marks||typeof p.marks!="object")return{...R};const k=p.marks||{},S=Array.isArray(p.subjects)?p.subjects:[],P=Object.values(k).reduce((C,W)=>C+(parseInt(W)||0),0),H=Math.max(S.length,1),O=H>0?P/(m*H)*100:0;return{totalMarks:P,maxMarks:m*H,percentage:O.toFixed(2),grade:b(O)}}catch(k){return console.error("Error calculating metrics:",k),{...R}}},b=k=>k>=90?"A+":k>=80?"A":k>=70?"B+":k>=60?"B":k>=50?"C":k>=40?"D":"F";if(d)return c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Sc,{className:"animate-spin h-8 w-8 text-blue-500 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:"Loading..."})]})});if(p){const k=D()||R,S=p||{};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-gray-50 dark:from-gray-900 dark:to-gray-800 py-8 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md overflow-hidden mb-6",children:c.jsxs("div",{className:"p-6 text-center",children:[c.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-1",children:_t.name}),c.jsxs("h2",{className:"text-xl text-blue-600 dark:text-blue-400 font-medium mb-2",children:[e," Examination Result"]}),c.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[`${_t.branch} | `,`${_t.Address} | `,"Academic Session: ",S.student?.session||"2024-2025"]})]})}),c.jsxs("div",{className:"grid grid-cols-1 gap-6 mb-6",children:[c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700 transition-all duration-300 hover:shadow-2xl w-full",children:[c.jsx("div",{className:"p-3 bg-gradient-to-r from-blue-600 to-indigo-600",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx(Eo,{className:"h-5 w-5 text-white mr-2"}),c.jsx("h2",{className:"text-lg font-bold text-white",children:"Student Information"})]}),c.jsx("div",{className:"bg-white/20 px-3 py-1 rounded-full",children:c.jsx("span",{className:"text-sm font-medium text-white",children:S.student?.session||"2024-25"})})]})}),c.jsx("div",{className:"p-6",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Full Name"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:S.student?.studentName||"N/A"})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Father's Name"}),c.jsx("p",{className:"mt-1 text-lg font-semibold text-gray-900 dark:text-white",children:S.student?.fatherName||"N/A"})]})]}),c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Academic Details"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Class"}),c.jsxs("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:[S.student?.class||t.class," ",S.student?.section?`- ${S.student.section}`:""]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Roll No"}),c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:S.student?.rollNo||t.roll})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"DOB"}),c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:v(S.student?.dob)||"N/A"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Term"}),c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e||"N/A"})]})]})]})})]})})]}),c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-xl overflow-hidden border border-gray-100 dark:border-gray-700 transition-all duration-300 hover:shadow-2xl w-full",children:[c.jsx("div",{className:"bg-gradient-to-r from-green-600 to-purple-600 px-6 py-4",children:c.jsxs("h3",{className:"text-lg font-bold text-white flex items-center",children:[c.jsx(Pu,{className:"mr-2"})," Performance Overview"]})}),c.jsx("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700",children:c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-xl text-center border border-blue-100 dark:border-blue-800/50",children:[c.jsx("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-1",children:"Total Marks"}),c.jsx("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:k.totalMarks}),c.jsxs("p",{className:"text-xs text-blue-600/70 dark:text-blue-300/70 mt-1",children:["out of ",k.maxMarks]})]}),c.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-xl text-center border border-green-100 dark:border-green-800/50",children:[c.jsx("p",{className:"text-sm font-medium text-green-700 dark:text-green-300 mb-1",children:"Percentage"}),c.jsxs("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:[k.percentage,"%"]}),c.jsx("p",{className:"text-xs text-green-600/70 dark:text-green-300/70 mt-1",children:"Overall Score"})]}),c.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-xl text-center border border-purple-100 dark:border-purple-800/50",children:[c.jsx("p",{className:"text-sm font-medium text-purple-700 dark:text-purple-300 mb-1",children:"Grade"}),c.jsx("p",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:b(parseFloat(k.percentage))}),c.jsx("p",{className:"text-xs text-purple-600/70 dark:text-purple-300/70 mt-1",children:"Performance"})]}),c.jsxs("div",{className:"bg-amber-50 dark:bg-amber-900/20 p-4 rounded-xl text-center border border-amber-100 dark:border-amber-800/50",children:[c.jsx("p",{className:"text-sm font-medium text-amber-700 dark:text-amber-300 mb-1",children:"Rank"}),c.jsxs("p",{className:"text-2xl font-bold text-amber-600 dark:text-amber-400",children:[S.rank||"N/A",S.totalStudents&&` / ${S.totalStudents}`]}),c.jsx("p",{className:"text-xs text-amber-600/70 dark:text-amber-300/70 mt-1",children:"Class Position"})]})]})}),c.jsx("div",{className:"p-1",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Subject"}),c.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Marks"}),c.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"%"}),c.jsx("th",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wider",children:"Grade"})]})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:S.subjects?.map((P,H)=>{const O=S.marks?.[P.key],C=O==="AB",W=C?0:Number(O)||0,q=u[t.class]?.[e]||S.fullMarks||100,Q=C?0:Math.round(W/q*100),ae=C?"AB":b(Q);return c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"flex-shrink-0 h-8 w-8 flex items-center justify-center rounded-full bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-300 mr-3",children:c.jsx("span",{className:"text-sm font-medium",children:H+1})}),c.jsx("span",{className:"text-base font-medium text-gray-900 dark:text-white",children:P.name})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:c.jsxs("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[C?"Absent":W,c.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400 ml-1",children:["/ ",q]})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:c.jsxs("span",{className:`text-base font-semibold ${C?"text-gray-500 dark:text-gray-400":Q>=80?"text-green-600 dark:text-green-400":Q>=60?"text-blue-600 dark:text-blue-400":Q>=40?"text-yellow-600 dark:text-yellow-400":"text-red-600 dark:text-red-400"}`,children:[Q,"%"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:c.jsx("span",{className:`px-3 py-1 inline-flex text-sm leading-5 font-semibold rounded-full 
                                ${ae==="A+"?"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200":ae==="A"?"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-200":ae==="B"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-200"}`,children:ae})})]},H)})})]})})})]})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx("button",{onClick:()=>x(null),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors duration-200",children:"Check Another Result"})})]})})}return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-gray-50 dark:from-gray-900 dark:to-gray-800 py-12 px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"max-w-md mx-auto",children:[c.jsxs("div",{className:"text-center mb-10",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:_t.name}),c.jsxs("p",{className:"text-gray-600 dark:text-gray-300",children:["Enter your details to view your ",e," results"]})]}),c.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden",children:c.jsxs("div",{className:"p-8",children:[n&&c.jsx("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border-l-4 border-red-500 rounded",children:c.jsxs("div",{className:"flex items-start",children:[c.jsx("div",{className:"flex-shrink-0 pt-0.5",children:c.jsx(En,{className:"h-5 w-5 text-red-500","aria-hidden":"true"})}),c.jsx("div",{className:"ml-3",children:c.jsx("p",{className:"text-sm text-red-700 dark:text-red-300",children:n})})]})}),c.jsxs("form",{onSubmit:T,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"class",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Class"}),c.jsxs("select",{id:"class",name:"class",value:t.class,onChange:y,className:"w-full px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 dark:text-white transition-colors",required:!0,children:[c.jsx("option",{value:"",children:"Select Class"}),o.map((k,S)=>c.jsx("option",{value:k,children:k},S))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"roll",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Roll Number"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(S2,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"text",id:"roll",name:"roll",value:t.roll,onChange:y,className:"w-full pl-10 px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 dark:text-white transition-colors",placeholder:"Enter your roll number",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"dob",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Date of Birth"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:c.jsx(Du,{className:"h-5 w-5 text-gray-400"})}),c.jsx("input",{type:"date",id:"dob",name:"dob",value:t.dob,onChange:y,className:"w-full pl-10 px-4 py-3 border-2 border-gray-200 dark:border-gray-600 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white dark:bg-gray-700 dark:text-white transition-colors",required:!0})]})]}),c.jsx("div",{className:"pt-2",children:c.jsx("button",{type:"submit",disabled:a,className:`w-full flex justify-center items-center py-3 px-6 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all transform hover:scale-[1.02] ${a?"opacity-70 cursor-not-allowed":""}`,children:a?c.jsxs(c.Fragment,{children:[c.jsx(Sc,{className:"animate-spin -ml-1 mr-2 h-5 w-5 text-white"}),"Loading..."]}):c.jsxs(c.Fragment,{children:["View Results",c.jsx(E2,{className:"ml-2 -mr-1 h-5 w-5 group-hover:translate-x-1 transition-transform"})]})})})]})]})}),c.jsx("div",{className:"mt-8 text-center",children:c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Need help? Contact your school administration."})})]})})}/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),H2=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,a)=>a?a.toUpperCase():r.toLowerCase()),Pc=e=>{const t=H2(e);return t.charAt(0).toUpperCase()+t.slice(1)},Bu=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim(),W2=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var z2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G2=L.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:s="",children:n,iconNode:i,...o},l)=>L.createElement("svg",{ref:l,...z2,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:Bu("lucide",s),...!n&&!W2(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,f])=>L.createElement(u,f)),...Array.isArray(n)?n:[n]]));/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gr=(e,t)=>{const r=L.forwardRef(({className:a,...s},n)=>L.createElement(G2,{ref:n,iconNode:t,className:Bu(`lucide-${U2(Pc(e))}`,`lucide-${e}`,a),...s}));return r.displayName=Pc(e),r};/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],K2=gr("award",$2);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X2=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Y2=gr("book-open",X2);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Q2=gr("chevron-down",q2);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Z2=gr("house",J2);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ev=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],tv=gr("log-out",ev);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rv=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],Dc=gr("menu",rv);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const av=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],sv=gr("settings",av);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nv=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],iv=gr("users",nv);/**
 * @license lucide-react v0.542.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Kn=gr("x",ov),ja=({to:e,icon:t,label:r,onClick:a,isCollapsed:s,color:n="indigo"})=>{const{pathname:i}=mn(),o=i===e||i==="/dashboard"&&e==="/dashboard/students",l={blue:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-200",green:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-200",amber:"bg-amber-100 text-amber-700 dark:bg-amber-900/30 dark:text-amber-200",purple:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-200"};return c.jsxs(Wh,{to:e,onClick:a,className:`
        flex items-center gap-3 p-3 rounded-lg transition-all duration-200
        ${o?l[n]||l.blue:"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
        ${s?"justify-center":""}
      `,title:s?r:"",children:[c.jsx("div",{className:`p-2 rounded-lg ${o?"bg-white/20":`bg-${n}-100 text-${n}-600 dark:bg-${n}-900/50 dark:text-${n}-300`}`,children:c.jsx(t,{size:18,className:"flex-shrink-0"})}),!s&&c.jsx("span",{className:"text-sm font-medium",children:r})]})};function cv({children:e}){const[t,r]=L.useState(window.innerWidth<1024),[a,s]=L.useState(!1),[n,i]=L.useState(!1),[o,l]=L.useState(!1),u=L.useRef(null),f=mn(),d=ps(),{logout:h}=yn(),{theme:p,toggleTheme:x}=vn();L.useEffect(()=>{function g(y){u.current&&!u.current.contains(y.target)&&l(!1)}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const m=()=>{h(),d("/login")};return L.useEffect(()=>{const g=()=>{const y=window.innerWidth<1024;r(y),y||s(!1)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),L.useEffect(()=>{t&&s(!1)},[f.pathname,t]),c.jsxs("div",{className:`flex h-screen bg-gray-100 dark:bg-gray-900 ${p==="dark"?"dark":""}`,children:[c.jsxs("div",{className:`
          fixed lg:static z-50 inset-y-0 left-0 bg-white dark:bg-gray-800 shadow-lg
          transition-all duration-300
          ${t?"w-64":n?"w-20":"w-64"}
          ${a?"translate-x-0":"-translate-x-full lg:translate-x-0"}
        `,children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[c.jsx("span",{className:`font-bold text-lg ${n?"hidden":"block"}`,children:"MarksMint"}),n&&c.jsx("span",{className:"text-xl font-bold"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{className:"hidden lg:flex items-center justify-center hover:bg-gray-100 p-1 rounded",onClick:()=>i(!n),"aria-label":n?"Expand sidebar":"Collapse sidebar",children:n?c.jsx(Dc,{size:20}):c.jsx(Kn,{size:20})}),c.jsx("button",{className:"lg:hidden hover:bg-gray-100 p-1 rounded",onClick:()=>s(!1),"aria-label":"Close sidebar",children:c.jsx(Kn,{size:20})})]})]}),c.jsxs("div",{className:"flex flex-col h-[calc(100vh-65px)]",children:[c.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[c.jsx(ja,{to:"/dashboard/students",icon:iv,label:"Students",isCollapsed:!t&&n,onClick:()=>t&&s(!1),color:"blue"}),c.jsx(ja,{to:"/dashboard/marks",icon:Y2,label:"Marks",isCollapsed:!t&&n,onClick:()=>t&&s(!1),color:"green"}),c.jsx(ja,{to:"/dashboard/results-publish",icon:K2,label:"Publish Results",isCollapsed:!t&&n,onClick:()=>t&&s(!1),color:"amber"}),c.jsx(ja,{to:"/dashboard/config",icon:sv,label:"Settings",isCollapsed:!t&&n,onClick:()=>t&&s(!1),color:"purple"})]}),c.jsx("div",{className:"p-2 border-t border-gray-200 dark:border-gray-700 absolute bottom-0 left-0 right-0",children:c.jsx(ja,{to:"/",icon:Z2,label:"Back To Home",isCollapsed:!t&&n,onClick:()=>t&&s(!1)})})]})]}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden bg-gray-50 dark:bg-gray-900",children:[c.jsxs("nav",{className:"flex items-center justify-between bg-white shadow px-4 py-3 dark:bg-gray-800",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>s(!a),className:"lg:hidden text-gray-500 hover:text-gray-700 dark:text-gray-300 dark:hover:text-white","aria-label":"Toggle menu",children:a?c.jsx(Kn,{size:24}):c.jsx(Dc,{size:24})}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-100 dark:from-blue-900/30 dark:to-indigo-900/30 px-4 py-2 rounded-lg shadow-sm border border-gray-100 dark:border-gray-700",children:c.jsx("h1",{className:"text-lg font-bold bg-gradient-to-r from-blue-600 to-indigo-700 bg-clip-text text-transparent dark:from-blue-400 dark:to-indigo-300",children:"MarksMint"})}),c.jsx("div",{className:"hidden sm:block border-l-2 border-gray-200 dark:border-gray-600 h-8"}),c.jsxs("div",{className:"hidden sm:block text-gray-700 dark:text-gray-300",children:[c.jsx("h2",{className:"font-semibold",children:"Dina Public School"}),c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Paharpur Branch"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:x,className:"p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700","aria-label":"Toggle theme",children:p==="dark"?c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})}),c.jsxs("div",{className:"flex items-center gap-4 relative",ref:u,children:[c.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>l(!o),children:[c.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 dark:bg-indigo-900 flex items-center justify-center text-indigo-600 dark:text-indigo-200 font-medium",children:"AD"}),c.jsx(Q2,{size:16,className:"text-gray-500"})]}),o&&c.jsxs("div",{className:"absolute right-0 top-12 w-48 bg-white rounded-md shadow-lg py-1 z-50 dark:bg-gray-800",children:[c.jsxs("div",{className:"px-4 py-2 text-sm text-gray-700 border-b dark:text-gray-300",children:[c.jsx("p",{className:"font-medium",children:"Admin User"}),c.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"admin@school.edu"})]}),c.jsxs("button",{onClick:m,className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",children:[c.jsx(tv,{size:16,className:"mr-2"}),"Sign out"]})]})]})]})]}),c.jsx("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 dark:bg-gray-900",children:e})]}),a&&c.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>s(!1)})]})}const Vu=async e=>{try{return(await Pe.get(`/configs/${e}`)).data}catch(t){throw console.error("Error fetching class config:",t),t}},Uu=async e=>{try{const r=(await Pe.get("/configs")).data?.items||[],a={};return e.forEach(s=>{const n=r.find(i=>i&&i.class===s);n?a[s]={configured:!0,...n,exams:n.terms||[],subjects:n.subjects||[],openDays:n.openDays||0}:a[s]={configured:!1,exams:[],subjects:[],openDays:0}}),a}catch(t){throw console.error("Error fetching classes config status:",t),t}};function Hu({onSelect:e,selected:t,key:r}){const a=t||"",[s,n]=L.useState({}),[i,o]=L.useState(!1);return L.useEffect(()=>{let l=!0;return(async()=>{o(!0);try{const f=await Uu(la),d={};la.forEach(h=>{const p=f[h]||{};d[h]={isConfigured:p.configured||!1,subjectCount:p.subjects?.length||0,termCount:p.terms?.length||0,...p}}),l&&n(d)}catch(f){console.error("Error fetching class config status:",f),l&&n({})}finally{l&&o(!1)}})(),()=>{l=!1}},[]),c.jsx("div",{className:"sticky bg-white dark:bg-gray-800 rounded-lg shadow-sm w-full p-4 border border-gray-200 dark:border-gray-700",children:c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[c.jsxs("div",{className:"flex gap-10 items-center",children:[c.jsx("h2",{className:"text-base font-semibold text-gray-800 dark:text-gray-200",children:"Class Selection"}),c.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 ",children:t?`Selected: ${t}`:"Choose a class to view students"})]}),c.jsx("div",{className:"flex flex-wrap gap-2 gap-y-5",children:la.map((l,u)=>c.jsxs("button",{onClick:()=>{l!==a&&e&&e(l)},className:`px-4 py-2 text-sm font-medium rounded-md transition-all duration-200 flex items-center ${a===l?"bg-indigo-600 text-white shadow-md hover:bg-indigo-700":s?.[l]?.configured===!1?"bg-yellow-100 hover:bg-yellow-200 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200 dark:hover:bg-yellow-800/60 border border-yellow-300 dark:border-yellow-700":"bg-gray-100 hover:bg-gray-200 text-gray-800 dark:bg-gray-700 dark:hover:bg-gray-600 dark:text-gray-200"}`,"aria-pressed":t===l,children:[l,!i&&s?.[l]?.configured===!1&&c.jsx("span",{className:"ml-2 w-2 h-2 rounded-full bg-yellow-500 animate-pulse flex-shrink-0",title:"Configuration required - Click to configure this class"})]},u))})]})})}async function fa(e,t=null,r={}){const a={class:e,exam:t,_ts:Date.now(),...r};console.debug("[students] GET /students params ->",a);const s=await Pe.get("/students",{params:a}),n=s?.data;if(Array.isArray(n))return console.debug("[students] response status",s.status,"count",n.length),n;let i=[];return Array.isArray(n?.students)?i=n.students:Array.isArray(n?.data)?i=n.data:Array.isArray(n?.results)&&(i=n.results),console.debug("[students] response status",s.status,"count",i.length),i}async function lv(e,t){return(await Pe.put(`/students/${e}`,t)).data}async function fv(e){return e instanceof FormData?(await Pe.post("/students",e,{headers:{"Content-Type":"multipart/form-data"}})).data:(await Pe.post("/students",e)).data}async function uv(e,t={}){if(e instanceof File){const a=new FormData;return a.append("file",e),Object.entries(t||{}).forEach(([n,i])=>a.append(n,i)),(await Pe.post("/students/bulk",a,{headers:{"Content-Type":"multipart/form-data"}})).data}const r=await Pe.post("/students/bulkupdatestudents",{students:e,...t});return console.log("formbyapi",e),r.data}async function dv(e=[],t={}){const r=new FormData;return(e||[]).forEach(s=>{s&&r.append("files",s)}),Object.entries(t||{}).forEach(([s,n])=>r.append(s,n)),(await Pe.post("/students/photos/batch",r,{headers:{"Content-Type":"multipart/form-data"}})).data}async function Rc(e,t,r){try{return(await Pe.post("/students/bulkupdatemarks",{cls:e,exam:t,marksdata:r})).data}catch(a){throw console.error("Error in bulkUpdateMarks:",a),a}}function hv({isOpen:e,onClose:t,onSubmit:r,cls:a}){const[s,n]=fr.useState({studentName:"",rollNumber:"",class:a,fatherName:"",contactNumber:"",address:"",dob:"",photo:null}),i=L.useRef(null),o=d=>{const{name:h,value:p,files:x}=d.target;n(h==="photo"?m=>({...m,[h]:x[0]}):m=>({...m,[h]:p}))},l=d=>{d.preventDefault();const h=new FormData,p={...s};if(s.dob)try{const x=new Date(s.dob);isNaN(x.getTime())||(p.dob=Ks(x,"MM/dd/yyyy"))}catch(x){console.error("Error formatting date:",x)}Object.entries(p).forEach(([x,m])=>{x!=="photo"&&m!==null&&h.append(x,m)}),s.photo&&h.append("photo",s.photo),r(h)},u={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.15}}},f={hidden:{opacity:0,y:20,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",damping:25,stiffness:500}},exit:{opacity:0,y:20,transition:{duration:.2}}};return c.jsx(mr,{children:e&&c.jsx(c.Fragment,{children:c.jsxs(ke.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",initial:"hidden",animate:"visible",exit:"exit",children:[c.jsx(ke.div,{className:"fixed inset-0 bg-black/30 backdrop-blur-sm",onClick:t,variants:u}),c.jsx(ke.div,{className:"relative z-10 w-full max-w-2xl bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden",variants:f,onClick:d=>d.stopPropagation(),children:c.jsxs("div",{className:"p-6 max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 px-6 py-4 -mx-6 -mt-6 mb-6 rounded-t-xl",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"Add New Student"}),c.jsx("p",{className:"mt-1 text-sm text-blue-100",children:"Fill in the student details below"})]}),c.jsx(ke.button,{type:"button",onClick:t,className:"text-blue-100 hover:text-white transition-colors",whileHover:{scale:1.1},whileTap:{scale:.95},"aria-label":"Close",children:c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),c.jsxs("form",{onSubmit:l,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student Name *"}),c.jsx("input",{type:"text",name:"studentName",value:s.studentName,onChange:o,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Roll Number *"}),c.jsx("input",{type:"number",name:"rollNumber",value:s.rollNumber,onChange:o,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Class *"}),c.jsx("input",{type:"text",name:"class",value:s.class,readOnly:!0,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm cursor-not-allowed"})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Father's Name *"}),c.jsx("input",{type:"text",name:"fatherName",value:s.fatherName,onChange:o,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Contact Number *"}),c.jsx("input",{type:"tel",name:"contactNumber",value:s.contactNumber,onChange:o,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date of Birth *"}),c.jsx("input",{type:"date",name:"dob",value:s.dob||"",max:Ks(new Date,"yyyy-MM-dd"),onChange:o,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Address *"}),c.jsx("textarea",{name:"address",value:s.address,onChange:o,rows:2,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student Photo"}),c.jsxs("div",{className:"mt-1 flex items-center",children:[c.jsx("span",{className:"inline-block h-12 w-12 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-700",children:s.photo?c.jsx("img",{src:URL.createObjectURL(s.photo),alt:"Student preview",className:"h-full w-full object-cover"}):c.jsx("svg",{className:"h-full w-full text-gray-300 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.936 0 9.29 2.54 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})}),c.jsx("button",{type:"button",onClick:()=>i.current?.click(),className:"ml-5 bg-white dark:bg-gray-700 py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:s.photo?"Change":"Upload"}),c.jsx("input",{type:"file",ref:i,name:"photo",accept:"image/*",onChange:o,className:"hidden"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 bg-gray-100 dark:bg-gray-700 rounded-md hover:bg-gray-200 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Add Student"})]})]})]})})]})})})}const xv=({isOpen:e,onClose:t,student:r,onSave:a})=>{const[s,n]=L.useState({studentName:"",roll:"",class:"",fatherName:"",contactNumber:"",address:"",dob:"",photo:null,photoPreview:""}),i=L.useRef(null);L.useEffect(()=>{if(r){console.log("Student data:",JSON.stringify(r,null,2)),console.log("Date of birth type:",typeof r.dob,"value:",r.dob);let d="";if(r.dob)try{let h;if(typeof r.dob=="string"){if(r.dob.includes("/")){const[p,x,m]=r.dob.split("/").map(Number);!isNaN(p)&&!isNaN(x)&&!isNaN(m)&&(h=new Date(m,p-1,x))}if((!h||isNaN(h.getTime()))&&(h=Kh(r.dob)),isNaN(h.getTime())&&r.dob.includes("-")){const[p,x,m]=r.dob.split("-").map(Number);!isNaN(p)&&!isNaN(x)&&!isNaN(m)&&(h=new Date(m,x-1,p))}}else r.dob instanceof Date?h=r.dob:r.dob?.$date?h=new Date(r.dob.$date):h=new Date(r.dob);h&&!isNaN(h.getTime())?(d=Ks(h,"yyyy-MM-dd"),console.log("Formatted date:",d,"from:",r.dob)):console.warn("Invalid date value:",r.dob)}catch(h){console.error("Error parsing date:",h,"Value:",r.dob)}n({studentName:r.studentName||"",roll:r.roll||"",class:r.class||"",fatherName:r.fatherName||"",contactNumber:r.contactNumber||r.mobileNumber||"",address:r.address||"",dob:d,photo:null,photoPreview:r.photoUrl||r.photo||""})}},[r]);const o=d=>{const{name:h,value:p,files:x}=d.target;if(h==="photo"&&x&&x[0]){const m=new FileReader;m.onloadend=()=>{n(g=>({...g,photo:x[0],photoPreview:m.result}))},m.readAsDataURL(x[0])}else n(m=>({...m,[h]:p}))},l=d=>{d.preventDefault();const h=new FormData;Object.keys(s).forEach(p=>{p!=="photoPreview"&&h.append(p,s[p])}),a(r._id,h)},u={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.15}}},f={hidden:{opacity:0,y:20,scale:.98},visible:{opacity:1,y:0,scale:1,transition:{type:"spring",damping:25,stiffness:500}},exit:{opacity:0,y:20,transition:{duration:.2}}};return c.jsx(mr,{children:e&&c.jsx(c.Fragment,{children:c.jsxs(ke.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",initial:"hidden",animate:"visible",exit:"exit",children:[c.jsx(ke.div,{className:"fixed inset-0 bg-black/30 backdrop-blur-sm",onClick:t,variants:u,"aria-hidden":"true"}),c.jsx(ke.div,{className:"relative z-10 w-full max-w-2xl bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden",variants:f,onClick:d=>d.stopPropagation(),children:c.jsxs("div",{className:"p-6 max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-700 px-6 py-4 -mx-6 -mt-6 mb-6 rounded-t-xl",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-white",children:"Edit Student"}),c.jsx("p",{className:"mt-1 text-sm text-purple-100",children:"Update student information"})]}),c.jsxs(ke.button,{type:"button",onClick:t,className:"text-purple-100 hover:text-white transition-colors",whileHover:{scale:1.1},whileTap:{scale:.95},children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})]})}),c.jsxs("form",{onSubmit:l,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student Photo"}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"h-20 w-20 rounded-full overflow-hidden bg-gray-100 dark:bg-gray-700",children:s.photoPreview||s.photo?c.jsx("img",{src:s.photoPreview||URL.createObjectURL(s.photo),alt:"Student preview",className:"h-full w-full object-cover"}):c.jsx("svg",{className:"h-full w-full text-gray-300 dark:text-gray-500",fill:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.936 0 9.29 2.54 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})})}),c.jsx("button",{type:"button",onClick:()=>i.current?.click(),className:"ml-4 bg-white dark:bg-gray-700 py-2 px-3 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:s.photoPreview||s.photo?"Change":"Upload"}),c.jsx("input",{type:"file",ref:i,name:"photo",accept:"image/*",onChange:o,className:"hidden"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Student Name *"}),c.jsx("input",{type:"text",name:"studentName",value:s.studentName,onChange:o,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Roll Number *"}),c.jsx("input",{type:"number",name:"roll",value:s.roll,onChange:o,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Class *"}),c.jsx("input",{type:"text",name:"class",value:s.class,readOnly:!0,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm cursor-not-allowed",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Father's Name *"}),c.jsx("input",{type:"text",name:"fatherName",value:s.fatherName,onChange:o,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Contact Number *"}),c.jsx("input",{type:"tel",name:"contactNumber",value:s.contactNumber,onChange:o,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Date of Birth *"}),c.jsx("input",{type:"date",name:"dob",value:s.dob||"",max:Ks(new Date,"yyyy-MM-dd"),onChange:o,className:"w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Address *"}),c.jsx("textarea",{name:"address",rows:"3",value:s.address,onChange:o,className:"mt-1 block w-full rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]})]}),c.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white dark:hover:bg-gray-600",children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Save Changes"})]})]})]})})]})})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Wu=1252,mv=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_o={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},So=function(e){mv.indexOf(e)!=-1&&(Wu=_o[0]=e)};function pv(){So(1252)}var Gt=function(e){So(e)};function zu(){Gt(1200),pv()}function Mc(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function gv(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function Gu(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Da=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?gv(e.slice(2)):t==254&&r==255?Gu(e.slice(2)):t==65279?e.slice(1):e},Rs=function(t){return String.fromCharCode(t)},Oc=function(t){return String.fromCharCode(t)},os,Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ic(e){for(var t="",r=0,a=0,s=0,n=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),n=r>>2,a=e.charCodeAt(u++),i=(r&3)<<4|a>>4,s=e.charCodeAt(u++),o=(a&15)<<2|s>>6,l=s&63,isNaN(a)?o=l=64:isNaN(s)&&(l=64),t+=Er.charAt(n)+Er.charAt(i)+Er.charAt(o)+Er.charAt(l);return t}function Nt(e){var t="",r=0,a=0,s=0,n=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)n=Er.indexOf(e.charAt(u++)),i=Er.indexOf(e.charAt(u++)),r=n<<2|i>>4,t+=String.fromCharCode(r),o=Er.indexOf(e.charAt(u++)),a=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(a)),l=Er.indexOf(e.charAt(u++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var Te=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Xr=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Cr(e){return Te?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Lc(e){return Te?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var zt=function(t){return Te?Xr(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Yr(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Ao(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ao(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Tr=Te?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Xr(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(n){return Array.isArray(n)?n:[].slice.call(n)}))};function vv(e){for(var t=[],r=0,a=e.length+250,s=Cr(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++n)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>a&&(t.push(s.slice(0,r)),r=0,s=Cr(65535),a=65530)}return t.push(s.slice(0,r)),Tr(t)}var wt=/\u0000/g,Ra=/[\u0001-\u0006]/g;function ua(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $t(e,t){var r=""+e;return r.length>=t?r:Le("0",t-r.length)+r}function No(e,t){var r=""+e;return r.length>=t?r:Le(" ",t-r.length)+r}function rn(e,t){var r=""+e;return r.length>=t?r:r+Le(" ",t-r.length)}function yv(e,t){var r=""+Math.round(e);return r.length>=t?r:Le("0",t-r.length)+r}function wv(e,t){var r=""+e;return r.length>=t?r:Le("0",t-r.length)+r}var Bc=Math.pow(2,32);function ea(e,t){if(e>Bc||e<-Bc)return yv(e,t);var r=Math.round(e);return wv(r,t)}function an(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Vc=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function kv(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var ve={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Uc={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bv={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function sn(e,t,r){for(var a=e<0?-1:1,s=e*a,n=0,i=1,o=0,l=1,u=0,f=0,d=Math.floor(s);u<t&&(d=Math.floor(s),o=d*i+n,f=d*u+l,!(s-d<5e-8));)s=1/(s-d),n=i,i=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=n):(f=u,o=i)),!r)return[0,a*o,f];var h=Math.floor(a*o/f);return[h,a*o-h*f,f]}function Vr(e,t,r){if(e>2958465||e<0)return null;var a=e|0,s=Math.floor(86400*(e-a)),n=0,i=[],o={D:a,T:s,u:86400*(e-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(a+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++a,++o.D)),a===60)i=r?[1317,10,29]:[1900,2,29],n=3;else if(a===0)i=r?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var l=new Date(1900,0,1);l.setDate(l.getDate()+a-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],n=l.getDay(),a<60&&(n=(n+6)%7),r&&(n=Nv(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=n,o}var $u=new Date(1899,11,31,0,0,0),Tv=$u.getTime(),Ev=new Date(1900,2,1,0,0,0);function Ku(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Ev&&(r+=1440*60*1e3),(r-(Tv+(e.getTimezoneOffset()-$u.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Co(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _v(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Sv(e){var t=e<0?12:11,r=Co(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Av(e){var t=Co(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cs(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Sv(e):t===10?r=e.toFixed(10).substr(0,12):r=Av(e),Co(_v(r.toUpperCase()))}function Gr(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cs(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Lt(14,Ku(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Nv(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Cv(e,t,r,a){var s="",n=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return Xn[r.m-1][1];case 5:return Xn[r.m-1][0];default:return Xn[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return Vc[r.q][0];default:return Vc[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?$t(r.S,t.length):(a>=2?i=a===3?1e3:100:i=a===1?10:1,n=Math.round(i*(r.S+r.u)),n>=60*i&&(n=0),t==="s"?n===0?"0":""+n/i:(s=$t(n,2+a),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?$t(l,u):"";return f}function _r(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var Xu=/%/g;function Fv(e,t,r){var a=t.replace(Xu,""),s=t.length-a.length;return ur(e,a,r*Math.pow(10,2*s))+Le("%",s)}function jv(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ur(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Yu(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+Yu(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(s+n)%s)+"."+f.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var qu=/# (\?+)( ?)\/( ?)(\d+)/;function Pv(e,t,r){var a=parseInt(e[4],10),s=Math.round(t*a),n=Math.floor(s/a),i=s-n*a,o=a;return r+(n===0?"":""+n)+" "+(i===0?Le(" ",e[1].length+1+e[4].length):No(i,e[1].length)+e[2]+"/"+e[3]+$t(o,e[4].length))}function Dv(e,t,r){return r+(t===0?"":""+t)+Le(" ",e[1].length+2+e[4].length)}var Qu=/^#*0*\.([0#]+)/,Ju=/\).*[0#]/,Zu=/\(###\) ###\\?-####/;function mt(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Hc(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Wc(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function Rv(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Mv(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Rt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Ju)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Rt("n",a,r):"("+Rt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return jv(e,t,r);if(t.indexOf("%")!==-1)return Fv(e,t,r);if(t.indexOf("E")!==-1)return Yu(t,r);if(t.charCodeAt(0)===36)return"$"+Rt(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ea(l,t.length);if(t.match(/^[#?]+$/))return s=ea(r,0),s==="0"&&(s=""),s.length>t.length?s:mt(t.substr(0,t.length-s.length))+s;if(n=t.match(qu))return Pv(n,l,u);if(t.match(/^#+0+$/))return u+ea(l,t.length-t.indexOf("0"));if(n=t.match(Qu))return s=Hc(r,n[1].length).replace(/^([^\.]+)$/,"$1."+mt(n[1])).replace(/\.$/,"."+mt(n[1])).replace(/\.(\d*)$/,function(x,m){return"."+m+Le("0",mt(n[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return u+Hc(l,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return u+_r(ea(l,0));if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Rt(e,t,-r):_r(""+(Math.floor(r)+Rv(r,n[1].length)))+"."+$t(Wc(r,n[1].length),n[1].length);if(n=t.match(/^#,#*,#0/))return Rt(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ua(Rt(e,t.replace(/[\\-]/g,""),r)),i=0,ua(ua(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(Zu))return s=Rt(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),o=sn(l,Math.pow(10,i)-1,!1),s=""+u,f=ur("n",n[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+n[2]+"/"+n[3],f=rn(o[2],i),f.length<n[4].length&&(f=mt(n[4].substr(n[4].length-f.length))+f),s+=f,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),o=sn(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?No(o[1],i)+n[2]+"/"+n[3]+rn(o[2],i):Le(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=ea(r,0),t.length<=s.length?s:mt(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,h=t.length-s.length-d;return mt(t.substr(0,d)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return i=Wc(r,n[1].length),r<0?"-"+Rt(e,t,-r):_r(Mv(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?$t(0,3-x.length):"")+x})+"."+$t(i,n[1].length);switch(t){case"###,##0.00":return Rt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=_r(ea(l,0));return p!=="0"?u+p:"";case"###,###.00":return Rt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Rt(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Ov(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return ur(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function Iv(e,t,r){var a=t.replace(Xu,""),s=t.length-a.length;return ur(e,a,r*Math.pow(10,2*s))+Le("%",s)}function ed(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+ed(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var n=Math.floor(Math.log(t)*Math.LOG10E)%s;if(n<0&&(n+=s),r=(t/Math.pow(10,n)).toPrecision(a+1+(s+n)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+n):r+="E+"+(i-n),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(s+n)%s)+"."+f.substr(n)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Jt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(Ju)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Jt("n",a,r):"("+Jt("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ov(e,t,r);if(t.indexOf("%")!==-1)return Iv(e,t,r);if(t.indexOf("E")!==-1)return ed(t,r);if(t.charCodeAt(0)===36)return"$"+Jt(e,t.substr(t.charAt(1)==" "?2:1),r);var s,n,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+$t(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:mt(t.substr(0,t.length-s.length))+s;if(n=t.match(qu))return Dv(n,l,u);if(t.match(/^#+0+$/))return u+$t(l,t.length-t.indexOf("0"));if(n=t.match(Qu))return s=(""+r).replace(/^([^\.]+)$/,"$1."+mt(n[1])).replace(/\.$/,"."+mt(n[1])),s=s.replace(/\.(\d*)$/,function(x,m){return"."+m+Le("0",mt(n[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),n=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=t.match(/^#{1,3},##0(\.?)$/))return u+_r(""+l);if(n=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Jt(e,t,-r):_r(""+r)+"."+Le("0",n[1].length);if(n=t.match(/^#,#*,#0/))return Jt(e,t.replace(/^#,#*,/,""),r);if(n=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=ua(Jt(e,t.replace(/[\\-]/g,""),r)),i=0,ua(ua(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(Zu))return s=Jt(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(n=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),o=sn(l,Math.pow(10,i)-1,!1),s=""+u,f=ur("n",n[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+n[2]+"/"+n[3],f=rn(o[2],i),f.length<n[4].length&&(f=mt(n[4].substr(n[4].length-f.length))+f),s+=f,s;if(n=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),o=sn(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?No(o[1],i)+n[2]+"/"+n[3]+rn(o[2],i):Le(" ",2*i+1+n[2].length+n[3].length));if(n=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:mt(t.substr(0,t.length-s.length))+s;if(n=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,h=t.length-s.length-d;return mt(t.substr(0,d)+s+t.substr(t.length-h))}if(n=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Jt(e,t,-r):_r(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?$t(0,3-x.length):"")+x})+"."+$t(0,n[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=_r(""+l);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Jt(e,t.slice(0,t.lastIndexOf(".")),r)+mt(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ur(e,t,r){return(r|0)===r?Jt(e,t,r):Rt(e,t,r)}function Lv(e){for(var t=[],r=!1,a=0,s=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(s,a-s),s=a+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var td=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ka(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":an(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(td))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Bv(e,t,r,a){for(var s=[],n="",i=0,o="",l="t",u,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!an(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(n="";(d=e.charCodeAt(++i))!==34&&i<e.length;)n+=String.fromCharCode(d);s[s.length]={t:"t",v:n},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Vr(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Vr(t,r),u==null))return"";for(n=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)n+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:n},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=Vr(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",i+=5,h="h"):(m.t="t",++i),u==null&&m.t==="T")return"";s[s.length]=m,l=o;break;case"[":for(n=o;e.charAt(i++)!=="]"&&i<e.length;)n+=e.charAt(i);if(n.slice(-1)!=="]")throw'unterminated "[" block: |'+n+"|";if(n.match(td)){if(u==null&&(u=Vr(t,r),u==null))return"";s[s.length]={t:"Z",v:n.toLowerCase()},l=n.charAt(1)}else n.indexOf("$")>-1&&(n=(n.match(/\$([^-\[\]]*)/)||[])[1]||"$",ka(e)||(s[s.length]={t:"t",v:n}));break;case".":if(u!=null){for(n=o;++i<e.length&&(o=e.charAt(i))==="0";)n+=o;s[s.length]={t:"s",v:n};break}case"0":case"#":for(n=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)n+=o;s[s.length]={t:"n",v:n};break;case"?":for(n=o;e.charAt(++i)===o;)n+=o;s[s.length]={t:o,v:n},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:a===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(n=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)n+=e.charAt(i);s[s.length]={t:"D",v:n};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var g=0,y=0,T;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,l="h",g<1&&(g=1);break;case"s":(T=s[i].v.match(/\.0+$/))&&(y=Math.max(y,T[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[i].v.match(/[Hh]/)&&(g=1),g<2&&s[i].v.match(/[Mm]/)&&(g=2),g<3&&s[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",R;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Cv(s[i].t.charCodeAt(0),s[i].v,u,y),s[i].t="t";break;case"n":case"?":for(R=i+1;s[R]!=null&&((o=s[R].t)==="?"||o==="D"||(o===" "||o==="t")&&s[R+1]!=null&&(s[R+1].t==="?"||s[R+1].t==="t"&&s[R+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[R].v==="/"||s[R].v===" "&&s[R+1]!=null&&s[R+1].t=="?"));)s[i].v+=s[R].v,s[R]={v:"",t:";"},++R;v+=s[i].v,i=R-1;break;case"G":s[i].t="t",s[i].v=Gr(t,r);break}var D="",b,k;if(v.length>0){v.charCodeAt(0)==40?(b=t<0&&v.charCodeAt(0)===45?-t:t,k=ur("n",v,b)):(b=t<0&&a>1?-t:t,k=ur("n",v,b),b<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),R=k.length-1;var S=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){S=i;break}var P=s.length;if(S===s.length&&k.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(R>=s[i].v.length-1?(R-=s[i].v.length,s[i].v=k.substr(R+1,s[i].v.length)):R<0?s[i].v="":(s[i].v=k.substr(0,R+1),R=-1),s[i].t="t",P=i);R>=0&&P<s.length&&(s[P].v=k.substr(0,R+1)+s[P].v)}else if(S!==s.length&&k.indexOf("E")===-1){for(R=k.indexOf(".")-1,i=S;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")-1:s[i].v.length-1,D=s[i].v.substr(f+1);f>=0;--f)R>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(D=k.charAt(R--)+D);s[i].v=D,s[i].t="t",P=i}for(R>=0&&P<s.length&&(s[P].v=k.substr(0,R+1)+s[P].v),R=k.indexOf(".")+1,i=S;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==S)){for(f=s[i].v.indexOf(".")>-1&&i===S?s[i].v.indexOf(".")+1:0,D=s[i].v.substr(0,f);f<s[i].v.length;++f)R<k.length&&(D+=k.charAt(R++));s[i].v=D,s[i].t="t",P=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(b=a>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=ur(s[i].t,s[i].v,b),s[i].t="t");var H="";for(i=0;i!==s.length;++i)s[i]!=null&&(H+=s[i].v);return H}var zc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gc(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Vv(e,t){var r=Lv(e),a=r.length,s=r[a-1].indexOf("@");if(a<4&&s>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var n=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,n];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(zc),o=r[1].match(zc);return Gc(t,i)?[a,r[0]]:Gc(t,o)?[a,r[1]]:[a,r[i!=null&&o!=null?2:1]]}return[a,n]}function Lt(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:ve)[e],a==null&&(a=r.table&&r.table[Uc[e]]||ve[Uc[e]]),a==null&&(a=bv[e]||"General");break}if(an(a,0))return Gr(t,r);t instanceof Date&&(t=Ku(t,r.date1904));var s=Vv(a,t);if(an(s[1]))return Gr(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Bv(s[1],t,r,s[0])}function Wr(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(ve[r]==null){t<0&&(t=r);continue}if(ve[r]==e){t=r;break}}t<0&&(t=391)}return ve[t]=e,t}function rd(){ve=kv()}var Uv={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},ad=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hv(e){var t=typeof e=="number"?ve[e]:e;return t=t.replace(ad,"(\\d+)"),new RegExp("^"+t+"$")}function Wv(e,t,r){var a=-1,s=-1,n=-1,i=-1,o=-1,l=-1;(t.match(ad)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":a=p;break;case"d":n=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:a==-1&&s==-1&&n==-1?f:u+"T"+f}var zv=(function(){var e={};e.version="1.2.0";function t(){for(var k=0,S=new Array(256),P=0;P!=256;++P)k=P,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,S[P]=k;return typeof Int32Array<"u"?new Int32Array(S):S}var r=t();function a(k){var S=0,P=0,H=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)O[H]=k[H];for(H=0;H!=256;++H)for(P=k[H],S=256+H;S<4096;S+=256)P=O[S]=P>>>8^k[P&255];var C=[];for(H=1;H!=16;++H)C[H-1]=typeof Int32Array<"u"?O.subarray(H*256,H*256+256):O.slice(H*256,H*256+256);return C}var s=a(r),n=s[0],i=s[1],o=s[2],l=s[3],u=s[4],f=s[5],d=s[6],h=s[7],p=s[8],x=s[9],m=s[10],g=s[11],y=s[12],T=s[13],v=s[14];function R(k,S){for(var P=S^-1,H=0,O=k.length;H<O;)P=P>>>8^r[(P^k.charCodeAt(H++))&255];return~P}function D(k,S){for(var P=S^-1,H=k.length-15,O=0;O<H;)P=v[k[O++]^P&255]^T[k[O++]^P>>8&255]^y[k[O++]^P>>16&255]^g[k[O++]^P>>>24]^m[k[O++]]^x[k[O++]]^p[k[O++]]^h[k[O++]]^d[k[O++]]^f[k[O++]]^u[k[O++]]^l[k[O++]]^o[k[O++]]^i[k[O++]]^n[k[O++]]^r[k[O++]];for(H+=15;O<H;)P=P>>>8^r[(P^k[O++])&255];return~P}function b(k,S){for(var P=S^-1,H=0,O=k.length,C=0,W=0;H<O;)C=k.charCodeAt(H++),C<128?P=P>>>8^r[(P^C)&255]:C<2048?(P=P>>>8^r[(P^(192|C>>6&31))&255],P=P>>>8^r[(P^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,W=k.charCodeAt(H++)&1023,P=P>>>8^r[(P^(240|C>>8&7))&255],P=P>>>8^r[(P^(128|C>>2&63))&255],P=P>>>8^r[(P^(128|W>>6&15|(C&3)<<4))&255],P=P>>>8^r[(P^(128|W&63))&255]):(P=P>>>8^r[(P^(224|C>>12&15))&255],P=P>>>8^r[(P^(128|C>>6&63))&255],P=P>>>8^r[(P^(128|C&63))&255]);return~P}return e.table=r,e.bstr=R,e.buf=D,e.str=b,e})(),Ee=(function(){var t={};t.version="1.2.1";function r(w,A){for(var E=w.split("/"),_=A.split("/"),N=0,F=0,G=Math.min(E.length,_.length);N<G;++N){if(F=E[N].length-_[N].length)return F;if(E[N]!=_[N])return E[N]<_[N]?-1:1}return E.length-_.length}function a(w){if(w.charAt(w.length-1)=="/")return w.slice(0,-1).indexOf("/")===-1?w:a(w.slice(0,-1));var A=w.lastIndexOf("/");return A===-1?w:w.slice(0,A+1)}function s(w){if(w.charAt(w.length-1)=="/")return s(w.slice(0,-1));var A=w.lastIndexOf("/");return A===-1?w:w.slice(A+1)}function n(w,A){typeof A=="string"&&(A=new Date(A));var E=A.getHours();E=E<<6|A.getMinutes(),E=E<<5|A.getSeconds()>>>1,w.write_shift(2,E);var _=A.getFullYear()-1980;_=_<<4|A.getMonth()+1,_=_<<5|A.getDate(),w.write_shift(2,_)}function i(w){var A=w.read_shift(2)&65535,E=w.read_shift(2)&65535,_=new Date,N=E&31;E>>>=5;var F=E&15;E>>>=4,_.setMilliseconds(0),_.setFullYear(E+1980),_.setMonth(F-1),_.setDate(N);var G=A&31;A>>>=5;var Y=A&63;return A>>>=6,_.setHours(A),_.setMinutes(Y),_.setSeconds(G<<1),_}function o(w){rt(w,0);for(var A={},E=0;w.l<=w.length-4;){var _=w.read_shift(2),N=w.read_shift(2),F=w.l+N,G={};switch(_){case 21589:E=w.read_shift(1),E&1&&(G.mtime=w.read_shift(4)),N>5&&(E&2&&(G.atime=w.read_shift(4)),E&4&&(G.ctime=w.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}w.l=F,A[_]=G}return A}var l;function u(){return l||(l={})}function f(w,A){if(w[0]==80&&w[1]==75)return t0(w,A);if((w[0]|32)==109&&(w[1]|32)==105)return Dh(w,A);if(w.length<512)throw new Error("CFB file size "+w.length+" < 512");var E=3,_=512,N=0,F=0,G=0,Y=0,z=0,K=[],X=w.slice(0,512);rt(X,0);var ee=d(X);switch(E=ee[0],E){case 3:_=512;break;case 4:_=4096;break;case 0:if(ee[1]==0)return t0(w,A);default:throw new Error("Major Version: Expected 3 or 4 saw "+E)}_!==512&&(X=w.slice(0,_),rt(X,28));var ne=w.slice(0,_);h(X,E);var fe=X.read_shift(4,"i");if(E===3&&fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+fe);X.l+=4,G=X.read_shift(4,"i"),X.l+=4,X.chk("00100000","Mini Stream Cutoff Size: "),Y=X.read_shift(4,"i"),N=X.read_shift(4,"i"),z=X.read_shift(4,"i"),F=X.read_shift(4,"i");for(var re=-1,ce=0;ce<109&&(re=X.read_shift(4,"i"),!(re<0));++ce)K[ce]=re;var ge=p(w,_);g(z,F,ge,_,K);var Re=T(ge,G,K,_);Re[G].name="!Directory",N>0&&Y!==W&&(Re[Y].name="!MiniFAT"),Re[K[0]].name="!FAT",Re.fat_addrs=K,Re.ssz=_;var Me={},nt=[],Sa=[],Aa=[];v(G,Re,ge,nt,N,Me,Sa,Y),x(Sa,Aa,nt),nt.shift();var Na={FileIndex:Sa,FullPaths:Aa};return A&&A.raw&&(Na.raw={header:ne,sectors:ge}),Na}function d(w){if(w[w.l]==80&&w[w.l+1]==75)return[0,0];w.chk(q,"Header Signature: "),w.l+=16;var A=w.read_shift(2,"u");return[w.read_shift(2,"u"),A]}function h(w,A){var E=9;switch(w.l+=2,E=w.read_shift(2)){case 9:if(A!=3)throw new Error("Sector Shift: Expected 9 saw "+E);break;case 12:if(A!=4)throw new Error("Sector Shift: Expected 12 saw "+E);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+E)}w.chk("0600","Mini Sector Shift: "),w.chk("000000000000","Reserved: ")}function p(w,A){for(var E=Math.ceil(w.length/A)-1,_=[],N=1;N<E;++N)_[N-1]=w.slice(N*A,(N+1)*A);return _[E-1]=w.slice(E*A),_}function x(w,A,E){for(var _=0,N=0,F=0,G=0,Y=0,z=E.length,K=[],X=[];_<z;++_)K[_]=X[_]=_,A[_]=E[_];for(;Y<X.length;++Y)_=X[Y],N=w[_].L,F=w[_].R,G=w[_].C,K[_]===_&&(N!==-1&&K[N]!==N&&(K[_]=K[N]),F!==-1&&K[F]!==F&&(K[_]=K[F])),G!==-1&&(K[G]=_),N!==-1&&_!=K[_]&&(K[N]=K[_],X.lastIndexOf(N)<Y&&X.push(N)),F!==-1&&_!=K[_]&&(K[F]=K[_],X.lastIndexOf(F)<Y&&X.push(F));for(_=1;_<z;++_)K[_]===_&&(F!==-1&&K[F]!==F?K[_]=K[F]:N!==-1&&K[N]!==N&&(K[_]=K[N]));for(_=1;_<z;++_)if(w[_].type!==0){if(Y=_,Y!=K[Y])do Y=K[Y],A[_]=A[Y]+"/"+A[_];while(Y!==0&&K[Y]!==-1&&Y!=K[Y]);K[_]=-1}for(A[0]+="/",_=1;_<z;++_)w[_].type!==2&&(A[_]+="/")}function m(w,A,E){for(var _=w.start,N=w.size,F=[],G=_;E&&N>0&&G>=0;)F.push(A.slice(G*C,G*C+C)),N-=C,G=Ir(E,G*4);return F.length===0?qe(0):Tr(F).slice(0,w.size)}function g(w,A,E,_,N){var F=W;if(w===W){if(A!==0)throw new Error("DIFAT chain shorter than expected")}else if(w!==-1){var G=E[w],Y=(_>>>2)-1;if(!G)return;for(var z=0;z<Y&&(F=Ir(G,z*4))!==W;++z)N.push(F);g(Ir(G,_-4),A-1,E,_,N)}}function y(w,A,E,_,N){var F=[],G=[];N||(N=[]);var Y=_-1,z=0,K=0;for(z=A;z>=0;){N[z]=!0,F[F.length]=z,G.push(w[z]);var X=E[Math.floor(z*4/_)];if(K=z*4&Y,_<4+K)throw new Error("FAT boundary crossed: "+z+" 4 "+_);if(!w[X])break;z=Ir(w[X],K)}return{nodes:F,data:tl([G])}}function T(w,A,E,_){var N=w.length,F=[],G=[],Y=[],z=[],K=_-1,X=0,ee=0,ne=0,fe=0;for(X=0;X<N;++X)if(Y=[],ne=X+A,ne>=N&&(ne-=N),!G[ne]){z=[];var re=[];for(ee=ne;ee>=0;){re[ee]=!0,G[ee]=!0,Y[Y.length]=ee,z.push(w[ee]);var ce=E[Math.floor(ee*4/_)];if(fe=ee*4&K,_<4+fe)throw new Error("FAT boundary crossed: "+ee+" 4 "+_);if(!w[ce]||(ee=Ir(w[ce],fe),re[ee]))break}F[ne]={nodes:Y,data:tl([z])}}return F}function v(w,A,E,_,N,F,G,Y){for(var z=0,K=_.length?2:0,X=A[w].data,ee=0,ne=0,fe;ee<X.length;ee+=128){var re=X.slice(ee,ee+128);rt(re,64),ne=re.read_shift(2),fe=Ro(re,0,ne-K),_.push(fe);var ce={name:fe,type:re.read_shift(1),color:re.read_shift(1),L:re.read_shift(4,"i"),R:re.read_shift(4,"i"),C:re.read_shift(4,"i"),clsid:re.read_shift(16),state:re.read_shift(4,"i"),start:0,size:0},ge=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);ge!==0&&(ce.ct=R(re,re.l-8));var Re=re.read_shift(2)+re.read_shift(2)+re.read_shift(2)+re.read_shift(2);Re!==0&&(ce.mt=R(re,re.l-8)),ce.start=re.read_shift(4,"i"),ce.size=re.read_shift(4,"i"),ce.size<0&&ce.start<0&&(ce.size=ce.type=0,ce.start=W,ce.name=""),ce.type===5?(z=ce.start,N>0&&z!==W&&(A[z].name="!StreamData")):ce.size>=4096?(ce.storage="fat",A[ce.start]===void 0&&(A[ce.start]=y(E,ce.start,A.fat_addrs,A.ssz)),A[ce.start].name=ce.name,ce.content=A[ce.start].data.slice(0,ce.size)):(ce.storage="minifat",ce.size<0?ce.size=0:z!==W&&ce.start!==W&&A[z]&&(ce.content=m(ce,A[z].data,(A[Y]||{}).data))),ce.content&&rt(ce.content,0),F[fe]=ce,G.push(ce)}}function R(w,A){return new Date((St(w,A+4)/1e7*Math.pow(2,32)+St(w,A)/1e7-11644473600)*1e3)}function D(w,A){return u(),f(l.readFileSync(w),A)}function b(w,A){var E=A&&A.type;switch(E||Te&&Buffer.isBuffer(w)&&(E="buffer"),E||"base64"){case"file":return D(w,A);case"base64":return f(zt(Nt(w)),A);case"binary":return f(zt(w),A)}return f(w,A)}function k(w,A){var E=A||{},_=E.root||"Root Entry";if(w.FullPaths||(w.FullPaths=[]),w.FileIndex||(w.FileIndex=[]),w.FullPaths.length!==w.FileIndex.length)throw new Error("inconsistent CFB structure");w.FullPaths.length===0&&(w.FullPaths[0]=_+"/",w.FileIndex[0]={name:_,type:5}),E.CLSID&&(w.FileIndex[0].clsid=E.CLSID),S(w)}function S(w){var A="Sh33tJ5";if(!Ee.find(w,"/"+A)){var E=qe(4);E[0]=55,E[1]=E[3]=50,E[2]=54,w.FileIndex.push({name:A,type:2,content:E,size:4,L:69,R:69,C:69}),w.FullPaths.push(w.FullPaths[0]+A),P(w)}}function P(w,A){k(w);for(var E=!1,_=!1,N=w.FullPaths.length-1;N>=0;--N){var F=w.FileIndex[N];switch(F.type){case 0:_?E=!0:(w.FileIndex.pop(),w.FullPaths.pop());break;case 1:case 2:case 5:_=!0,isNaN(F.R*F.L*F.C)&&(E=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(E=!0);break;default:E=!0;break}}if(!(!E&&!A)){var G=new Date(1987,1,19),Y=0,z=Object.create?Object.create(null):{},K=[];for(N=0;N<w.FullPaths.length;++N)z[w.FullPaths[N]]=!0,w.FileIndex[N].type!==0&&K.push([w.FullPaths[N],w.FileIndex[N]]);for(N=0;N<K.length;++N){var X=a(K[N][0]);_=z[X],_||(K.push([X,{name:s(X).replace("/",""),type:1,clsid:ae,ct:G,mt:G,content:null}]),z[X]=!0)}for(K.sort(function(fe,re){return r(fe[0],re[0])}),w.FullPaths=[],w.FileIndex=[],N=0;N<K.length;++N)w.FullPaths[N]=K[N][0],w.FileIndex[N]=K[N][1];for(N=0;N<K.length;++N){var ee=w.FileIndex[N],ne=w.FullPaths[N];if(ee.name=s(ne).replace("/",""),ee.L=ee.R=ee.C=-(ee.color=1),ee.size=ee.content?ee.content.length:0,ee.start=0,ee.clsid=ee.clsid||ae,N===0)ee.C=K.length>1?1:-1,ee.size=0,ee.type=5;else if(ne.slice(-1)=="/"){for(Y=N+1;Y<K.length&&a(w.FullPaths[Y])!=ne;++Y);for(ee.C=Y>=K.length?-1:Y,Y=N+1;Y<K.length&&a(w.FullPaths[Y])!=a(ne);++Y);ee.R=Y>=K.length?-1:Y,ee.type=1}else a(w.FullPaths[N+1]||"")==a(ne)&&(ee.R=N+1),ee.type=2}}}function H(w,A){var E=A||{};if(E.fileType=="mad")return Rh(w,E);switch(P(w),E.fileType){case"zip":return Ah(w,E)}var _=(function(fe){for(var re=0,ce=0,ge=0;ge<fe.FileIndex.length;++ge){var Re=fe.FileIndex[ge];if(Re.content){var Me=Re.content.length;Me>0&&(Me<4096?re+=Me+63>>6:ce+=Me+511>>9)}}for(var nt=fe.FullPaths.length+3>>2,Sa=re+7>>3,Aa=re+127>>7,Na=Sa+ce+nt+Aa,Rr=Na+127>>7,Fn=Rr<=109?0:Math.ceil((Rr-109)/127);Na+Rr+Fn+127>>7>Rr;)Fn=++Rr<=109?0:Math.ceil((Rr-109)/127);var or=[1,Fn,Rr,Aa,nt,ce,re,0];return fe.FileIndex[0].size=re<<6,or[7]=(fe.FileIndex[0].start=or[0]+or[1]+or[2]+or[3]+or[4]+or[5])+(or[6]+7>>3),or})(w),N=qe(_[7]<<9),F=0,G=0;{for(F=0;F<8;++F)N.write_shift(1,Q[F]);for(F=0;F<8;++F)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),F=0;F<3;++F)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,_[2]),N.write_shift(4,_[0]+_[1]+_[2]+_[3]-1),N.write_shift(4,0),N.write_shift(4,4096),N.write_shift(4,_[3]?_[0]+_[1]+_[2]-1:W),N.write_shift(4,_[3]),N.write_shift(-4,_[1]?_[0]-1:W),N.write_shift(4,_[1]),F=0;F<109;++F)N.write_shift(-4,F<_[2]?_[1]+F:-1)}if(_[1])for(G=0;G<_[1];++G){for(;F<236+G*127;++F)N.write_shift(-4,F<_[2]?_[1]+F:-1);N.write_shift(-4,G===_[1]-1?W:G+1)}var Y=function(fe){for(G+=fe;F<G-1;++F)N.write_shift(-4,F+1);fe&&(++F,N.write_shift(-4,W))};for(G=F=0,G+=_[1];F<G;++F)N.write_shift(-4,Z.DIFSECT);for(G+=_[2];F<G;++F)N.write_shift(-4,Z.FATSECT);Y(_[3]),Y(_[4]);for(var z=0,K=0,X=w.FileIndex[0];z<w.FileIndex.length;++z)X=w.FileIndex[z],X.content&&(K=X.content.length,!(K<4096)&&(X.start=G,Y(K+511>>9)));for(Y(_[6]+7>>3);N.l&511;)N.write_shift(-4,Z.ENDOFCHAIN);for(G=F=0,z=0;z<w.FileIndex.length;++z)X=w.FileIndex[z],X.content&&(K=X.content.length,!(!K||K>=4096)&&(X.start=G,Y(K+63>>6)));for(;N.l&511;)N.write_shift(-4,Z.ENDOFCHAIN);for(F=0;F<_[4]<<2;++F){var ee=w.FullPaths[F];if(!ee||ee.length===0){for(z=0;z<17;++z)N.write_shift(4,0);for(z=0;z<3;++z)N.write_shift(4,-1);for(z=0;z<12;++z)N.write_shift(4,0);continue}X=w.FileIndex[F],F===0&&(X.start=X.size?X.start-1:W);var ne=F===0&&E.root||X.name;if(K=2*(ne.length+1),N.write_shift(64,ne,"utf16le"),N.write_shift(2,K),N.write_shift(1,X.type),N.write_shift(1,X.color),N.write_shift(-4,X.L),N.write_shift(-4,X.R),N.write_shift(-4,X.C),X.clsid)N.write_shift(16,X.clsid,"hex");else for(z=0;z<4;++z)N.write_shift(4,0);N.write_shift(4,X.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,X.start),N.write_shift(4,X.size),N.write_shift(4,0)}for(F=1;F<w.FileIndex.length;++F)if(X=w.FileIndex[F],X.size>=4096)if(N.l=X.start+1<<9,Te&&Buffer.isBuffer(X.content))X.content.copy(N,N.l,0,X.size),N.l+=X.size+511&-512;else{for(z=0;z<X.size;++z)N.write_shift(1,X.content[z]);for(;z&511;++z)N.write_shift(1,0)}for(F=1;F<w.FileIndex.length;++F)if(X=w.FileIndex[F],X.size>0&&X.size<4096)if(Te&&Buffer.isBuffer(X.content))X.content.copy(N,N.l,0,X.size),N.l+=X.size+63&-64;else{for(z=0;z<X.size;++z)N.write_shift(1,X.content[z]);for(;z&63;++z)N.write_shift(1,0)}if(Te)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function O(w,A){var E=w.FullPaths.map(function(z){return z.toUpperCase()}),_=E.map(function(z){var K=z.split("/");return K[K.length-(z.slice(-1)=="/"?2:1)]}),N=!1;A.charCodeAt(0)===47?(N=!0,A=E[0].slice(0,-1)+A):N=A.indexOf("/")!==-1;var F=A.toUpperCase(),G=N===!0?E.indexOf(F):_.indexOf(F);if(G!==-1)return w.FileIndex[G];var Y=!F.match(Ra);for(F=F.replace(wt,""),Y&&(F=F.replace(Ra,"!")),G=0;G<E.length;++G)if((Y?E[G].replace(Ra,"!"):E[G]).replace(wt,"")==F||(Y?_[G].replace(Ra,"!"):_[G]).replace(wt,"")==F)return w.FileIndex[G];return null}var C=64,W=-2,q="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",Z={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:W,FREESECT:-1,HEADER_SIGNATURE:q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function de(w,A,E){u();var _=H(w,E);l.writeFileSync(A,_)}function U(w){for(var A=new Array(w.length),E=0;E<w.length;++E)A[E]=String.fromCharCode(w[E]);return A.join("")}function ue(w,A){var E=H(w,A);switch(A&&A.type||"buffer"){case"file":return u(),l.writeFileSync(A.filename,E),E;case"binary":return typeof E=="string"?E:U(E);case"base64":return Ic(typeof E=="string"?E:U(E));case"buffer":if(Te)return Buffer.isBuffer(E)?E:Xr(E);case"array":return typeof E=="string"?zt(E):E}return E}var he;function j(w){try{var A=w.InflateRaw,E=new A;if(E._processChunk(new Uint8Array([3,0]),E._finishFlushFlag),E.bytesRead)he=w;else throw new Error("zlib does not expose bytesRead")}catch(_){console.error("cannot use native zlib: "+(_.message||_))}}function V(w,A){if(!he)return Zo(w,A);var E=he.InflateRaw,_=new E,N=_._processChunk(w.slice(w.l),_._finishFlushFlag);return w.l+=_.bytesRead,N}function I(w){return he?he.deflateRawSync(w):we(w)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function le(w){var A=(w<<1|w<<11)&139536|(w<<5|w<<15)&558144;return(A>>16|A>>8|A)&255}for(var se=typeof Uint8Array<"u",te=se?new Uint8Array(256):[],Se=0;Se<256;++Se)te[Se]=le(Se);function M(w,A){var E=te[w&255];return A<=8?E>>>8-A:(E=E<<8|te[w>>8&255],A<=16?E>>>16-A:(E=E<<8|te[w>>16&255],E>>>24-A))}function Ve(w,A){var E=A&7,_=A>>>3;return(w[_]|(E<=6?0:w[_+1]<<8))>>>E&3}function Ne(w,A){var E=A&7,_=A>>>3;return(w[_]|(E<=5?0:w[_+1]<<8))>>>E&7}function Ce(w,A){var E=A&7,_=A>>>3;return(w[_]|(E<=4?0:w[_+1]<<8))>>>E&15}function be(w,A){var E=A&7,_=A>>>3;return(w[_]|(E<=3?0:w[_+1]<<8))>>>E&31}function oe(w,A){var E=A&7,_=A>>>3;return(w[_]|(E<=1?0:w[_+1]<<8))>>>E&127}function Ue(w,A,E){var _=A&7,N=A>>>3,F=(1<<E)-1,G=w[N]>>>_;return E<8-_||(G|=w[N+1]<<8-_,E<16-_)||(G|=w[N+2]<<16-_,E<24-_)||(G|=w[N+3]<<24-_),G&F}function Ct(w,A,E){var _=A&7,N=A>>>3;return _<=5?w[N]|=(E&7)<<_:(w[N]|=E<<_&255,w[N+1]=(E&7)>>8-_),A+3}function Xt(w,A,E){var _=A&7,N=A>>>3;return E=(E&1)<<_,w[N]|=E,A+1}function nr(w,A,E){var _=A&7,N=A>>>3;return E<<=_,w[N]|=E&255,E>>>=8,w[N+1]=E,A+8}function Ea(w,A,E){var _=A&7,N=A>>>3;return E<<=_,w[N]|=E&255,E>>>=8,w[N+1]=E&255,w[N+2]=E>>>8,A+16}function yr(w,A){var E=w.length,_=2*E>A?2*E:A+5,N=0;if(E>=A)return w;if(Te){var F=Lc(_);if(w.copy)w.copy(F);else for(;N<w.length;++N)F[N]=w[N];return F}else if(se){var G=new Uint8Array(_);if(G.set)G.set(w);else for(;N<E;++N)G[N]=w[N];return G}return w.length=_,w}function Et(w){for(var A=new Array(w),E=0;E<w;++E)A[E]=0;return A}function ir(w,A,E){var _=1,N=0,F=0,G=0,Y=0,z=w.length,K=se?new Uint16Array(32):Et(32);for(F=0;F<32;++F)K[F]=0;for(F=z;F<E;++F)w[F]=0;z=w.length;var X=se?new Uint16Array(z):Et(z);for(F=0;F<z;++F)K[N=w[F]]++,_<N&&(_=N),X[F]=0;for(K[0]=0,F=1;F<=_;++F)K[F+16]=Y=Y+K[F-1]<<1;for(F=0;F<z;++F)Y=w[F],Y!=0&&(X[F]=K[Y+16]++);var ee=0;for(F=0;F<z;++F)if(ee=w[F],ee!=0)for(Y=M(X[F],_)>>_-ee,G=(1<<_+4-ee)-1;G>=0;--G)A[Y|G<<ee]=ee&15|F<<4;return _}var wr=se?new Uint16Array(512):Et(512),_a=se?new Uint16Array(32):Et(32);if(!se){for(var xt=0;xt<512;++xt)wr[xt]=0;for(xt=0;xt<32;++xt)_a[xt]=0}(function(){for(var w=[],A=0;A<32;A++)w.push(5);ir(w,_a,32);var E=[];for(A=0;A<=143;A++)E.push(8);for(;A<=255;A++)E.push(9);for(;A<=279;A++)E.push(7);for(;A<=287;A++)E.push(8);ir(E,wr,288)})();var Yt=(function(){for(var A=se?new Uint8Array(32768):[],E=0,_=0;E<ie.length-1;++E)for(;_<ie[E+1];++_)A[_]=E;for(;_<32768;++_)A[_]=29;var N=se?new Uint8Array(259):[];for(E=0,_=0;E<J.length-1;++E)for(;_<J[E+1];++_)N[_]=E;function F(Y,z){for(var K=0;K<Y.length;){var X=Math.min(65535,Y.length-K),ee=K+X==Y.length;for(z.write_shift(1,+ee),z.write_shift(2,X),z.write_shift(2,~X&65535);X-- >0;)z[z.l++]=Y[K++]}return z.l}function G(Y,z){for(var K=0,X=0,ee=se?new Uint16Array(32768):[];X<Y.length;){var ne=Math.min(65535,Y.length-X);if(ne<10){for(K=Ct(z,K,+(X+ne==Y.length)),K&7&&(K+=8-(K&7)),z.l=K/8|0,z.write_shift(2,ne),z.write_shift(2,~ne&65535);ne-- >0;)z[z.l++]=Y[X++];K=z.l*8;continue}K=Ct(z,K,+(X+ne==Y.length)+2);for(var fe=0;ne-- >0;){var re=Y[X];fe=(fe<<5^re)&32767;var ce=-1,ge=0;if((ce=ee[fe])&&(ce|=X&-32768,ce>X&&(ce-=32768),ce<X))for(;Y[ce+ge]==Y[X+ge]&&ge<250;)++ge;if(ge>2){re=N[ge],re<=22?K=nr(z,K,te[re+1]>>1)-1:(nr(z,K,3),K+=5,nr(z,K,te[re-23]>>5),K+=3);var Re=re<8?0:re-4>>2;Re>0&&(Ea(z,K,ge-J[re]),K+=Re),re=A[X-ce],K=nr(z,K,te[re]>>3),K-=3;var Me=re<4?0:re-2>>1;Me>0&&(Ea(z,K,X-ce-ie[re]),K+=Me);for(var nt=0;nt<ge;++nt)ee[fe]=X&32767,fe=(fe<<5^Y[X])&32767,++X;ne-=ge-1}else re<=143?re=re+48:K=Xt(z,K,1),K=nr(z,K,te[re]),ee[fe]=X&32767,++X}K=nr(z,K,0)-1}return z.l=(K+7)/8|0,z.l}return function(z,K){return z.length<8?F(z,K):G(z,K)}})();function we(w){var A=qe(50+Math.floor(w.length*1.1)),E=Yt(w,A);return A.slice(0,E)}var He=se?new Uint16Array(32768):Et(32768),Ft=se?new Uint16Array(32768):Et(32768),Ye=se?new Uint16Array(128):Et(128),Dr=1,Jo=1;function Eh(w,A){var E=be(w,A)+257;A+=5;var _=be(w,A)+1;A+=5;var N=Ce(w,A)+4;A+=4;for(var F=0,G=se?new Uint8Array(19):Et(19),Y=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],z=1,K=se?new Uint8Array(8):Et(8),X=se?new Uint8Array(8):Et(8),ee=G.length,ne=0;ne<N;++ne)G[B[ne]]=F=Ne(w,A),z<F&&(z=F),K[F]++,A+=3;var fe=0;for(K[0]=0,ne=1;ne<=z;++ne)X[ne]=fe=fe+K[ne-1]<<1;for(ne=0;ne<ee;++ne)(fe=G[ne])!=0&&(Y[ne]=X[fe]++);var re=0;for(ne=0;ne<ee;++ne)if(re=G[ne],re!=0){fe=te[Y[ne]]>>8-re;for(var ce=(1<<7-re)-1;ce>=0;--ce)Ye[fe|ce<<re]=re&7|ne<<3}var ge=[];for(z=1;ge.length<E+_;)switch(fe=Ye[oe(w,A)],A+=fe&7,fe>>>=3){case 16:for(F=3+Ve(w,A),A+=2,fe=ge[ge.length-1];F-- >0;)ge.push(fe);break;case 17:for(F=3+Ne(w,A),A+=3;F-- >0;)ge.push(0);break;case 18:for(F=11+oe(w,A),A+=7;F-- >0;)ge.push(0);break;default:ge.push(fe),z<fe&&(z=fe);break}var Re=ge.slice(0,E),Me=ge.slice(E);for(ne=E;ne<286;++ne)Re[ne]=0;for(ne=_;ne<30;++ne)Me[ne]=0;return Dr=ir(Re,He,286),Jo=ir(Me,Ft,30),A}function _h(w,A){if(w[0]==3&&!(w[1]&3))return[Cr(A),2];for(var E=0,_=0,N=Lc(A||1<<18),F=0,G=N.length>>>0,Y=0,z=0;(_&1)==0;){if(_=Ne(w,E),E+=3,_>>>1)_>>1==1?(Y=9,z=5):(E=Eh(w,E),Y=Dr,z=Jo);else{E&7&&(E+=8-(E&7));var K=w[E>>>3]|w[(E>>>3)+1]<<8;if(E+=32,K>0)for(!A&&G<F+K&&(N=yr(N,F+K),G=N.length);K-- >0;)N[F++]=w[E>>>3],E+=8;continue}for(;;){!A&&G<F+32767&&(N=yr(N,F+32767),G=N.length);var X=Ue(w,E,Y),ee=_>>>1==1?wr[X]:He[X];if(E+=ee&15,ee>>>=4,(ee>>>8&255)===0)N[F++]=ee;else{if(ee==256)break;ee-=257;var ne=ee<8?0:ee-4>>2;ne>5&&(ne=0);var fe=F+J[ee];ne>0&&(fe+=Ue(w,E,ne),E+=ne),X=Ue(w,E,z),ee=_>>>1==1?_a[X]:Ft[X],E+=ee&15,ee>>>=4;var re=ee<4?0:ee-2>>1,ce=ie[ee];for(re>0&&(ce+=Ue(w,E,re),E+=re),!A&&G<fe&&(N=yr(N,fe+100),G=N.length);F<fe;)N[F]=N[F-ce],++F}}}return A?[N,E+7>>>3]:[N.slice(0,F),E+7>>>3]}function Zo(w,A){var E=w.slice(w.l||0),_=_h(E,A);return w.l+=_[1],_[0]}function e0(w,A){if(w)typeof console<"u"&&console.error(A);else throw new Error(A)}function t0(w,A){var E=w;rt(E,0);var _=[],N=[],F={FileIndex:_,FullPaths:N};k(F,{root:A.root});for(var G=E.length-4;(E[G]!=80||E[G+1]!=75||E[G+2]!=5||E[G+3]!=6)&&G>=0;)--G;E.l=G+4,E.l+=4;var Y=E.read_shift(2);E.l+=6;var z=E.read_shift(4);for(E.l=z,G=0;G<Y;++G){E.l+=20;var K=E.read_shift(4),X=E.read_shift(4),ee=E.read_shift(2),ne=E.read_shift(2),fe=E.read_shift(2);E.l+=8;var re=E.read_shift(4),ce=o(E.slice(E.l+ee,E.l+ee+ne));E.l+=ee+ne+fe;var ge=E.l;E.l=re+4,Sh(E,K,X,F,ce),E.l=ge}return F}function Sh(w,A,E,_,N){w.l+=2;var F=w.read_shift(2),G=w.read_shift(2),Y=i(w);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var z=w.read_shift(4),K=w.read_shift(4),X=w.read_shift(4),ee=w.read_shift(2),ne=w.read_shift(2),fe="",re=0;re<ee;++re)fe+=String.fromCharCode(w[w.l++]);if(ne){var ce=o(w.slice(w.l,w.l+ne));(ce[21589]||{}).mt&&(Y=ce[21589].mt),((N||{})[21589]||{}).mt&&(Y=N[21589].mt)}w.l+=ne;var ge=w.slice(w.l,w.l+K);switch(G){case 8:ge=V(w,X);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var Re=!1;F&8&&(z=w.read_shift(4),z==134695760&&(z=w.read_shift(4),Re=!0),K=w.read_shift(4),X=w.read_shift(4)),K!=A&&e0(Re,"Bad compressed size: "+A+" != "+K),X!=E&&e0(Re,"Bad uncompressed size: "+E+" != "+X),Cn(_,fe,ge,{unsafe:!0,mt:Y})}function Ah(w,A){var E=A||{},_=[],N=[],F=qe(1),G=E.compression?8:0,Y=0,z=0,K=0,X=0,ee=0,ne=w.FullPaths[0],fe=ne,re=w.FileIndex[0],ce=[],ge=0;for(z=1;z<w.FullPaths.length;++z)if(fe=w.FullPaths[z].slice(ne.length),re=w.FileIndex[z],!(!re.size||!re.content||fe=="Sh33tJ5")){var Re=X,Me=qe(fe.length);for(K=0;K<fe.length;++K)Me.write_shift(1,fe.charCodeAt(K)&127);Me=Me.slice(0,Me.l),ce[ee]=zv.buf(re.content,0);var nt=re.content;G==8&&(nt=I(nt)),F=qe(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,Y),F.write_shift(2,G),re.mt?n(F,re.mt):F.write_shift(4,0),F.write_shift(-4,ce[ee]),F.write_shift(4,nt.length),F.write_shift(4,re.content.length),F.write_shift(2,Me.length),F.write_shift(2,0),X+=F.length,_.push(F),X+=Me.length,_.push(Me),X+=nt.length,_.push(nt),F=qe(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,Y),F.write_shift(2,G),F.write_shift(4,0),F.write_shift(-4,ce[ee]),F.write_shift(4,nt.length),F.write_shift(4,re.content.length),F.write_shift(2,Me.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Re),ge+=F.l,N.push(F),ge+=Me.length,N.push(Me),++ee}return F=qe(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,ee),F.write_shift(2,ee),F.write_shift(4,ge),F.write_shift(4,X),F.write_shift(2,0),Tr([Tr(_),Tr(N),F])}var As={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Nh(w,A){if(w.ctype)return w.ctype;var E=w.name||"",_=E.match(/\.([^\.]+)$/);return _&&As[_[1]]||A&&(_=(E=A).match(/[\.\\]([^\.\\])+$/),_&&As[_[1]])?As[_[1]]:"application/octet-stream"}function Ch(w){for(var A=Ic(w),E=[],_=0;_<A.length;_+=76)E.push(A.slice(_,_+76));return E.join(`\r
`)+`\r
`}function Fh(w){var A=w.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var X=K.charCodeAt(0).toString(16).toUpperCase();return"="+(X.length==1?"0"+X:X)});A=A.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),A.charAt(0)==`
`&&(A="=0D"+A.slice(1)),A=A.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var E=[],_=A.split(`\r
`),N=0;N<_.length;++N){var F=_[N];if(F.length==0){E.push("");continue}for(var G=0;G<F.length;){var Y=76,z=F.slice(G,G+Y);z.charAt(Y-1)=="="?Y--:z.charAt(Y-2)=="="?Y-=2:z.charAt(Y-3)=="="&&(Y-=3),z=F.slice(G,G+Y),G+=Y,G<F.length&&(z+="="),E.push(z)}}return E.join(`\r
`)}function jh(w){for(var A=[],E=0;E<w.length;++E){for(var _=w[E];E<=w.length&&_.charAt(_.length-1)=="=";)_=_.slice(0,_.length-1)+w[++E];A.push(_)}for(var N=0;N<A.length;++N)A[N]=A[N].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return zt(A.join(`\r
`))}function Ph(w,A,E){for(var _="",N="",F="",G,Y=0;Y<10;++Y){var z=A[Y];if(!z||z.match(/^\s*$/))break;var K=z.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":_=K[2].trim();break;case"content-type":F=K[2].trim();break;case"content-transfer-encoding":N=K[2].trim();break}}switch(++Y,N.toLowerCase()){case"base64":G=zt(Nt(A.slice(Y).join("")));break;case"quoted-printable":G=jh(A.slice(Y));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var X=Cn(w,_.slice(E.length),G,{unsafe:!0});F&&(X.ctype=F)}function Dh(w,A){if(U(w.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var E=A&&A.root||"",_=(Te&&Buffer.isBuffer(w)?w.toString("binary"):U(w)).split(`\r
`),N=0,F="";for(N=0;N<_.length;++N)if(F=_[N],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),E||(E=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,E.length)!=E))for(;E.length>0&&(E=E.slice(0,E.length-1),E=E.slice(0,E.lastIndexOf("/")+1),F.slice(0,E.length)!=E););var G=(_[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Y="--"+(G[1]||""),z=[],K=[],X={FileIndex:z,FullPaths:K};k(X);var ee,ne=0;for(N=0;N<_.length;++N){var fe=_[N];fe!==Y&&fe!==Y+"--"||(ne++&&Ph(X,_.slice(ee,N),E),ee=N)}return X}function Rh(w,A){var E=A||{},_=E.boundary||"SheetJS";_="------="+_;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+_.slice(2)+'"',"","",""],F=w.FullPaths[0],G=F,Y=w.FileIndex[0],z=1;z<w.FullPaths.length;++z)if(G=w.FullPaths[z].slice(F.length),Y=w.FileIndex[z],!(!Y.size||!Y.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(ge){return"_x"+ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(ge){return"_u"+ge.charCodeAt(0).toString(16)+"_"});for(var K=Y.content,X=Te&&Buffer.isBuffer(K)?K.toString("binary"):U(K),ee=0,ne=Math.min(1024,X.length),fe=0,re=0;re<=ne;++re)(fe=X.charCodeAt(re))>=32&&fe<128&&++ee;var ce=ee>=ne*4/5;N.push(_),N.push("Content-Location: "+(E.root||"file:///C:/SheetJS/")+G),N.push("Content-Transfer-Encoding: "+(ce?"quoted-printable":"base64")),N.push("Content-Type: "+Nh(Y,G)),N.push(""),N.push(ce?Fh(X):Ch(X))}return N.push(_+`--\r
`),N.join(`\r
`)}function Mh(w){var A={};return k(A,w),A}function Cn(w,A,E,_){var N=_&&_.unsafe;N||k(w);var F=!N&&Ee.find(w,A);if(!F){var G=w.FullPaths[0];A.slice(0,G.length)==G?G=A:(G.slice(-1)!="/"&&(G+="/"),G=(G+A).replace("//","/")),F={name:s(A),type:2},w.FileIndex.push(F),w.FullPaths.push(G),N||Ee.utils.cfb_gc(w)}return F.content=E,F.size=E?E.length:0,_&&(_.CLSID&&(F.clsid=_.CLSID),_.mt&&(F.mt=_.mt),_.ct&&(F.ct=_.ct)),F}function Oh(w,A){k(w);var E=Ee.find(w,A);if(E){for(var _=0;_<w.FileIndex.length;++_)if(w.FileIndex[_]==E)return w.FileIndex.splice(_,1),w.FullPaths.splice(_,1),!0}return!1}function Ih(w,A,E){k(w);var _=Ee.find(w,A);if(_){for(var N=0;N<w.FileIndex.length;++N)if(w.FileIndex[N]==_)return w.FileIndex[N].name=s(E),w.FullPaths[N]=E,!0}return!1}function Lh(w){P(w,!0)}return t.find=O,t.read=b,t.parse=f,t.write=ue,t.writeFile=de,t.utils={cfb_new:Mh,cfb_add:Cn,cfb_del:Oh,cfb_mov:Ih,cfb_gc:Lh,ReadShift:Ha,CheckField:_d,prep_blob:rt,bconcat:Tr,use_zlib:j,_deflateRaw:we,_inflateRaw:Zo,consts:Z},t})();function Gv(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function rr(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function Fo(e){for(var t=[],r=rr(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}var nn=new Date(1899,11,30,0,0,0);function kt(e,t){var r=e.getTime(),a=nn.getTime()+(e.getTimezoneOffset()-nn.getTimezoneOffset())*6e4;return(r-a)/(1440*60*1e3)}var sd=new Date,$v=nn.getTime()+(sd.getTimezoneOffset()-nn.getTimezoneOffset())*6e4,$c=sd.getTimezoneOffset();function _n(e){var t=new Date;return t.setTime(e*24*60*60*1e3+$v),t.getTimezoneOffset()!==$c&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$c)*6e4),t}function Kv(e){var t=0,r=0,a=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=s.length;++n)if(s[n]){switch(r=1,n>3&&(a=!0),s[n].slice(s[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[n].slice(s[n].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[n],10)}return t}var Kc=new Date("2017-02-19T19:06:09.000Z"),nd=isNaN(Kc.getFullYear())?new Date("2/19/17"):Kc,Xv=nd.getFullYear()==2017;function et(e,t){var r=new Date(e);if(Xv)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(nd.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-n.getTimezoneOffset()*60*1e3)),n}function $r(e,t){if(Te&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Oa(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Oa(Gu(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Oa(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Oa(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(n){return r[n]||n})}catch{}for(var a=[],s=0;s!=e.length;++s)a.push(String.fromCharCode(e[s]));return a.join("")}function at(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=at(e[r]));return t}function Le(e,t){for(var r="";r.length<t;)r+=e;return r}function Kt(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,n){return r=-r,n}),!isNaN(t=Number(a)))?t/r:t}var Yv=["january","february","march","april","may","june","july","august","september","october","november","december"];function pa(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),s=t.getMonth(),n=t.getDate();if(isNaN(n))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Yv.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return a<0||a>8099?r:(s>0||n>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var qv=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,s){if(e||typeof a=="string")return r.split(a);for(var n=r.split(a),i=[n[0]],o=1;o<n.length;++o)i.push(s),i.push(n[o]);return i}})();function id(e){return e?e.content&&e.type?$r(e.content,!0):e.data?Da(e.data):e.asNodeBuffer&&Te?Da(e.asNodeBuffer().toString("binary")):e.asBinary?Da(e.asBinary()):e._data&&e._data.getContent?Da($r(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function od(e){if(!e)return null;if(e.data)return Mc(e.data);if(e.asNodeBuffer&&Te)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Mc(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Qv(e){return e&&e.name.slice(-4)===".bin"?od(e):id(e)}function Ot(e,t){for(var r=e.FullPaths||rr(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),s=a.replace(/\\/g,"/"),n=0;n<r.length;++n){var i=r[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||s==i)return e.files?e.files[r[n]]:e.FileIndex[n]}return null}function jo(e,t){var r=Ot(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function $e(e,t,r){if(!r)return Qv(jo(e,t));if(!t)return null;try{return $e(e,t)}catch{return null}}function At(e,t,r){if(!r)return id(jo(e,t));if(!t)return null;try{return At(e,t)}catch{return null}}function Jv(e,t,r){return od(jo(e,t))}function Xc(e){for(var t=e.FullPaths||rr(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Zv(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Te?a=Xr(r):a=vv(r),Ee.utils.cfb_add(e,t,a)}Ee.utils.cfb_add(e,t,r)}else e.file(t,r)}function cd(e,t){switch(t.type){case"base64":return Ee.read(e,{type:"base64"});case"binary":return Ee.read(e,{type:"binary"});case"buffer":case"array":return Ee.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ma(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var s=a.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var ld=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ey=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Yc=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,ty=/<[^>]*>/g,ht=ld.match(Yc)?Yc:ty,ry=/<\w*:/,ay=/<(\/?)\w+:/;function me(e,t,r){for(var a={},s=0,n=0;s!==e.length&&!((n=e.charCodeAt(s))===32||n===10||n===13);++s);if(t||(a[0]=e.slice(0,s)),s===e.length)return a;var i=e.match(ey),o=0,l="",u=0,f="",d="",h=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],n=0;n!=d.length&&d.charCodeAt(n)!==61;++n);for(f=d.slice(0,n).trim();d.charCodeAt(n+1)==32;)++n;for(h=(s=d.charCodeAt(n+1))==34||s==39?1:0,l=d.slice(n+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),a[f]=l,a[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(a[p]&&f.slice(o-3,o)=="ext")continue;a[p]=l,a[p.toLowerCase()]=l}}return a}function ar(e){return e.replace(ay,"<$1")}var fd={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},sy=Fo(fd),Ae=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var s=a+"",n=s.indexOf("<![CDATA[");if(n==-1)return s.replace(e,function(o,l){return fd[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,n))+s.slice(n+9,i)+r(s.slice(i+3))}})(),ny=/[&<>'"]/g,iy=/[\u0000-\u001f]/g;function Po(e){var t=e+"";return t.replace(ny,function(r){return sy[r]}).replace(/\n/g,"<br/>").replace(iy,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var qc=(function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}})();function je(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Yn(e){for(var t="",r=0,a=0,s=0,n=0,i=0,o=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(r++),a>191&&a<224){i=(a&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(n=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(s&63)<<6|n&63);continue}i=e.charCodeAt(r++),o=((a&7)<<18|(s&63)<<12|(n&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Qc(e){var t=Cr(2*e.length),r,a,s=1,n=0,i=0,o;for(a=0;a<e.length;a+=s)s=1,(o=e.charCodeAt(a))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(a+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[n++]=i&255,t[n++]=i>>>8,i=0),t[n++]=r%256,t[n++]=r>>>8;return t.slice(0,n).toString("ucs2")}function Jc(e){return Xr(e,"binary").toString("utf8")}var Ms="foo bar baz",Fe=Te&&(Jc(Ms)==Yn(Ms)&&Jc||Qc(Ms)==Yn(Ms)&&Qc)||Yn,Oa=Te?function(e){return Xr(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,s=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},ls=(function(){var e={};return function(r,a){var s=r+"|"+(a||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}})(),ud=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)a=a.replace(e[s][0],e[s][1]);return a}})(),oy=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),cy=/<\/?(?:vt:)?variant>/g,ly=/<(?:vt:)([^>]*)>([\s\S]*)</;function Zc(e,t){var r=me(e),a=e.match(oy(r.baseType))||[],s=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return s}return a.forEach(function(n){var i=n.replace(cy,"").match(ly);i&&s.push({v:Fe(i[2]),t:i[1]})}),s}var fy=/(^\s|\s$|\n)/;function uy(e){return rr(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function dy(e,t,r){return"<"+e+(r!=null?uy(r):"")+(t!=null?(t.match(fy)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Do(e){if(Te&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Fe(Yr(Ao(e)));throw new Error("Bad input format: expected Buffer or string")}var fs=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,hy={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},xy=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function my(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,n=5;n>=0;--n)s=s*256+e[t+n];return a==2047?s==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),r*Math.pow(2,a-52)*s)}function py(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,s=0,n=0,i=a?-t:t;isFinite(i)?i==0?s=n=0:(s=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?s=-1022:(n-=Math.pow(2,52),s+=1023)):(s=2047,n=isNaN(t)?26985:0);for(var o=0;o<=5;++o,n/=256)e[r+o]=n&255;e[r+6]=(s&15)<<4|n&15,e[r+7]=s>>4|a}var el=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var s=0,n=e[0][a].length;s<n;s+=r)t.push.apply(t,e[0][a].slice(s,s+r));return t},tl=Te?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Xr(t)})):el(e)}:el,rl=function(e,t,r){for(var a=[],s=t;s<r;s+=2)a.push(String.fromCharCode(lr(e,s)));return a.join("").replace(wt,"")},Ro=Te?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(wt,""):rl(e,t,r)}:rl,al=function(e,t,r){for(var a=[],s=t;s<t+r;++s)a.push(("0"+e[s].toString(16)).slice(-2));return a.join("")},dd=Te?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):al(e,t,r)}:al,sl=function(e,t,r){for(var a=[],s=t;s<r;s++)a.push(String.fromCharCode(ta(e,s)));return a.join("")},ks=Te?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):sl(t,r,a)}:sl,hd=function(e,t){var r=St(e,t);return r>0?ks(e,t+4,t+4+r-1):""},xd=hd,md=function(e,t){var r=St(e,t);return r>0?ks(e,t+4,t+4+r-1):""},pd=md,gd=function(e,t){var r=2*St(e,t);return r>0?ks(e,t+4,t+4+r-1):""},vd=gd,yd=function(t,r){var a=St(t,r);return a>0?Ro(t,r+4,r+4+a):""},wd=yd,kd=function(e,t){var r=St(e,t);return r>0?ks(e,t+4,t+4+r):""},bd=kd,Td=function(e,t){return my(e,t)},on=Td,Ed=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Te&&(xd=function(t,r){if(!Buffer.isBuffer(t))return hd(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},pd=function(t,r){if(!Buffer.isBuffer(t))return md(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},vd=function(t,r){if(!Buffer.isBuffer(t))return gd(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},wd=function(t,r){if(!Buffer.isBuffer(t))return yd(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},bd=function(t,r){if(!Buffer.isBuffer(t))return kd(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},on=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Td(t,r)},Ed=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ta=function(e,t){return e[t]},lr=function(e,t){return e[t+1]*256+e[t]},gy=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},St=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ir=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},vy=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ha(e,t){var r="",a,s,n=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,Te&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(lr(this,u)),u+=2;e*=2;break;case"utf8":r=ks(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Ro(this,this.l,this.l+e);break;case"wstr":return Ha.call(this,e,"dbcs");case"lpstr-ansi":r=xd(this,this.l),e=4+St(this,this.l);break;case"lpstr-cp":r=pd(this,this.l),e=4+St(this,this.l);break;case"lpwstr":r=vd(this,this.l),e=4+2*St(this,this.l);break;case"lpp4":e=4+St(this,this.l),r=wd(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+St(this,this.l),r=bd(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=ta(this,this.l+e++))!==0;)n.push(Rs(i));r=n.join("");break;case"_wstr":for(e=0,r="";(i=lr(this,this.l+e))!==0;)n.push(Rs(i)),e+=2;e+=2,r=n.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=ta(this,u),this.l=u+1,o=Ha.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(Rs(lr(this,u))),u+=2}r=n.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=ta(this,u),this.l=u+1,o=Ha.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),n.join("")+o;n.push(Rs(ta(this,u))),u+=1}r=n.join("");break;default:switch(e){case 1:return a=ta(this,this.l),this.l++,a;case 2:return a=(t==="i"?gy:lr)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?Ir:vy)(this,this.l),this.l+=4,a):(s=St(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=on(this,this.l):s=on([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=dd(this,this.l,e);break}}return this.l+=e,r}var yy=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},wy=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},ky=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function by(e,t,r){var a=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)ky(this,t.charCodeAt(s),this.l+2*s);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;a=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var n=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<n;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,yy(this,t,this.l);break;case 8:if(a=8,r==="f"){py(this,t,this.l);break}case 16:break;case-4:a=4,wy(this,t,this.l);break}return this.l+=a,this}function _d(e,t){var r=dd(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function rt(e,t){e.l=t,e.read_shift=Ha,e.chk=_d,e.write_shift=by}function dt(e,t){e.l+=t}function qe(e){var t=Cr(e);return rt(t,0),t}function vr(e,t,r){if(e){var a,s,n;rt(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=hn[o]||hn[65535];for(a=e.read_shift(1),n=a&127,s=1;s<4&&a&128;++s)n+=((a=e.read_shift(1))&127)<<7*s;l=e.l+n;var f=u.f&&u.f(e,n,r);if(e.l=l,t(f,u,o))return}}}function ji(){var e=[],t=Te?256:2048,r=function(u){var f=qe(u);return rt(f,0),f},a=r(t),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},n=function(u){return a&&u<a.length-a.l?a:(s(),a=r(Math.max(u+1,t)))},i=function(){return s(),Tr(e)},o=function(u){s(),a=u,a.l==null&&(a.l=a.length),n(t)};return{next:n,push:o,end:i,_bufs:e}}function Wa(e,t,r){var a=at(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function nl(e,t,r){var a=at(e);return a.s=Wa(a.s,t.s,r),a.e=Wa(a.e,t.s,r),a}function za(e,t){if(e.cRel&&e.c<0)for(e=at(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=at(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=pe(e);return!e.cRel&&e.cRel!=null&&(r=_y(r)),!e.rRel&&e.rRel!=null&&(r=Ty(r)),r}function qn(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qe(e.s.c)+":"+(e.e.cRel?"":"$")+Qe(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+st(e.s.r)+":"+(e.e.rRel?"":"$")+st(e.e.r):za(e.s,t.biff)+":"+za(e.e,t.biff)}function Mo(e){return parseInt(Ey(e),10)-1}function st(e){return""+(e+1)}function Ty(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Ey(e){return e.replace(/\$(\d+)$/,"$1")}function Oo(e){for(var t=Sy(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function Qe(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function _y(e){return e.replace(/^([A-Z])/,"$$$1")}function Sy(e){return e.replace(/^\$([A-Z])/,"$1")}function Ay(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function yt(e){for(var t=0,r=0,a=0;a<e.length;++a){var s=e.charCodeAt(a);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function pe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function ba(e){var t=e.indexOf(":");return t==-1?{s:yt(e),e:yt(e)}:{s:yt(e.slice(0,t)),e:yt(e.slice(t+1))}}function _e(e,t){return typeof t>"u"||typeof t=="number"?_e(e.s,e.e):(typeof e!="string"&&(e=pe(e)),typeof t!="string"&&(t=pe(t)),e==t?e:e+":"+t)}function Be(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,s=0,n=e.length;for(r=0;a<n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.s.c=--r,r=0;a<n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;if(t.s.r=--r,a===n||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=n&&!((s=e.charCodeAt(a)-64)<1||s>26);++a)r=26*r+s;for(t.e.c=--r,r=0;a!=n&&!((s=e.charCodeAt(a)-48)<0||s>9);++a)r=10*r+s;return t.e.r=--r,t}function il(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Lt(e.z,r?kt(t):t)}catch{}try{return e.w=Lt((e.XF||{}).numFmtId||(r?14:0),r?kt(t):t)}catch{return""+t}}function pr(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Jr[e.v]||e.v:t==null?il(e,e.v):il(e,t))}function Pr(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function Sd(e,t,r){var a=r||{},s=e?Array.isArray(e):a.dense,n=e||(s?[]:{}),i=0,o=0;if(n&&a.origin!=null){if(typeof a.origin=="number")i=a.origin;else{var l=typeof a.origin=="string"?yt(a.origin):a.origin;i=l.r,o=l.c}n["!ref"]||(n["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var f=Be(n["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},x=i+d,m=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>m&&(u.s.c=m),u.e.r<x&&(u.e.r=x),u.e.c<m&&(u.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(a.nullError)p.t="e",p.v=0;else if(a.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=a.dateNF||ve[14],a.cellDates?(p.t="d",p.w=Lt(p.z,kt(p.v))):(p.t="n",p.v=kt(p.v),p.w=Lt(p.z,p.v))):p.t="s";if(s)n[x]||(n[x]=[]),n[x][m]&&n[x][m].z&&(p.z=n[x][m].z),n[x][m]=p;else{var g=pe({c:m,r:x});n[g]&&n[g].z&&(p.z=n[g].z),n[g]=p}}}return u.s.c<1e7&&(n["!ref"]=_e(u)),n}function Ta(e,t){return Sd(null,e,t)}function Ny(e){return e.read_shift(4,"i")}function ut(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Cy(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Io(e,t){var r=e.l,a=e.read_shift(1),s=ut(e),n=[],i={t:s,h:s};if((a&1)!==0){for(var o=e.read_shift(4),l=0;l!=o;++l)n.push(Cy(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var Fy=Io;function Bt(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function qr(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var jy=ut;function Lo(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Py=ut,Pi=Lo;function Bo(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var s=a===0?on([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ir(t,0)>>2;return r?s/100:s}function Ad(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Qr=Ad;function ct(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Dy(e){var t={},r=e.read_shift(1),a=r>>>1,s=e.read_shift(1),n=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=s;var u=zr[s];u&&(t.rgb=ds(u));break;case 2:t.rgb=ds([i,o,l]);break;case 3:t.theme=s;break}return n!=0&&(t.tint=n>0?n/32767:n/32768),t}function Ry(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Nd(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function My(e){return Nd(e,1)}function Oy(e){return Nd(e,2)}var Vo=2,bt=3,Os=11,ol=12,cn=19,Is=64,Iy=65,Ly=71,By=4108,Vy=4126,Ze=80,Cd=81,Uy=[Ze,Cd],Hy={1:{n:"CodePage",t:Vo},2:{n:"Category",t:Ze},3:{n:"PresentationFormat",t:Ze},4:{n:"ByteCount",t:bt},5:{n:"LineCount",t:bt},6:{n:"ParagraphCount",t:bt},7:{n:"SlideCount",t:bt},8:{n:"NoteCount",t:bt},9:{n:"HiddenCount",t:bt},10:{n:"MultimediaClipCount",t:bt},11:{n:"ScaleCrop",t:Os},12:{n:"HeadingPairs",t:By},13:{n:"TitlesOfParts",t:Vy},14:{n:"Manager",t:Ze},15:{n:"Company",t:Ze},16:{n:"LinksUpToDate",t:Os},17:{n:"CharacterCount",t:bt},19:{n:"SharedDoc",t:Os},22:{n:"HyperlinksChanged",t:Os},23:{n:"AppVersion",t:bt,p:"version"},24:{n:"DigSig",t:Iy},26:{n:"ContentType",t:Ze},27:{n:"ContentStatus",t:Ze},28:{n:"Language",t:Ze},29:{n:"Version",t:Ze},255:{},2147483648:{n:"Locale",t:cn},2147483651:{n:"Behavior",t:cn},1919054434:{}},Wy={1:{n:"CodePage",t:Vo},2:{n:"Title",t:Ze},3:{n:"Subject",t:Ze},4:{n:"Author",t:Ze},5:{n:"Keywords",t:Ze},6:{n:"Comments",t:Ze},7:{n:"Template",t:Ze},8:{n:"LastAuthor",t:Ze},9:{n:"RevNumber",t:Ze},10:{n:"EditTime",t:Is},11:{n:"LastPrinted",t:Is},12:{n:"CreatedDate",t:Is},13:{n:"ModifiedDate",t:Is},14:{n:"PageCount",t:bt},15:{n:"WordCount",t:bt},16:{n:"CharCount",t:bt},17:{n:"Thumbnail",t:Ly},18:{n:"Application",t:Ze},19:{n:"DocSecurity",t:bt},255:{},2147483648:{n:"Locale",t:cn},2147483651:{n:"Behavior",t:cn},1919054434:{}},cl={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zy=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Gy(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var $y=Gy([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),zr=at($y),Jr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Fd={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ll={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Ky(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Xy(e){var t=Ky();if(!e||!e.match)return t;var r={};if((e.match(ht)||[]).forEach(function(a){var s=me(a);switch(s[0].replace(ry,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[ll[s.ContentType]]!==void 0&&t[ll[s.ContentType]].push(s.PartName);break}}),t.xmlns!==hy.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var oa={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Di(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ga(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(ht)||[]).forEach(function(s){var n=me(s);if(n[0]==="<Relationship"){var i={};i.Type=n.Type,i.Target=n.Target,i.Id=n.Id,n.TargetMode&&(i.TargetMode=n.TargetMode);var o=n.TargetMode==="External"?n.Target:Ma(n.Target,t);r[o]=i,a[n.Id]=i}}),r["!id"]=a,r}var Yy="application/vnd.oasis.opendocument.spreadsheet";function qy(e,t){for(var r=Do(e),a,s;a=fs.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(s=me(a[0],!1),s.path=="/"&&s.type!==Yy)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}var $a=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Qy=(function(){for(var e=new Array($a.length),t=0;t<$a.length;++t){var r=$a[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e})();function jd(e){var t={};e=Fe(e);for(var r=0;r<$a.length;++r){var a=$a[r],s=e.match(Qy[r]);s!=null&&s.length>0&&(t[a[1]]=Ae(s[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=et(t[a[1]]))}return t}var Jy=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Pd(e,t,r,a){var s=[];if(typeof e=="string")s=Zc(e,a);else for(var n=0;n<e.length;++n)s=s.concat(e[n].map(function(f){return{v:f}}));var i=typeof t=="string"?Zc(t,a).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function Zy(e,t,r){var a={};return t||(t={}),e=Fe(e),Jy.forEach(function(s){var n=(e.match(ls(s[0]))||[])[1];switch(s[2]){case"string":n&&(t[s[1]]=Ae(n));break;case"bool":t[s[1]]=n==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(a[s[1]]=i[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&Pd(a.HeadingPairs,a.TitlesOfParts,t,r),t}var e4=/<[^>]+>[^<]*/g;function t4(e,t){var r={},a="",s=e.match(e4);if(s)for(var n=0;n!=s.length;++n){var i=s[n],o=me(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":a=Ae(o.name);break;case"</property>":a=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[a]=Ae(f);break;case"bool":r[a]=je(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(f);break;case"filetime":case"date":r[a]=et(f);break;case"cy":case"error":r[a]=Ae(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var r4={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qn;function a4(e,t,r){Qn||(Qn=Fo(r4)),t=Qn[t]||t,e[t]=r}function Uo(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Dd(e,t,r){var a=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return s}function Rd(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function Md(e,t,r){return t===31?Rd(e):Dd(e,t,r)}function Ri(e,t,r){return Md(e,t,r===!1?0:4)}function s4(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Md(e,t,0)}function n4(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var s=e.l;r[a]=e.read_shift(0,"lpwstr").replace(wt,""),e.l-s&2&&(e.l+=2)}return r}function i4(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(wt,"");return r}function o4(e){var t=e.l,r=ln(e,Cd);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=ln(e,bt);return[r,a]}function c4(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(o4(e));return r}function fl(e,t){for(var r=e.read_shift(4),a={},s=0;s!=r;++s){var n=e.read_shift(4),i=e.read_shift(4);a[n]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(wt,"").replace(Ra,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function Od(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function l4(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function ln(e,t,r){var a=e.read_shift(2),s,n=r||{};if(e.l+=2,t!==ol&&a!==t&&Uy.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===ol?a:t){case 2:return s=e.read_shift(2,"i"),n.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Dd(e,a,4).replace(wt,"");case 31:return Rd(e);case 64:return Uo(e);case 65:return Od(e);case 71:return l4(e);case 80:return Ri(e,a,!n.raw).replace(wt,"");case 81:return s4(e,a).replace(wt,"");case 4108:return c4(e);case 4126:case 4127:return a==4127?n4(e):i4(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function ul(e,t){var r=e.l,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var f=e.read_shift(4),d=e.read_shift(4);n[i]=[f,d+r]}n.sort(function(T,v){return T[1]-v[1]});var h={};for(i=0;i!=s;++i){if(e.l!==n[i][1]){var p=!0;if(i>0&&t)switch(t[n[i-1][0]].t){case 2:e.l+2===n[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=n[i][1]&&(e.l=n[i][1],p=!1);break;case 4108:e.l<=n[i][1]&&(e.l=n[i][1],p=!1);break}if((!t||i==0)&&e.l<=n[i][1]&&(p=!1,e.l=n[i][1]),p)throw new Error("Read Error: Expected address "+n[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[n[i][0]];if(h[x.n]=ln(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gt(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(n[i][0]===1){if(o=h.CodePage=ln(e,Vo),Gt(o),l!==-1){var m=e.l;e.l=n[l][1],u=fl(e,o),e.l=m}}else if(n[i][0]===0){if(o===0){l=i,e.l=n[i+1][1];continue}u=fl(e,o)}else{var g=u[n[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=Od(e);break;case 30:e.l+=4,y=Ri(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Ri(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=We(e,4);break;case 64:e.l+=4,y=et(Uo(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+a,h}function dl(e,t,r){var a=e.content;if(!a)return{};rt(a,0);var s,n,i,o,l=0;a.chk("feff","Byte Order: "),a.read_shift(2);var u=a.read_shift(4),f=a.read_shift(16);if(f!==Ee.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=a.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(n=a.read_shift(16),o=a.read_shift(4),s===1&&o!==a.l)throw new Error("Length mismatch: "+o+" !== "+a.l);s===2&&(i=a.read_shift(16),l=a.read_shift(4));var d=ul(a,t),h={SystemIdentifier:u};for(var p in d)h[p]=d[p];if(h.FMTID=n,s===1)return h;if(l-a.l==2&&(a.l+=2),a.l!==l)throw new Error("Length mismatch 2: "+a.l+" !== "+l);var x;try{x=ul(a,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[n,i],h}function kr(e,t){return e.read_shift(t),null}function f4(e,t,r){for(var a=[],s=e.l+t;e.l<s;)a.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return a}function We(e,t){return e.read_shift(t)===1}function Ke(e){return e.read_shift(2,"u")}function Id(e,t){return f4(e,t,Ke)}function u4(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function bs(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var n=e.read_shift(1);n&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=a?e.read_shift(a,s):"";return i}function d4(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,s=r&8,n=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),a&&(o=e.read_shift(4));var u=n==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),a&&(e.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Kr(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Ts(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Kr(e,a,r)}function Zr(e,t,r){if(r.biff>5)return Ts(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function h4(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function x4(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var s=e.read_shift((a?t-24:t)>>1,"utf16le").replace(wt,"");return a&&(e.l+=24),s}function m4(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+a.replace(/\\/g,"/");var n=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(n>>1,"utf16le").replace(wt,"");return r+i}function p4(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return x4(e);case"0303000000000000c000000000000046":return m4(e);default:throw new Error("Unsupported Moniker "+r)}}function Ls(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(wt,""):"";return r}function g4(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var s=e.read_shift(2);e.l+=2;var n,i,o,l,u="",f,d;s&16&&(n=Ls(e,r-e.l)),s&128&&(i=Ls(e,r-e.l)),(s&257)===257&&(o=Ls(e,r-e.l)),(s&257)===1&&(l=p4(e,r-e.l)),s&8&&(u=Ls(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(d=Uo(e)),e.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),n&&(p.Tooltip=n),p}function Ld(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);return[t,r,a,s]}function Bd(e,t){var r=Ld(e);return r[3]=0,r}function sr(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function v4(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function y4(e,t,r){return t===0?"":Zr(e,t,r)}function w4(e,t,r){var a=r.biff>8?4:2,s=e.read_shift(a),n=e.read_shift(a,"i"),i=e.read_shift(a,"i");return[s,n,i]}function Vd(e){var t=e.read_shift(2),r=Bo(e);return[t,r]}function k4(e,t,r){e.l+=4,t-=4;var a=e.l+t,s=bs(e,t,r),n=e.read_shift(2);if(a-=e.l,n!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return e.l+=n,s}function Sn(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);return{s:{c:a,r:t},e:{c:s,r}}}function Ud(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),s=e.read_shift(1);return{s:{c:a,r:t},e:{c:s,r}}}var b4=Ud;function Hd(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function T4(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function E4(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function it(e){e.l+=2,e.l+=e.read_shift(2)}var _4={0:it,4:it,5:it,6:it,7:E4,8:it,9:it,10:it,11:it,12:it,13:T4,14:it,15:it,16:it,17:it,18:it,19:it,20:it,21:Hd};function S4(e,t){for(var r=e.l+t,a=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{a.push(_4[s](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Bs(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function A4(e,t){return t===0||e.read_shift(2),1200}function N4(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,s=Zr(e,0,r);return e.read_shift(t+a-e.l),s}function C4(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function F4(e,t,r){var a=e.read_shift(4),s=e.read_shift(1)&3,n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule";break}var i=bs(e,0,r);return i.length===0&&(i="Sheet1"),{pos:a,hs:s,dt:n,name:i}}function j4(e,t){for(var r=e.l+t,a=e.read_shift(4),s=e.read_shift(4),n=[],i=0;i!=s&&e.l<r;++i)n.push(d4(e));return n.Count=a,n.Unique=s,n}function P4(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function D4(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function R4(e){var t=v4(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function M4(e){return e.read_shift(2),e.read_shift(4)}function hl(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(a=1-(s>>15),s&=32767);var n={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[n,s]}function O4(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[a,s],Flags:n,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function I4(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function L4(){}function B4(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=bs(e,0,r),a}function V4(e){var t=sr(e);return t.isst=e.read_shift(4),t}function U4(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,s=sr(e);r.biff==2&&e.l++;var n=Ts(e,a-e.l,r);return s.val=n,s}function H4(e,t,r){var a=e.read_shift(2),s=Zr(e,0,r);return[a,s]}var W4=Zr;function xl(e,t,r){var a=e.l+t,s=r.biff==8||!r.biff?4:2,n=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=a,{s:{r:n,c:o},e:{r:i,c:l}}}function z4(e){var t=e.read_shift(2),r=e.read_shift(2),a=Vd(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function G4(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(Vd(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:a,c:s,C:i,rkrec:n}}function $4(e,t){for(var r=e.l+t-2,a=e.read_shift(2),s=e.read_shift(2),n=[];e.l<r;)n.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(n.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:a,c:s,C:i,ixfe:n}}function K4(e,t,r,a){var s={},n=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=zy[o>>26],a.cellStyles&&(s.alc=n&7,s.fWrap=n>>3&1,s.alcV=n>>4&7,s.fJustLast=n>>7&1,s.trot=n>>8&255,s.cIndent=n>>16&15,s.fShrinkToFit=n>>20&1,s.iReadOrder=n>>22&2,s.fAtrNum=n>>26&1,s.fAtrFnt=n>>27&1,s.fAtrAlc=n>>28&1,s.fAtrBdr=n>>29&1,s.fAtrPat=n>>30&1,s.fAtrProt=n>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function X4(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=K4(e,t,a.fStyle,r),a}function Y4(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function ml(e,t,r){var a=sr(e);(r.biff==2||t==9)&&++e.l;var s=u4(e);return a.val=s,a.t=s===!0||s===!1?"b":"e",a}function q4(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=sr(e),s=ct(e);return a.val=s,a}var pl=y4;function Q4(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(2);if(r.sbcch=n,n==1025||n==14849)return[n,s];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var i=Kr(e,n),o=[];a>e.l;)o.push(Ts(e));return[n,s,i,o]}function gl(e,t,r){var a=e.read_shift(2),s,n={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(s=k4(e,t-2,r)),n.body=s||e.read_shift(t-2),typeof s=="string"&&(n.Name=s),n}var J4=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function vl(e,t,r){var a=e.l+t,s=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Kr(e,i,r);s&32&&(u=J4[u.charCodeAt(0)]);var f=a-e.l;r&&r.biff==2&&--f;var d=a==e.l||o===0||!(f>0)?[]:D3(e,f,r,o);return{chKey:n,Name:u,itab:l,rgce:d}}function Wd(e,t,r){if(r.biff<8)return Z4(e,t,r);for(var a=[],s=e.l+t,n=e.read_shift(r.biff>8?4:2);n--!==0;)a.push(w4(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return a}function Z4(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=bs(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function ew(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),s=e.read_shift(2),n=Kr(e,a,r),i=Kr(e,s,r);return[n,i]}function tw(e,t,r){var a=Ud(e);e.l++;var s=e.read_shift(1);return t-=8,[R3(e,t,r),s,a]}function yl(e,t,r){var a=b4(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,j3(e,t,r)]}function rw(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function aw(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),o=Zr(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:s},o,i,n]}}function sw(e,t,r){return aw(e,t,r)}function nw(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(Sn(e));return r}function iw(e,t,r){if(r&&r.biff<8)return cw(e,t,r);var a=Hd(e),s=S4(e,t-22,a[1]);return{cmo:a,ft:s}}var ow={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:a}}};function cw(e,t,r){e.l+=4;var a=e.read_shift(2),s=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((ow[a]||dt)(e,t,r)),{cmo:[s,a,n],ft:i}}function lw(e,t,r){var a=e.l,s="";try{e.l+=4;var n=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(n)==-1?e.l+=6:i=h4(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ke(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-a!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=Kr(e,e.lens[u+1]-e.lens[u]-1);if(s+=d,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=a+t,{t:s}}catch{return e.l=a+t,{t:s}}}function fw(e,t){var r=Sn(e);e.l+=16;var a=g4(e,t-24);return[r,a]}function uw(e,t){e.read_shift(2);var r=Sn(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(wt,""),[r,a]}function dw(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=cl[r]||r,r=e.read_shift(2),t[1]=cl[r]||r,t}function hw(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Bd(e));return r}function xw(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(Bd(e));return r}function mw(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function zd(e,t,r){if(!r.cellStyles)return dt(e,t);var a=r&&r.biff>=12?4:2,s=e.read_shift(a),n=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(a),l=e.read_shift(2);a==2&&(e.l+=2);var u={s,e:n,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function pw(e,t){var r={};return t<32||(e.l+=16,r.header=ct(e),r.footer=ct(e),e.l+=2),r}function gw(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var s=e.read_shift(1);return e.l+=3,s&16&&(a.area=!0),a}var vw=sr,yw=Id,ww=Ts;function kw(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,s}function bw(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=sr(e);++e.l;var s=Zr(e,t-7,r);return a.t="str",a.val=s,a}function Tw(e){var t=sr(e);++e.l;var r=ct(e);return t.t="n",t.val=r,t}function Ew(e){var t=sr(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function _w(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function Sw(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Aw(e,t,r){var a=e.l+t,s=sr(e),n=e.read_shift(2),i=Kr(e,n,r);return e.l=a,s.t="str",s.val=i,s}var Nw=[2,3,48,49,131,139,140,245],wl=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Fo({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=Cr(1);switch(l.type){case"base64":f=zt(Nt(o));break;case"binary":f=zt(o);break;case"buffer":case"array":f=o;break}rt(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,g=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(g=f.read_shift(2));var y=f.read_shift(2),T=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(T=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var v=[],R={},D=Math.min(f.length,d==2?521:g-10-(p?264:0)),b=x?32:11;f.l<D&&f[f.l]!=13;)switch(R={},R.name=os.utils.decode(T,f.slice(f.l,f.l+b)).replace(/[\u0000\r\n].*$/g,""),f.l+=b,R.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(R.offset=f.read_shift(4)),R.len=f.read_shift(1),d==2&&(R.offset=f.read_shift(2)),R.dec=f.read_shift(1),R.name.length&&v.push(R),d!=2&&(f.l+=x?13:14),R.type){case"B":(!p||R.len!=8)&&l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+R.name+":"+R.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+R.type)}if(f[f.l]!==13&&(f.l=g-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=g;var k=0,S=0;for(u[0]=[],S=0;S!=v.length;++S)u[0][S]=v[S].name;for(;m-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++k]=[],S=0,S=0;S!=v.length;++S){var P=f.slice(f.l,f.l+v[S].len);f.l+=v[S].len,rt(P,0);var H=os.utils.decode(T,P);switch(v[S].type){case"C":H.trim().length&&(u[k][S]=H.replace(/\s+$/,""));break;case"D":H.length===8?u[k][S]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):u[k][S]=H;break;case"F":u[k][S]=parseFloat(H.trim());break;case"+":case"I":u[k][S]=x?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":u[k][S]=!0;break;case"N":case"F":u[k][S]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[k][S]="##MEMO##"+(x?parseInt(H.trim(),10):P.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(u[k][S]=+H||0);break;case"@":u[k][S]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[k][S]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[k][S]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][S]=-P.read_shift(-8,"f");break;case"B":if(p&&v[S].len==8){u[k][S]=P.read_shift(8,"f");break}case"G":case"P":P.l+=v[S].len;break;case"0":if(v[S].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[S].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=v,u}function a(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Ta(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function s(o,l){try{return Pr(a(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var n={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&Gt(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=ji(),d=Vi(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),x=o["!cols"]||[],m=0,g=0,y=0,T=1;for(m=0;m<h.length;++m){if(((x[m]||{}).DBF||{}).name){h[m]=x[m].DBF.name,++y;continue}if(h[m]!=null){if(++y,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(g=0;g<1024;++g)if(h.indexOf(h[m]+"_"+g)==-1){h[m]+="_"+g;break}}}}var v=Be(o["!ref"]),R=[],D=[],b=[];for(m=0;m<=v.e.c-v.s.c;++m){var k="",S="",P=0,H=[];for(g=0;g<p.length;++g)p[g][m]!=null&&H.push(p[g][m]);if(H.length==0||h[m]==null){R[m]="?";continue}for(g=0;g<H.length;++g){switch(typeof H[g]){case"number":S="B";break;case"string":S="C";break;case"boolean":S="L";break;case"object":S=H[g]instanceof Date?"D":"C";break;default:S="C"}P=Math.max(P,String(H[g]).length),k=k&&k!=S?"C":S}P>250&&(P=250),S=((x[m]||{}).DBF||{}).type,S=="C"&&x[m].DBF.len>P&&(P=x[m].DBF.len),k=="B"&&S=="N"&&(k="N",b[m]=x[m].DBF.dec,P=x[m].DBF.len),D[m]=k=="C"||S=="N"?P:n[k]||0,T+=D[m],R[m]=k}var O=f.next(32);for(O.write_shift(4,318902576),O.write_shift(4,p.length),O.write_shift(2,296+32*y),O.write_shift(2,T),m=0;m<4;++m)O.write_shift(4,0);for(O.write_shift(4,0|(+t[Wu]||3)<<8),m=0,g=0;m<h.length;++m)if(h[m]!=null){var C=f.next(32),W=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,W,"sbcs"),C.write_shift(1,R[m]=="?"?"C":R[m],"sbcs"),C.write_shift(4,g),C.write_shift(1,D[m]||n[R[m]]||0),C.write_shift(1,b[m]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),g+=D[m]||n[R[m]]||0}var q=f.next(264);for(q.write_shift(4,13),m=0;m<65;++m)q.write_shift(4,0);for(m=0;m<p.length;++m){var Q=f.next(T);for(Q.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(R[g]){case"L":Q.write_shift(1,p[m][g]==null?63:p[m][g]?84:70);break;case"B":Q.write_shift(8,p[m][g]||0,"f");break;case"N":var ae="0";for(typeof p[m][g]=="number"&&(ae=p[m][g].toFixed(b[g]||0)),y=0;y<D[g]-ae.length;++y)Q.write_shift(1,32);Q.write_shift(1,ae,"sbcs");break;case"D":p[m][g]?(Q.write_shift(4,("0000"+p[m][g].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(p[m][g].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+p[m][g].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var Z=String(p[m][g]!=null?p[m][g]:"").slice(0,D[g]);for(Q.write_shift(1,Z,"sbcs"),y=0;y<D[g]-Z.length;++y)Q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:a,from_sheet:i}})(),Cw=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+rr(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=e[p];return typeof x=="number"?Oc(x):x},a=function(h,p,x){var m=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return m==59?h:Oc(m)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return n(Nt(h),p);case"binary":return n(h,p);case"buffer":return n(Te&&Buffer.isBuffer(h)?h.toString("binary"):Yr(h),p);case"array":return n($r(h),p)}throw new Error("Unrecognized type "+p.type)}function n(h,p){var x=h.split(/[\n\r]+/),m=-1,g=-1,y=0,T=0,v=[],R=[],D=null,b={},k=[],S=[],P=[],H=0,O;for(+p.codepage>=0&&Gt(+p.codepage);y!==x.length;++y){H=0;var C=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),W=C.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),q=W[0],Q;if(C.length>0)switch(q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":W[1].charAt(0)=="P"&&R.push(C.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,Z=!1,de=!1,U=!1,ue=-1,he=-1;for(T=1;T<W.length;++T)switch(W[T].charAt(0)){case"A":break;case"X":g=parseInt(W[T].slice(1))-1,Z=!0;break;case"Y":for(m=parseInt(W[T].slice(1))-1,Z||(g=0),O=v.length;O<=m;++O)v[O]=[];break;case"K":Q=W[T].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Kt(Q))?isNaN(pa(Q).getDate())||(Q=et(Q)):(Q=Kt(Q),D!==null&&ka(D)&&(Q=_n(Q))),ae=!0;break;case"E":U=!0;var j=da(W[T].slice(1),{r:m,c:g});v[m][g]=[v[m][g],j];break;case"S":de=!0,v[m][g]=[v[m][g],"S5S"];break;case"G":break;case"R":ue=parseInt(W[T].slice(1))-1;break;case"C":he=parseInt(W[T].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(ae&&(v[m][g]&&v[m][g].length==2?v[m][g][0]=Q:v[m][g]=Q,D=null),de){if(U)throw new Error("SYLK shared formula cannot have own formula");var V=ue>-1&&v[ue][he];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");v[m][g][1]=eh(V[1],{r:m-ue,c:g-he})}break;case"F":var I=0;for(T=1;T<W.length;++T)switch(W[T].charAt(0)){case"X":g=parseInt(W[T].slice(1))-1,++I;break;case"Y":for(m=parseInt(W[T].slice(1))-1,O=v.length;O<=m;++O)v[O]=[];break;case"M":H=parseInt(W[T].slice(1))/20;break;case"F":break;case"G":break;case"P":D=R[parseInt(W[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=W[T].slice(1).split(" "),O=parseInt(P[0],10);O<=parseInt(P[1],10);++O)H=parseInt(P[2],10),S[O-1]=H===0?{hidden:!0}:{wch:H},ga(S[O-1]);break;case"C":g=parseInt(W[T].slice(1))-1,S[g]||(S[g]={});break;case"R":m=parseInt(W[T].slice(1))-1,k[m]||(k[m]={}),H>0?(k[m].hpt=H,k[m].hpx=hs(H)):H===0&&(k[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}I<1&&(D=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return k.length>0&&(b["!rows"]=k),S.length>0&&(b["!cols"]=S),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,b]}function i(h,p){var x=s(h,p),m=x[0],g=x[1],y=Ta(m,p);return rr(g).forEach(function(T){y[T]=g[T]}),y}function o(h,p){return Pr(i(h,p),p)}function l(h,p,x,m){var g="C;Y"+(x+1)+";X"+(m+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+mb(h.f,{r:x,c:m}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,p){p.forEach(function(x,m){var g="F;W"+(m+1)+" "+(m+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=un(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=dn(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function f(h,p){p.forEach(function(x,m){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Qd(x.hpx)+";"),g.length>2&&h.push(g+"R"+(m+1))})}function d(h,p){var x=["ID;PWXL;N;E"],m=[],g=Be(h["!ref"]),y,T=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&f(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var R=g.s.r;R<=g.e.r;++R)for(var D=g.s.c;D<=g.e.c;++D){var b=pe({r:R,c:D});y=T?(h[R]||[])[D]:h[b],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,h,R,D))}return x.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:d}})(),Fw=(function(){function e(n,i){switch(i.type){case"base64":return t(Nt(n),i);case"binary":return t(n,i);case"buffer":return t(Te&&Buffer.isBuffer(n)?n.toString("binary"):Yr(n),i);case"array":return t($r(n),i)}throw new Error("Unrecognized type "+i.type)}function t(n,i){for(var o=n.split(`
`),l=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var h=o[f].trim().split(","),p=h[0],x=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][u]=!0:m==="FALSE"?d[l][u]=!1:isNaN(Kt(x))?isNaN(pa(x).getDate())?d[l][u]=x:d[l][u]=et(x):d[l][u]=Kt(x),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(n,i){return Ta(e(n,i),i)}function a(n,i){return Pr(r(n,i),i)}var s=(function(){var n=function(l,u,f,d,h){l.push(u),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=Be(l["!ref"]),d,h=Array.isArray(l);n(u,"TABLE",0,1,"sheetjs"),n(u,"VECTORS",0,f.e.r-f.s.r+1,""),n(u,"TUPLES",0,f.e.c-f.s.c+1,""),n(u,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(u,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var m=pe({r:p,c:x});if(d=h?(l[p]||[])[x]:l[m],!d){i(u,1,0,"");continue}switch(d.t){case"n":var g=d.w;!g&&d.v!=null&&(g=d.v),g==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Lt(d.z||ve[14],kt(et(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,T=u.join(y);return T}})();return{to_workbook:a,to_sheet:r,from_sheet:s}})(),jw=(function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),x=-1,m=-1,g=0,y=[];g!==p.length;++g){var T=p[g].trim().split(":");if(T[0]==="cell"){var v=yt(T[1]);if(y.length<=v.r)for(x=y.length;x<=v.r;++x)y[x]||(y[x]=[]);switch(x=v.r,m=v.c,T[2]){case"t":y[x][m]=e(T[3]);break;case"v":y[x][m]=+T[3];break;case"vtf":var R=T[T.length-1];case"vtc":switch(T[3]){case"nl":y[x][m]=!!+T[4];break;default:y[x][m]=+T[4];break}T[2]=="vtf"&&(y[x][m]=[y[x][m],R])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function a(d,h){return Ta(r(d,h),h)}function s(d,h){return Pr(a(d,h),h)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],x,m="",g=ba(d["!ref"]),y=Array.isArray(d),T=g.s.r;T<=g.e.r;++T)for(var v=g.s.c;v<=g.e.c;++v)if(m=pe({r:T,c:v}),x=y?(d[T]||[])[v]:d[m],!(!x||x.v==null||x.t==="z")){switch(p=["cell",m,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var R=kt(et(x.v));p[2]="vtc",p[3]="nd",p[4]=""+R,p[5]=x.w||Lt(x.z||ve[14],R);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[n,i,o,i,u(d),l].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:f}})(),us=(function(){function e(f,d,h,p,x){x.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Kt(f))?isNaN(pa(f).getDate())?d[h][p]=f:d[h][p]=et(f):d[h][p]=Kt(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var x=f.split(/[\r\n]/),m=x.length-1;m>=0&&x[m].length===0;)--m;for(var g=10,y=0,T=0;T<=m;++T)y=x[T].indexOf(" "),y==-1?y=x[T].length:y++,g=Math.max(g,y);for(T=0;T<=m;++T){p[T]=[];var v=0;for(e(x[T].slice(0,g).trim(),p,T,v,h),v=1;v<=(x[T].length-g)/10+1;++v)e(x[T].slice(g+(v-1)*10,g+v*10).trim(),p,T,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(f){for(var d={},h=!1,p=0,x=0;p<f.length;++p)(x=f.charCodeAt(p))==34?h=!h:!h&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p]);if(!x.length){d=a;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&x.push([d[p],p])}return x.sort(function(m,g){return m[0]-g[0]||a[m[1]]-a[g[1]]}),r[x.pop()[1]]||44}function n(f,d){var h=d||{},p="",x=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=s(f.slice(0,1024)):h&&h.FS?p=h.FS:p=s(f.slice(0,1024));var g=0,y=0,T=0,v=0,R=0,D=p.charCodeAt(0),b=!1,k=0,S=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?Hv(h.dateNF):null;function H(){var O=f.slice(v,R),C={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)C.t="z";else if(h.raw)C.t="s",C.v=O;else if(O.trim().length===0)C.t="s",C.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(C.t="s",C.v=O.slice(2,-1).replace(/""/g,'"')):gb(O)?(C.t="n",C.f=O.slice(1)):(C.t="s",C.v=O);else if(O=="TRUE")C.t="b",C.v=!0;else if(O=="FALSE")C.t="b",C.v=!1;else if(!isNaN(T=Kt(O)))C.t="n",h.cellText!==!1&&(C.w=O),C.v=T;else if(!isNaN(pa(O).getDate())||P&&O.match(P)){C.z=h.dateNF||ve[14];var W=0;P&&O.match(P)&&(O=Wv(O,h.dateNF,O.match(P)||[]),W=1),h.cellDates?(C.t="d",C.v=et(O,W)):(C.t="n",C.v=kt(et(O,W))),h.cellText!==!1&&(C.w=Lt(C.z,C.v instanceof Date?kt(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=O;if(C.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][y]=C):x[pe({c:y,r:g})]=C),v=R+1,S=f.charCodeAt(v),m.e.c<y&&(m.e.c=y),m.e.r<g&&(m.e.r=g),k==D)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;R<f.length;++R)switch(k=f.charCodeAt(R)){case 34:S===34&&(b=!b);break;case D:case 10:case 13:if(!b&&H())break e;break}return R-v>0&&H(),x["!ref"]=_e(m),x}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?n(f,d):Ta(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:Yo(f,d);switch(d.type){case"base64":h=Nt(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof os<"u"||(h=Te&&Buffer.isBuffer(f)?f.toString("binary"):Yr(f));break;case"array":h=$r(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=Fe(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=Fe(h):d.type=="binary"&&typeof os<"u",h.slice(0,19)=="socialcalc:version:"?jw.to_sheet(d.type=="string"?h:Fe(h),d):i(h,d)}function l(f,d){return Pr(o(f,d),d)}function u(f){for(var d=[],h=Be(f["!ref"]),p,x=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var g=[],y=h.s.c;y<=h.e.c;++y){var T=pe({r:m,c:y});if(p=x?(f[m]||[])[y]:f[T],!p||p.v==null){g.push("          ");continue}for(var v=(p.w||(pr(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(y===0?" ":""))}d.push(g.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}})();function Pw(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var s=Cw.to_workbook(e,r);return r.WTF=a,s}catch(n){if(r.WTF=a,!n.message.match(/SYLK bad record ID/)&&a)throw n;return us.to_workbook(e,t)}}var Ka=(function(){function e(j,V,I){if(j){rt(j,j.l||0);for(var B=I.Enum||ue;j.l<j.length;){var J=j.read_shift(2),ie=B[J]||B[65535],le=j.read_shift(2),se=j.l+le,te=ie.f&&ie.f(j,le,I);if(j.l=se,V(te,ie,J))return}}}function t(j,V){switch(V.type){case"base64":return r(zt(Nt(j)),V);case"binary":return r(zt(j),V);case"buffer":case"array":return r(j,V)}throw"Unsupported type "+V.type}function r(j,V){if(!j)return j;var I=V||{},B=I.dense?[]:{},J="Sheet1",ie="",le=0,se={},te=[],Se=[],M={s:{r:0,c:0},e:{r:0,c:0}},Ve=I.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)I.Enum=ue,e(j,function(oe,Ue,Ct){switch(Ct){case 0:I.vers=oe,oe>=4096&&(I.qpro=!0);break;case 6:M=oe;break;case 204:oe&&(ie=oe);break;case 222:ie=oe;break;case 15:case 51:I.qpro||(oe[1].v=oe[1].v.slice(1));case 13:case 14:case 16:Ct==14&&(oe[2]&112)==112&&(oe[2]&15)>1&&(oe[2]&15)<15&&(oe[1].z=I.dateNF||ve[14],I.cellDates&&(oe[1].t="d",oe[1].v=_n(oe[1].v))),I.qpro&&oe[3]>le&&(B["!ref"]=_e(M),se[J]=B,te.push(J),B=I.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},le=oe[3],J=ie||"Sheet"+(le+1),ie="");var Xt=I.dense?(B[oe[0].r]||[])[oe[0].c]:B[pe(oe[0])];if(Xt){Xt.t=oe[1].t,Xt.v=oe[1].v,oe[1].z!=null&&(Xt.z=oe[1].z),oe[1].f!=null&&(Xt.f=oe[1].f);break}I.dense?(B[oe[0].r]||(B[oe[0].r]=[]),B[oe[0].r][oe[0].c]=oe[1]):B[pe(oe[0])]=oe[1];break}},I);else if(j[2]==26||j[2]==14)I.Enum=he,j[2]==14&&(I.qpro=!0,j.l=0),e(j,function(oe,Ue,Ct){switch(Ct){case 204:J=oe;break;case 22:oe[1].v=oe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(oe[3]>le&&(B["!ref"]=_e(M),se[J]=B,te.push(J),B=I.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},le=oe[3],J="Sheet"+(le+1)),Ve>0&&oe[0].r>=Ve)break;I.dense?(B[oe[0].r]||(B[oe[0].r]=[]),B[oe[0].r][oe[0].c]=oe[1]):B[pe(oe[0])]=oe[1],M.e.c<oe[0].c&&(M.e.c=oe[0].c),M.e.r<oe[0].r&&(M.e.r=oe[0].r);break;case 27:oe[14e3]&&(Se[oe[14e3][0]]=oe[14e3][1]);break;case 1537:Se[oe[0]]=oe[1],oe[0]==le&&(J=oe[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(B["!ref"]=_e(M),se[ie||J]=B,te.push(ie||J),!Se.length)return{SheetNames:te,Sheets:se};for(var Ne={},Ce=[],be=0;be<Se.length;++be)se[te[be]]?(Ce.push(Se[be]||te[be]),Ne[Se[be]]=se[Se[be]]||se[te[be]]):(Ce.push(Se[be]),Ne[Se[be]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:Ne}}function a(j,V){var I=V||{};if(+I.codepage>=0&&Gt(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var B=ji(),J=Be(j["!ref"]),ie=Array.isArray(j),le=[];Ut(B,0,n(1030)),Ut(B,6,l(J));for(var se=Math.min(J.e.r,8191),te=J.s.r;te<=se;++te)for(var Se=st(te),M=J.s.c;M<=J.e.c;++M){te===J.s.r&&(le[M]=Qe(M));var Ve=le[M]+Se,Ne=ie?(j[te]||[])[M]:j[Ve];if(!(!Ne||Ne.t=="z"))if(Ne.t=="n")(Ne.v|0)==Ne.v&&Ne.v>=-32768&&Ne.v<=32767?Ut(B,13,p(te,M,Ne.v)):Ut(B,14,m(te,M,Ne.v));else{var Ce=pr(Ne);Ut(B,15,d(te,M,Ce.slice(0,239)))}}return Ut(B,1),B.end()}function s(j,V){var I=V||{};if(+I.codepage>=0&&Gt(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var B=ji();Ut(B,0,i(j));for(var J=0,ie=0;J<j.SheetNames.length;++J)(j.Sheets[j.SheetNames[J]]||{})["!ref"]&&Ut(B,27,U(j.SheetNames[J],ie++));var le=0;for(J=0;J<j.SheetNames.length;++J){var se=j.Sheets[j.SheetNames[J]];if(!(!se||!se["!ref"])){for(var te=Be(se["!ref"]),Se=Array.isArray(se),M=[],Ve=Math.min(te.e.r,8191),Ne=te.s.r;Ne<=Ve;++Ne)for(var Ce=st(Ne),be=te.s.c;be<=te.e.c;++be){Ne===te.s.r&&(M[be]=Qe(be));var oe=M[be]+Ce,Ue=Se?(se[Ne]||[])[be]:se[oe];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Ut(B,23,H(Ne,be,le,Ue.v));else{var Ct=pr(Ue);Ut(B,22,k(Ne,be,le,Ct.slice(0,239)))}}++le}}return Ut(B,1),B.end()}function n(j){var V=qe(2);return V.write_shift(2,j),V}function i(j){var V=qe(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var I=0,B=0,J=0,ie=0;ie<j.SheetNames.length;++ie){var le=j.SheetNames[ie],se=j.Sheets[le];if(!(!se||!se["!ref"])){++J;var te=ba(se["!ref"]);I<te.e.r&&(I=te.e.r),B<te.e.c&&(B=te.e.c)}}return I>8191&&(I=8191),V.write_shift(2,I),V.write_shift(1,J),V.write_shift(1,B),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(j,V,I){var B={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&I.qpro?(B.s.c=j.read_shift(1),j.l++,B.s.r=j.read_shift(2),B.e.c=j.read_shift(1),j.l++,B.e.r=j.read_shift(2),B):(B.s.c=j.read_shift(2),B.s.r=j.read_shift(2),V==12&&I.qpro&&(j.l+=2),B.e.c=j.read_shift(2),B.e.r=j.read_shift(2),V==12&&I.qpro&&(j.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(j){var V=qe(8);return V.write_shift(2,j.s.c),V.write_shift(2,j.s.r),V.write_shift(2,j.e.c),V.write_shift(2,j.e.r),V}function u(j,V,I){var B=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(B[0].c=j.read_shift(1),B[3]=j.read_shift(1),B[0].r=j.read_shift(2),j.l+=2):(B[2]=j.read_shift(1),B[0].c=j.read_shift(2),B[0].r=j.read_shift(2)),B}function f(j,V,I){var B=j.l+V,J=u(j,V,I);if(J[1].t="s",I.vers==20768){j.l++;var ie=j.read_shift(1);return J[1].v=j.read_shift(ie,"utf8"),J}return I.qpro&&j.l++,J[1].v=j.read_shift(B-j.l,"cstr"),J}function d(j,V,I){var B=qe(7+I.length);B.write_shift(1,255),B.write_shift(2,V),B.write_shift(2,j),B.write_shift(1,39);for(var J=0;J<B.length;++J){var ie=I.charCodeAt(J);B.write_shift(1,ie>=128?95:ie)}return B.write_shift(1,0),B}function h(j,V,I){var B=u(j,V,I);return B[1].v=j.read_shift(2,"i"),B}function p(j,V,I){var B=qe(7);return B.write_shift(1,255),B.write_shift(2,V),B.write_shift(2,j),B.write_shift(2,I,"i"),B}function x(j,V,I){var B=u(j,V,I);return B[1].v=j.read_shift(8,"f"),B}function m(j,V,I){var B=qe(13);return B.write_shift(1,255),B.write_shift(2,V),B.write_shift(2,j),B.write_shift(8,I,"f"),B}function g(j,V,I){var B=j.l+V,J=u(j,V,I);if(J[1].v=j.read_shift(8,"f"),I.qpro)j.l=B;else{var ie=j.read_shift(2);R(j.slice(j.l,j.l+ie),J),j.l+=ie}return J}function y(j,V,I){var B=V&32768;return V&=-32769,V=(B?j:0)+(V>=8192?V-16384:V),(B?"":"$")+(I?Qe(V):st(V))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function R(j,V){rt(j,0);for(var I=[],B=0,J="",ie="",le="",se="";j.l<j.length;){var te=j[j.l++];switch(te){case 0:I.push(j.read_shift(8,"f"));break;case 1:ie=y(V[0].c,j.read_shift(2),!0),J=y(V[0].r,j.read_shift(2),!1),I.push(ie+J);break;case 2:{var Se=y(V[0].c,j.read_shift(2),!0),M=y(V[0].r,j.read_shift(2),!1);ie=y(V[0].c,j.read_shift(2),!0),J=y(V[0].r,j.read_shift(2),!1),I.push(Se+M+":"+ie+J)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(j.read_shift(2));break;case 6:{for(var Ve="";te=j[j.l++];)Ve+=String.fromCharCode(te);I.push('"'+Ve.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:se=I.pop(),le=I.pop(),I.push(["AND","OR"][te-20]+"("+le+","+se+")");break;default:if(te<32&&v[te])se=I.pop(),le=I.pop(),I.push(le+v[te]+se);else if(T[te]){if(B=T[te][1],B==69&&(B=j[j.l++]),B>I.length){console.error("WK1 bad formula parse 0x"+te.toString(16)+":|"+I.join("|")+"|");return}var Ne=I.slice(-B);I.length-=B,I.push(T[te][0]+"("+Ne.join(",")+")")}else return te<=7?console.error("WK1 invalid opcode "+te.toString(16)):te<=24?console.error("WK1 unsupported op "+te.toString(16)):te<=30?console.error("WK1 invalid opcode "+te.toString(16)):te<=115?console.error("WK1 unsupported function opcode "+te.toString(16)):console.error("WK1 unrecognized opcode "+te.toString(16))}}I.length==1?V[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function D(j){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=j.read_shift(2),V[3]=j[j.l++],V[0].c=j[j.l++],V}function b(j,V){var I=D(j);return I[1].t="s",I[1].v=j.read_shift(V-4,"cstr"),I}function k(j,V,I,B){var J=qe(6+B.length);J.write_shift(2,j),J.write_shift(1,I),J.write_shift(1,V),J.write_shift(1,39);for(var ie=0;ie<B.length;++ie){var le=B.charCodeAt(ie);J.write_shift(1,le>=128?95:le)}return J.write_shift(1,0),J}function S(j,V){var I=D(j);I[1].v=j.read_shift(2);var B=I[1].v>>1;if(I[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return I[1].v=B,I}function P(j,V){var I=D(j),B=j.read_shift(4),J=j.read_shift(4),ie=j.read_shift(2);if(ie==65535)return B===0&&J===3221225472?(I[1].t="e",I[1].v=15):B===0&&J===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var le=ie&32768;return ie=(ie&32767)-16446,I[1].v=(1-le*2)*(J*Math.pow(2,ie+32)+B*Math.pow(2,ie)),I}function H(j,V,I,B){var J=qe(14);if(J.write_shift(2,j),J.write_shift(1,I),J.write_shift(1,V),B==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var ie=0,le=0,se=0,te=0;return B<0&&(ie=1,B=-B),le=Math.log2(B)|0,B/=Math.pow(2,le-31),te=B>>>0,(te&2147483648)==0&&(B/=2,++le,te=B>>>0),B-=te,te|=2147483648,te>>>=0,B*=Math.pow(2,32),se=B>>>0,J.write_shift(4,se),J.write_shift(4,te),le+=16383+(ie?32768:0),J.write_shift(2,le),J}function O(j,V){var I=P(j);return j.l+=V-14,I}function C(j,V){var I=D(j),B=j.read_shift(4);return I[1].v=B>>6,I}function W(j,V){var I=D(j),B=j.read_shift(8,"f");return I[1].v=B,I}function q(j,V){var I=W(j);return j.l+=V-10,I}function Q(j,V){return j[j.l+V-1]==0?j.read_shift(V,"cstr"):""}function ae(j,V){var I=j[j.l++];I>V-1&&(I=V-1);for(var B="";B.length<I;)B+=String.fromCharCode(j[j.l++]);return B}function Z(j,V,I){if(!(!I.qpro||V<21)){var B=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var J=j.read_shift(V-21,"cstr");return[B,J]}}function de(j,V){for(var I={},B=j.l+V;j.l<B;){var J=j.read_shift(2);if(J==14e3){for(I[J]=[0,""],I[J][0]=j.read_shift(2);j[j.l];)I[J][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return I}function U(j,V){var I=qe(5+j.length);I.write_shift(2,14e3),I.write_shift(2,V);for(var B=0;B<j.length;++B){var J=j.charCodeAt(B);I[I.l++]=J>127?95:J}return I[I.l++]=0,I}var ue={0:{n:"BOF",f:Ke},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},he={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:S},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:de},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:W},40:{n:"FORMULA28",f:q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Z},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:t}})();function Dw(e){var t={},r=e.match(ht),a=0,s=!1;if(r)for(;a!=r.length;++a){var n=me(r[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(n.val=="1")break;t.cp=_o[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=n.val;break;case"<sz":t.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(n.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(n.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":n.rgb&&(t.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+n[0])}}return t}var Rw=(function(){var e=ls("t"),t=ls("rPr");function r(n){var i=n.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Ae(i[1])},l=n.match(t);return l&&(o.s=Dw(l[1])),o}var a=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(a,"").split(s).map(r).filter(function(o){return o.v})}})(),Mw=(function(){var t=/(\r\n|\n)/g;function r(s,n,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),n.push('<span style="'+o.join("")+'">'),s.b&&(n.push("<b>"),i.push("</b>")),s.i&&(n.push("<i>"),i.push("</i>")),s.strike&&(n.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(n.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function a(s){var n=[[],s.v,[]];return s.v?(s.s&&r(s.s,n[0],n[2]),n[0].join("")+n[1].replace(t,"<br/>")+n[2].join("")):""}return function(n){return n.map(a).join("")}})(),Ow=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Iw=/<(?:\w+:)?r>/,Lw=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ho(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=Ae(Fe(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Fe(e),r&&(a.h=Po(a.t))):e.match(Iw)&&(a.r=Fe(e),a.t=Ae(Fe((e.replace(Lw,"").match(Ow)||[]).join("").replace(ht,""))),r&&(a.h=Mw(Rw(a.r)))),a):{t:""}}var Bw=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Vw=/<(?:\w+:)?(?:si|sstItem)>/g,Uw=/<\/(?:\w+:)?(?:si|sstItem)>/;function Hw(e,t){var r=[],a="";if(!e)return r;var s=e.match(Bw);if(s){a=s[2].replace(Vw,"").split(Uw);for(var n=0;n!=a.length;++n){var i=Ho(a[n].trim(),t);i!=null&&(r[r.length]=i)}s=me(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function Ww(e){return[e.read_shift(4),e.read_shift(4)]}function zw(e,t){var r=[],a=!1;return vr(e,function(n,i,o){switch(o){case 159:r.Count=n[0],r.Unique=n[1];break;case 19:r.push(n);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(i.T,!a||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Gd(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function dr(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Gw(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=dr(e,4),t.U=dr(e,4),t.W=dr(e,4),t}function $w(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},s=e.read_shift(4),n=[];s-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=n,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function Kw(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($w(e));return t}function Xw(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Yw(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=dr(e,4),t.U=dr(e,4),t.W=dr(e,4),t}function qw(e){var t=Yw(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function $d(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var s=!1;switch(a.AlgID){case 26126:case 26127:case 26128:s=a.Flags==36;break;case 26625:s=a.Flags==4;break;case 0:s=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function Kd(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function Qw(e){var t=dr(e);switch(t.Minor){case 2:return[t.Minor,Jw(e)];case 3:return[t.Minor,Zw()];case 4:return[t.Minor,ek(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Jw(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=$d(e,r),s=Kd(e,e.length-e.l);return{t:"Std",h:a,v:s}}function Zw(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ek(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(ht,function(n){var i=me(n);switch(ar(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){a[o]=i[o]});break;case"<dataIntegrity":a.encryptedHmacKey=i.encryptedHmacKey,a.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(i);break;default:throw i[0]}}),a}function tk(e,t){var r={},a=r.EncryptionVersionInfo=dr(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=$d(e,s),t-=s,r.EncryptionVerifier=Kd(e,t),r}function rk(e){var t={},r=t.EncryptionVersionInfo=dr(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ak(e){var t=0,r,a=Gd(e),s=a.length+1,n,i,o,l,u;for(r=Cr(s),r[0]=a.length,n=1;n!=s;++n)r[n]=a[n-1];for(n=s-1;n>=0;--n)i=r[n],o=(t&16384)===0?0:1,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var Xd=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(i){return(i/2|i*128)&255},s=function(i,o){return a(i^o)},n=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=Gd(i),l=n(o),u=o.length,f=Cr(16),d=0;d!=16;++d)f[d]=0;var h,p,x;for((u&1)===1&&(h=l>>8,f[u]=s(e[0],h),--u,h=l&255,p=o[o.length-1],f[u]=s(p,h));u>0;)--u,h=l>>8,f[u]=s(o[u],h),--u,h=l&255,f[u]=s(o[u],h);for(u=15,x=15-o.length;x>0;)h=l>>8,f[u]=s(e[x],h),--u,--x,h=l&255,f[u]=s(o[u],h),--u,--x;return f}})(),sk=function(e,t,r,a,s){s||(s=t),a||(a=Xd(e));var n,i;for(n=0;n!=t.length;++n)i=t[n],i^=a[r],i=(i>>5|i<<3)&255,s[n]=i,++r;return[s,r,a]},nk=function(e){var t=0,r=Xd(e);return function(a){var s=sk("",a,t,r);return t=s[1],s[0]}};function ik(e,t,r,a){var s={key:Ke(e),verificationBytes:Ke(e)};return r.password&&(s.verifier=ak(r.password)),a.valid=s.verificationBytes===s.verifier,a.valid&&(a.insitu=nk(r.password)),s}function ok(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=rk(e):a.Data=tk(e,t),a}function ck(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?ok(e,t-2,a):ik(e,r.biff>=8?t:t-2,r,a),a}var lk=(function(){function e(s,n){switch(n.type){case"base64":return t(Nt(s),n);case"binary":return t(s,n);case"buffer":return t(Te&&Buffer.isBuffer(s)?s.toString("binary"):Yr(s),n);case"array":return t($r(s),n)}throw new Error("Unrecognized type "+n.type)}function t(s,n){var i=n||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,x,m=-1;x=h.exec(f);){switch(x[0]){case"\\cell":var g=f.slice(p,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++m,g.length){var y={v:g,t:"s"};Array.isArray(o)?o[d][m]=y:o[pe({r:d,c:m})]=y}break}p=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=_e(u),o}function r(s,n){return Pr(e(s,n),n)}function a(s){for(var n=["{\\rtf1\\ansi"],i=Be(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){n.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)n.push("\\cellx"+(f+1));for(n.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=pe({r:u,c:f});o=l?(s[u]||[])[f]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(n.push(" "+(o.w||(pr(o),o.w))),n.push("\\cell"))}n.push("\\pard\\intbl\\row")}return n.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}})();function fk(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function ds(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function uk(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,s=Math.max(t,r,a),n=Math.min(t,r,a),i=s-n;if(i===0)return[0,0,t];var o=0,l=0,u=s+n;switch(l=i/(u>1?2-u:u),s){case t:o=((r-a)/i+6)%6;break;case r:o=(a-t)/i+2;break;case a:o=(t-r)/i+4;break}return[o/6,l,u/2]}function dk(e){var t=e[0],r=e[1],a=e[2],s=r*2*(a<.5?a:1-a),n=a-s/2,i=[n,n,n],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function fn(e,t){if(t===0)return e;var r=uk(fk(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),ds(dk(r))}var Yd=6,hk=15,xk=1,gt=Yd;function un(e){return Math.floor((e+Math.round(128/gt)/256)*gt)}function dn(e){return Math.floor((e-5)/gt*100+.5)/100}function Mi(e){return Math.round((e*gt+5)/gt*256)/256}function Jn(e){return Mi(dn(un(e)))}function Wo(e){var t=Math.abs(e-Jn(e)),r=gt;if(t>.005)for(gt=xk;gt<hk;++gt)Math.abs(e-Jn(e))<=t&&(t=Math.abs(e-Jn(e)),r=gt);gt=r}function ga(e){e.width?(e.wpx=un(e.width),e.wch=dn(e.wpx),e.MDW=gt):e.wpx?(e.wch=dn(e.wpx),e.width=Mi(e.wch),e.MDW=gt):typeof e.wch=="number"&&(e.width=Mi(e.wch),e.wpx=un(e.width),e.MDW=gt),e.customWidth&&delete e.customWidth}var mk=96,qd=mk;function Qd(e){return e*96/qd}function hs(e){return e*qd/96}var pk={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gk(e,t,r,a){t.Borders=[];var s={},n=!1;(e[0].match(ht)||[]).forEach(function(i){var o=me(i);switch(ar(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=je(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=je(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+o[0]+" in borders")}})}function vk(e,t,r,a){t.Fills=[];var s={},n=!1;(e[0].match(ht)||[]).forEach(function(i){var o=me(i);switch(ar(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fills")}})}function yk(e,t,r,a){t.Fonts=[];var s={},n=!1;(e[0].match(ht)||[]).forEach(function(i){var o=me(i);switch(ar(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Fe(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?je(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?je(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?je(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?je(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?je(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?je(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?je(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=_o[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=je(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=zr[s.color.index];s.color.index==81&&(l=zr[1]),l||(l=zr[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=fn(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+o[0]+" in fonts")}})}function wk(e,t,r){t.NumberFmt=[];for(var a=rr(ve),s=0;s<a.length;++s)t.NumberFmt[a[s]]=ve[a[s]];var n=e[0].match(ht);if(n)for(s=0;s<n.length;++s){var i=me(n[s]);switch(ar(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ae(Fe(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Wr(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Vs=["numFmtId","fillId","fontId","borderId","xfId"],Us=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function kk(e,t,r){t.CellXf=[];var a,s=!1;(e[0].match(ht)||[]).forEach(function(n){var i=me(n),o=0;switch(ar(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=i,delete a[0],o=0;o<Vs.length;++o)a[Vs[o]]&&(a[Vs[o]]=parseInt(a[Vs[o]],10));for(o=0;o<Us.length;++o)a[Us[o]]&&(a[Us[o]]=je(a[Us[o]]));if(t.NumberFmt&&a.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[o]){a.numFmtId=o;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=je(i.wrapText)),a.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var bk=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,n=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&wk(d,f,u),(d=o.match(s))&&yk(d,f,l,u),(d=o.match(a))&&vk(d,f,l,u),(d=o.match(n))&&gk(d,f,l,u),(d=o.match(r))&&kk(d,f,u),f}})();function Tk(e,t){var r=e.read_shift(2),a=ut(e);return[r,a]}function Ek(e,t,r){var a={};a.sz=e.read_shift(2)/20;var s=Ry(e);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var n=e.read_shift(2);switch(n===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(a.underline=i);var o=e.read_shift(1);o>0&&(a.family=o);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=Dy(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=ut(e),a}var _k=dt;function Sk(e,t){var r=e.l+t,a=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:s}}var Ak=dt;function Nk(e,t,r){var a={};a.NumberFmt=[];for(var s in ve)a.NumberFmt[s]=ve[s];a.CellXf=[],a.Fonts=[];var n=[],i=!1;return vr(e,function(l,u,f){switch(f){case 44:a.NumberFmt[l[0]]=l[1],Wr(l[1],l[0]);break;case 43:a.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=fn(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:n[n.length-1]==617&&a.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:n.push(f),i=!0;break;case 38:n.pop(),i=!1;break;default:if(u.T>0)n.push(f);else if(u.T<0)n.pop();else if(!i||r.WTF&&n[n.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),a}var Ck=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Fk(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(ht)||[]).forEach(function(s){var n=me(s);switch(n[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=n.val;break;case"<a:sysClr":a.rgb=n.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":n[0].charAt(1)==="/"?(t.themeElements.clrScheme[Ck.indexOf(n[0])]=a,a={}):a.name=n[0].slice(3,n[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+n[0]+" in clrScheme")}})}function jk(){}function Pk(){}var Dk=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Rk=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Mk=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ok(e,t,r){t.themeElements={};var a;[["clrScheme",Dk,Fk],["fontScheme",Rk,jk],["fmtScheme",Mk,Pk]].forEach(function(s){if(!(a=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](a,t,r)})}var Ik=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Jd(e,t){(!e||e.length===0)&&(e=Lk());var r,a={};if(!(r=e.match(Ik)))throw new Error("themeElements not found in theme");return Ok(r[0],a,t),a.raw=e,a}function Lk(e,t){var r=[ld];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Bk(e,t,r){var a=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=a;return}var n=e.slice(e.l);e.l=a;var i;try{i=cd(n,{type:"array"})}catch{return}var o=At(i,"theme/theme/theme1.xml",!0);if(o)return Jd(o,r)}}function Vk(e){return e.read_shift(4)}function Uk(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Hk(e,4);break;case 2:t.xclrValue=Ld(e);break;case 3:t.xclrValue=Vk(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Hk(e,t){return dt(e,t)}function Wk(e,t){return dt(e,t)}function zk(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Uk(e);break;case 6:a[1]=Wk(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function Gk(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),n=[];s-- >0;)n.push(zk(e,r-e.l));return{ixfe:a,ext:n}}function $k(e,t){t.forEach(function(r){r[0]})}function Kk(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ut(e)}}function Xk(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Yk(e){return e.l+=4,e.read_shift(4)!=0}function qk(e,t,r){var a={Types:[],Cell:[],Value:[]},s=r||{},n=[],i=!1,o=2;return vr(e,function(l,u,f){switch(f){case 335:a.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?a.Cell.push({type:a.Types[d[0]-1].name,index:d[1]}):o==0&&a.Value.push({type:a.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:n.push(f),i=!0;break;case 36:n.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),a}function Qk(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var s=!1,n=2,i;return e.replace(ht,function(o){var l=me(o);switch(ar(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<a.Types.length;++u)a.Types[u].name==l.name&&(i=a.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":n==1?a.Cell.push({type:a.Types[l.t-1].name,index:+l.v}):n==0&&a.Value.push({type:a.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":n=1;break;case"</cellMetadata>":n=2;break;case"<valueMetadata":n=0;break;case"</valueMetadata>":n=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),a}function Jk(e){var t=[];if(!e)return t;var r=1;return(e.match(ht)||[]).forEach(function(a){var s=me(a);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Zk(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=pe(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function eb(e,t,r){var a=[];return vr(e,function(n,i,o){switch(o){case 63:a.push(n);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),a}function tb(e,t,r,a){if(!e)return e;var s=a||{},n=!1;vr(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(!l.T){if(!n||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function rb(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function kl(e,t,r,a){var s=Array.isArray(e),n;t.forEach(function(i){var o=yt(i.ref);if(s?(e[o.r]||(e[o.r]=[]),n=e[o.r][o.c]):n=e[i.ref],!n){n={t:"z"},s?e[o.r][o.c]=n:e[i.ref]=n;var l=Be(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=_e(l);u!==e["!ref"]&&(e["!ref"]=u)}n.c||(n.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=n.c.length-1;d>=0;--d){if(!r&&n.c[d].T)return;r&&!n.c[d].T&&n.c.splice(d,1)}if(r&&a){for(d=0;d<a.length;++d)if(f.a==a[d].id){f.a=a[d].name||f.a;break}}n.c.push(f)})}function ab(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=me(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=yt(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Ho(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),a.push(u)}}}}),a}function sb(e,t){var r=[],a=!1,s={},n=0;return e.replace(ht,function(o,l){var u=me(o);switch(ar(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":n=l+o.length;break;case"</text>":s.t=e.slice(n,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function nb(e,t){var r=[],a=!1;return e.replace(ht,function(n){var i=me(n);switch(ar(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return n}),r}function ib(e){var t={};t.iauthor=e.read_shift(4);var r=Qr(e);return t.rfx=r.s,t.ref=pe(r.s),e.l+=16,t}var ob=ut;function cb(e,t){var r=[],a=[],s={},n=!1;return vr(e,function(o,l,u){switch(u){case 632:a.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=a[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:n=!0;break;case 36:n=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!n||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var lb="application/vnd.ms-office.vbaProject";function fb(e){var t=Ee.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ee.utils.cfb_add(t,s,e.FileIndex[a].content)}}),Ee.write(t)}function ub(){return{"!type":"dialog"}}function db(){return{"!type":"dialog"}}function hb(){return{"!type":"macro"}}function xb(){return{"!type":"macro"}}var da=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,s,n,i){var o=!1,l=!1;n.length==0?l=!0:n.charAt(0)=="["&&(l=!0,n=n.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=n.length>0?parseInt(n,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,s+(o?"":"$")+Qe(f)+(l?"":"$")+st(u)}return function(s,n){return t=n,s.replace(e,r)}})(),Zd=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,mb=(function(){return function(t,r){return t.replace(Zd,function(a,s,n,i,o,l){var u=Oo(i)-(n?0:r.c),f=Mo(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":n?u+1:"["+u+"]";return s+"R"+d+"C"+h})}})();function eh(e,t){return e.replace(Zd,function(r,a,s,n,i,o){return a+(s=="$"?s+n:Qe(Oo(n)+t.c))+(i=="$"?i+o:st(Mo(o)+t.r))})}function pb(e,t,r){var a=ba(t),s=a.s,n=yt(r),i={r:n.r-s.r,c:n.c-s.c};return eh(e,i)}function gb(e){return e.length!=1}function bl(e){return e.replace(/_xlfn\./g,"")}function Ge(e){e.l+=1}function Fr(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function th(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return rh(e);r.biff==12&&(a=4)}var s=e.read_shift(a),n=e.read_shift(a),i=Fr(e),o=Fr(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function rh(e){var t=Fr(e),r=Fr(e),a=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function vb(e,t,r){if(r.biff<8)return rh(e);var a=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),n=Fr(e),i=Fr(e);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function ah(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return yb(e);var a=e.read_shift(r&&r.biff==12?4:2),s=Fr(e);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function yb(e){var t=Fr(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function wb(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function kb(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return bb(e);var s=e.read_shift(a>=12?4:2),n=e.read_shift(2),i=(n&16384)>>14,o=(n&32768)>>15;if(n&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;n>8191;)n=n-16384;return{r:s,c:n,cRel:i,rRel:o}}function bb(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:a}}function Tb(e,t,r){var a=(e[e.l++]&96)>>5,s=th(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,s]}function Eb(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}var i=th(e,n,r);return[a,s,i]}function _b(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function Sb(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=8;if(r)switch(r.biff){case 5:e.l+=12,n=6;break;case 12:n=12;break}return e.l+=n,[a,s]}function Ab(e,t,r){var a=(e[e.l++]&96)>>5,s=vb(e,t-1,r);return[a,s]}function Nb(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function Tl(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Cb(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),s=[],n=0;n<=a;++n)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Fb(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function jb(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function Pb(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Db(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function sh(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Rb(e){return e.read_shift(2),sh(e)}function Mb(e){return e.read_shift(2),sh(e)}function Ob(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=ah(e,0,r);return[a,s]}function Ib(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=kb(e,0,r);return[a,s]}function Lb(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var n=ah(e,0,r);return[a,s,n]}function Bb(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[V3[s],oh[s],a]}function Vb(e,t,r){var a=e[e.l++],s=e.read_shift(1),n=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Ub(e);return[s,(n[0]===0?oh:B3)[n[1]]]}function Ub(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hb(e,t,r){e.l+=r&&r.biff==2?3:4}function Wb(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function zb(e){return e.l++,Jr[e.read_shift(1)]}function Gb(e){return e.l++,e.read_shift(2)}function $b(e){return e.l++,e.read_shift(1)!==0}function Kb(e){return e.l++,ct(e)}function Xb(e,t,r){return e.l++,bs(e,t-1,r)}function Yb(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=We(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Jr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ct(e);break;case 2:r[1]=Zr(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function qb(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),s=[],n=0;n!=a;++n)s.push((r.biff==12?Qr:Sn)(e));return s}function Qb(e,t,r){var a=0,s=0;r.biff==12?(a=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--s==0&&(s=256));for(var n=0,i=[];n!=a&&(i[n]=[]);++n)for(var o=0;o!=s;++o)i[n][o]=Yb(e,r.biff);return i}function Jb(e,t,r){var a=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,n=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,n]}function Zb(e,t,r){if(r.biff==5)return e3(e);var a=e.read_shift(1)>>>5&3,s=e.read_shift(2),n=e.read_shift(4);return[a,s,n]}function e3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function t3(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function r3(e,t,r){var a=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[a,s]}function a3(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function s3(e,t,r){var a=(e[e.l++]&96)>>5,s=e.read_shift(2),n=4;if(r)switch(r.biff){case 5:n=15;break;case 12:n=6;break}return e.l+=n,[a,s]}var n3=dt,i3=dt,o3=dt;function Es(e,t,r){return e.l+=2,[wb(e)]}function zo(e){return e.l+=6,[]}var c3=Es,l3=zo,f3=zo,u3=Es;function nh(e){return e.l+=2,[Ke(e),e.read_shift(2)&1]}var d3=Es,h3=nh,x3=zo,m3=Es,p3=Es,g3=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function v3(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),s=e.read_shift(2),n=e.read_shift(2),i=g3[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:a,c:s,C:n}}function y3(e){return e.l+=2,[e.read_shift(4)]}function w3(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function k3(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function b3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function T3(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function E3(e){return e.l+=4,[0,0]}var El={1:{n:"PtgExp",f:Wb},2:{n:"PtgTbl",f:o3},3:{n:"PtgAdd",f:Ge},4:{n:"PtgSub",f:Ge},5:{n:"PtgMul",f:Ge},6:{n:"PtgDiv",f:Ge},7:{n:"PtgPower",f:Ge},8:{n:"PtgConcat",f:Ge},9:{n:"PtgLt",f:Ge},10:{n:"PtgLe",f:Ge},11:{n:"PtgEq",f:Ge},12:{n:"PtgGe",f:Ge},13:{n:"PtgGt",f:Ge},14:{n:"PtgNe",f:Ge},15:{n:"PtgIsect",f:Ge},16:{n:"PtgUnion",f:Ge},17:{n:"PtgRange",f:Ge},18:{n:"PtgUplus",f:Ge},19:{n:"PtgUminus",f:Ge},20:{n:"PtgPercent",f:Ge},21:{n:"PtgParen",f:Ge},22:{n:"PtgMissArg",f:Ge},23:{n:"PtgStr",f:Xb},26:{n:"PtgSheet",f:w3},27:{n:"PtgEndSheet",f:k3},28:{n:"PtgErr",f:zb},29:{n:"PtgBool",f:$b},30:{n:"PtgInt",f:Gb},31:{n:"PtgNum",f:Kb},32:{n:"PtgArray",f:Nb},33:{n:"PtgFunc",f:Bb},34:{n:"PtgFuncVar",f:Vb},35:{n:"PtgName",f:Jb},36:{n:"PtgRef",f:Ob},37:{n:"PtgArea",f:Tb},38:{n:"PtgMemArea",f:t3},39:{n:"PtgMemErr",f:n3},40:{n:"PtgMemNoMem",f:i3},41:{n:"PtgMemFunc",f:r3},42:{n:"PtgRefErr",f:a3},43:{n:"PtgAreaErr",f:_b},44:{n:"PtgRefN",f:Ib},45:{n:"PtgAreaN",f:Ab},46:{n:"PtgMemAreaN",f:b3},47:{n:"PtgMemNoMemN",f:T3},57:{n:"PtgNameX",f:Zb},58:{n:"PtgRef3d",f:Lb},59:{n:"PtgArea3d",f:Eb},60:{n:"PtgRefErr3d",f:s3},61:{n:"PtgAreaErr3d",f:Sb},255:{}},_3={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},S3={1:{n:"PtgElfLel",f:nh},2:{n:"PtgElfRw",f:m3},3:{n:"PtgElfCol",f:c3},6:{n:"PtgElfRwV",f:p3},7:{n:"PtgElfColV",f:u3},10:{n:"PtgElfRadical",f:d3},11:{n:"PtgElfRadicalS",f:x3},13:{n:"PtgElfColS",f:l3},15:{n:"PtgElfColSV",f:f3},16:{n:"PtgElfRadicalLel",f:h3},25:{n:"PtgList",f:v3},29:{n:"PtgSxName",f:y3},255:{}},A3={0:{n:"PtgAttrNoop",f:E3},1:{n:"PtgAttrSemi",f:Db},2:{n:"PtgAttrIf",f:jb},4:{n:"PtgAttrChoose",f:Cb},8:{n:"PtgAttrGoto",f:Fb},16:{n:"PtgAttrSum",f:Hb},32:{n:"PtgAttrBaxcel",f:Tl},33:{n:"PtgAttrBaxcel",f:Tl},64:{n:"PtgAttrSpace",f:Rb},65:{n:"PtgAttrSpaceSemi",f:Mb},128:{n:"PtgAttrIfError",f:Pb},255:{}};function _s(e,t,r,a){if(a.biff<8)return dt(e,t);for(var s=e.l+t,n=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Qb(e,0,a),n.push(r[i][1]);break;case"PtgMemArea":r[i][2]=qb(e,r[i][1],a),n.push(r[i][2]);break;case"PtgExp":a&&a.biff==12&&(r[i][1][1]=e.read_shift(4),n.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&n.push(dt(e,t)),n}function Ss(e,t,r){for(var a=e.l+t,s,n,i=[];a!=e.l;)t=a-e.l,n=e[e.l],s=El[n]||El[_3[n]],(n===24||n===25)&&(s=(n===24?S3:A3)[e[e.l+1]]),!s||!s.f?dt(e,t):i.push([s.n,s.f(e,t,r)]);return i}function N3(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],s=[],n=0;n<a.length;++n){var i=a[n];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var C3={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function F3(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function ih(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[a[0]][0]){case 357:return s=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(n){return n.Name}).join(";;");default:return e[a[0]][0][3]?(s=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function _l(e,t,r){var a=ih(e,t,r);return a=="#REF"?a:F3(a,r)}function ot(e,t,r,a,s){var n=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,f,d=0,h=0,p,x="";if(!e[0]||!e[0][0])return"";for(var m=-1,g="",y=0,T=e[0].length;y<T;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:g=Le(" ",e[0][m][1][1]);break;case 1:g=Le("\r",e[0][m][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+g,m=-1}o.push(u+C3[v[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Wa(v[1][1],i,s),o.push(za(f,n));break;case"PtgRefN":f=r?Wa(v[1][1],r,s):v[1][1],o.push(za(f,n));break;case"PtgRef3d":d=v[1][1],f=Wa(v[1][2],i,s),x=_l(a,d,s),o.push(x+"!"+za(f,n));break;case"PtgFunc":case"PtgFuncVar":var R=v[1][0],D=v[1][1];R||(R=0),R&=127;var b=R==0?[]:o.slice(-R);o.length-=R,D==="User"&&(D=b.shift()),o.push(D+"("+b.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":p=nl(v[1][1],r?{s:r}:i,s),o.push(qn(p,s));break;case"PtgArea":p=nl(v[1][1],i,s),o.push(qn(p,s));break;case"PtgArea3d":d=v[1][1],p=v[1][2],x=_l(a,d,s),o.push(x+"!"+qn(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var k=(a.names||[])[h-1]||(a[0]||[])[h],S=k?k.Name:"SH33TJSNAME"+String(h);S&&S.slice(0,6)=="_xlfn."&&!s.xlfn&&(S=S.slice(6)),o.push(S);break;case"PtgNameX":var P=v[1][1];h=v[1][2];var H;if(s.biff<=5)P<0&&(P=-P),a[P]&&(H=a[P][h]);else{var O="";if(((a[P]||[])[0]||[])[0]==14849||(((a[P]||[])[0]||[])[0]==1025?a[P][h]&&a[P][h].itab>0&&(O=a.SheetNames[a[P][h].itab-1]+"!"):O=a.SheetNames[h-1]+"!"),a[P]&&a[P][h])O+=a[P][h].Name;else if(a[0]&&a[0][h])O+=a[0][h].Name;else{var C=(ih(a,P,s)||"").split(";;");C[h-1]?O=C[h-1]:O+="SH33TJSERRX"}o.push(O);break}H||(H={Name:"SH33TJSERRY"}),o.push(H.Name);break;case"PtgParen":var W="(",q=")";if(m>=0){switch(g="",e[0][m][1][0]){case 2:W=Le(" ",e[0][m][1][1])+W;break;case 3:W=Le("\r",e[0][m][1][1])+W;break;case 4:q=Le(" ",e[0][m][1][1])+q;break;case 5:q=Le("\r",e[0][m][1][1])+q;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(W+o.pop()+q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var Q={c:r.c,r:r.r};if(a.sharedf[pe(f)]){var ae=a.sharedf[pe(f)];o.push(ot(ae,i,Q,a,s))}else{var Z=!1;for(l=0;l!=a.arrayf.length;++l)if(u=a.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ot(u[1],i,Q,a,s)),Z=!0;break}Z||o.push(v[1])}break;case"PtgArray":o.push("{"+N3(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&de.indexOf(e[0][y][0])==-1){v=e[0][m];var U=!0;switch(v[1][0]){case 4:U=!1;case 0:g=Le(" ",v[1][1]);break;case 5:U=!1;case 1:g=Le("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((U?g:"")+o.pop()+(U?"":g)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function j3(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,i=e.read_shift(s);if(i==65535)return[[],dt(e,t-2)];var o=Ss(e,i,r);return t!==i+s&&(n=_s(e,t-i-s,o,r)),e.l=a,[o,n]}function P3(e,t,r){var a=e.l+t,s=r.biff==2?1:2,n,i=e.read_shift(s);if(i==65535)return[[],dt(e,t-2)];var o=Ss(e,i,r);return t!==i+s&&(n=_s(e,t-i-s,o,r)),e.l=a,[o,n]}function D3(e,t,r,a){var s=e.l+t,n=Ss(e,a,r),i;return s!==e.l&&(i=_s(e,s-e.l,n,r)),[n,i]}function R3(e,t,r){var a=e.l+t,s,n=e.read_shift(2),i=Ss(e,n,r);return n==65535?[[],dt(e,t-2)]:(t!==n+2&&(s=_s(e,a-n-2,i,r)),[i,s])}function M3(e){var t;if(lr(e,e.l+6)!==65535)return[ct(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Zn(e,t,r){var a=e.l+t,s=sr(e);r.biff==2&&++e.l;var n=M3(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=P3(e,a-e.l,r);return{cell:s,val:n[0],formula:o,shared:i>>3&1,tt:n[1]}}function An(e,t,r){var a=e.read_shift(4),s=Ss(e,a,r),n=e.read_shift(4),i=n>0?_s(e,n,s,r):null;return[s,i]}var O3=An,Nn=An,I3=An,L3=An,B3={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oh={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},V3={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Sl(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function ei(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var Xa={},ha={};function Ya(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function ch(e,t,r,a,s,n){try{a.cellNF&&(e.z=ve[t])}catch(o){if(a.WTF)throw o}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=et(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(ve[t]==null&&Wr(Uv[t]||"General",t),e.t==="e")e.w=e.w||Jr[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cs(e.v);else if(e.t==="d"){var i=kt(e.v);(i|0)===i?e.w=i.toString(10):e.w=cs(i)}else{if(e.v===void 0)return"";e.w=Gr(e.v,ha)}else e.t==="d"?e.w=Lt(t,kt(e.v),ha):e.w=Lt(t,e.v,ha)}catch(o){if(a.WTF)throw o}if(a.cellStyles&&r!=null)try{e.s=n.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=fn(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=fn(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(a.WTF&&n.Fills)throw o}}}function U3(e,t){var r=Be(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=_e(r))}var H3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,W3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,z3=/<(?:\w:)?hyperlink [^>]*>/mg,G3=/"(\w*:\w*)"/,$3=/<(?:\w:)?col\b[^>]*[\/]?>/g,K3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,X3=/<(?:\w:)?pageMargins[^>]*\/>/g,lh=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Y3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,q3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Q3(e,t,r,a,s,n,i){if(!e)return e;a||(a={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(W3);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(lh);h?Go(h[0],o,s,r):(h=u.match(Y3))&&J3(h[0],h[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(G3);x&&U3(o,x[1])}var m=u.match(q3);m&&m[1]&&sT(m[1],s);var g=[];if(t.cellStyles){var y=u.match($3);y&&tT(g,y)}d&&nT(d[1],o,t,l,n,i);var T=f.match(K3);T&&(o["!autofilter"]=rT(T[0]));var v=[],R=f.match(H3);if(R)for(p=0;p!=R.length;++p)v[p]=Be(R[p].slice(R[p].indexOf('"')+1));var D=f.match(z3);D&&Z3(o,D,a);var b=f.match(X3);if(b&&(o["!margins"]=eT(me(b[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=_e(l)),t.sheetRows>0&&o["!ref"]){var k=Be(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=_e(k))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function Go(e,t,r,a){var s=me(e);r.Sheets[a]||(r.Sheets[a]={}),s.codeName&&(r.Sheets[a].CodeName=Ae(Fe(s.codeName)))}function J3(e,t,r,a,s){Go(e.slice(0,e.indexOf(">")),r,a,s)}function Z3(e,t,r){for(var a=Array.isArray(e),s=0;s!=t.length;++s){var n=me(Fe(t[s]),!0);if(!n.ref)return;var i=((r||{})["!id"]||[])[n.id];i?(n.Target=i.Target,n.location&&(n.Target+="#"+Ae(n.location))):(n.Target="#"+Ae(n.location),i={Target:n.Target,TargetMode:"Internal"}),n.Rel=i,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var o=Be(n.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=pe({c:u,r:l});a?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=n):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=n)}}}function eT(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function tT(e,t){for(var r=!1,a=0;a!=t.length;++a){var s=me(t[a],!0);s.hidden&&(s.hidden=je(s.hidden));var n=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,Wo(s.width)),ga(s);n<=i;)e[n++]=at(s)}}function rT(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var aT=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function sT(e,t){t.Views||(t.Views=[{}]),(e.match(aT)||[]).forEach(function(r,a){var s=me(r);t.Views[a]||(t.Views[a]={}),+s.zoomScale&&(t.Views[a].zoom=+s.zoomScale),je(s.rightToLeft)&&(t.Views[a].RTL=!0)})}var nT=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,n=ls("v"),i=ls("f");return function(l,u,f,d,h,p){for(var x=0,m="",g=[],y=[],T=0,v=0,R=0,D="",b,k,S=0,P=0,H,O,C=0,W=0,q=Array.isArray(p.CellXf),Q,ae=[],Z=[],de=Array.isArray(u),U=[],ue={},he=!1,j=!!f.sheetStubs,V=l.split(t),I=0,B=V.length;I!=B;++I){m=V[I].trim();var J=m.length;if(J!==0){var ie=0;e:for(x=0;x<J;++x)switch(m[x]){case">":if(m[x-1]!="/"){++x;break e}if(f&&f.cellStyles){if(k=me(m.slice(ie,x),!0),S=k.r!=null?parseInt(k.r,10):S+1,P=-1,f.sheetRows&&f.sheetRows<S)continue;ue={},he=!1,k.ht&&(he=!0,ue.hpt=parseFloat(k.ht),ue.hpx=hs(ue.hpt)),k.hidden=="1"&&(he=!0,ue.hidden=!0),k.outlineLevel!=null&&(he=!0,ue.level=+k.outlineLevel),he&&(U[S-1]=ue)}break;case"<":ie=x;break}if(ie>=x)break;if(k=me(m.slice(ie,x),!0),S=k.r!=null?parseInt(k.r,10):S+1,P=-1,!(f.sheetRows&&f.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),f&&f.cellStyles&&(ue={},he=!1,k.ht&&(he=!0,ue.hpt=parseFloat(k.ht),ue.hpx=hs(ue.hpt)),k.hidden=="1"&&(he=!0,ue.hidden=!0),k.outlineLevel!=null&&(he=!0,ue.level=+k.outlineLevel),he&&(U[S-1]=ue)),g=m.slice(x).split(e);for(var le=0;le!=g.length&&g[le].trim().charAt(0)=="<";++le);for(g=g.slice(le),x=0;x!=g.length;++x)if(m=g[x].trim(),m.length!==0){if(y=m.match(r),T=x,v=0,R=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(T=0,D=y[1],v=0;v!=D.length&&!((R=D.charCodeAt(v)-64)<1||R>26);++v)T=26*T+R;--T,P=T}else++P;for(v=0;v!=m.length&&m.charCodeAt(v)!==62;++v);if(++v,k=me(m.slice(0,v),!0),k.r||(k.r=pe({r:S-1,c:P})),D=m.slice(v),b={t:""},(y=D.match(n))!=null&&y[1]!==""&&(b.v=Ae(y[1])),f.cellFormula){if((y=D.match(i))!=null&&y[1]!==""){if(b.f=Ae(Fe(y[1])).replace(/\r\n/g,`
`),f.xlfn||(b.f=bl(b.f)),y[0].indexOf('t="array"')>-1)b.F=(D.match(s)||[])[1],b.F.indexOf(":")>-1&&ae.push([Be(b.F),b.F]);else if(y[0].indexOf('t="shared"')>-1){O=me(y[0]);var se=Ae(Fe(y[1]));f.xlfn||(se=bl(se)),Z[parseInt(O.si,10)]=[O,se,k.r]}}else(y=D.match(/<f[^>]*\/>/))&&(O=me(y[0]),Z[O.si]&&(b.f=pb(Z[O.si][1],Z[O.si][2],k.r)));var te=yt(k.r);for(v=0;v<ae.length;++v)te.r>=ae[v][0].s.r&&te.r<=ae[v][0].e.r&&te.c>=ae[v][0].s.c&&te.c<=ae[v][0].e.c&&(b.F=ae[v][1])}if(k.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(j)b.t="z";else continue;else b.t=k.t||"n";switch(d.s.c>P&&(d.s.c=P),d.e.c<P&&(d.e.c=P),b.t){case"n":if(b.v==""||b.v==null){if(!j)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!j)continue;b.t="z"}else H=Xa[parseInt(b.v,10)],b.v=H.t,b.r=H.r,f.cellHTML&&(b.h=H.h);break;case"str":b.t="s",b.v=b.v!=null?Fe(b.v):"",f.cellHTML&&(b.h=Po(b.v));break;case"inlineStr":y=D.match(a),b.t="s",y!=null&&(H=Ho(y[1]))?(b.v=H.t,f.cellHTML&&(b.h=H.h)):b.v="";break;case"b":b.v=je(b.v);break;case"d":f.cellDates?b.v=et(b.v,1):(b.v=kt(et(b.v,1)),b.t="n");break;case"e":(!f||f.cellText!==!1)&&(b.w=b.v),b.v=Fd[b.v];break}if(C=W=0,Q=null,q&&k.s!==void 0&&(Q=p.CellXf[k.s],Q!=null&&(Q.numFmtId!=null&&(C=Q.numFmtId),f.cellStyles&&Q.fillId!=null&&(W=Q.fillId))),ch(b,C,W,f,h,p),f.cellDates&&q&&b.t=="n"&&ka(ve[C])&&(b.t="d",b.v=_n(b.v)),k.cm&&f.xlmeta){var Se=(f.xlmeta.Cell||[])[+k.cm-1];Se&&Se.type=="XLDAPR"&&(b.D=!0)}if(de){var M=yt(k.r);u[M.r]||(u[M.r]=[]),u[M.r][M.c]=b}else u[k.r]=b}}}}U.length>0&&(u["!rows"]=U)}})();function iT(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,n&7&&(r.level=n&7),n&16&&(r.hidden=!0),n&32&&(r.hpt=s/20),r}var oT=Qr;function cT(){}function lT(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=jy(e),r}function fT(e){var t=Bt(e);return[t]}function uT(e){var t=qr(e);return[t]}function dT(e){var t=Bt(e),r=e.read_shift(1);return[t,r,"b"]}function hT(e){var t=qr(e),r=e.read_shift(1);return[t,r,"b"]}function xT(e){var t=Bt(e),r=e.read_shift(1);return[t,r,"e"]}function mT(e){var t=qr(e),r=e.read_shift(1);return[t,r,"e"]}function pT(e){var t=Bt(e),r=e.read_shift(4);return[t,r,"s"]}function gT(e){var t=qr(e),r=e.read_shift(4);return[t,r,"s"]}function vT(e){var t=Bt(e),r=ct(e);return[t,r,"n"]}function fh(e){var t=qr(e),r=ct(e);return[t,r,"n"]}function yT(e){var t=Bt(e),r=Bo(e);return[t,r,"n"]}function wT(e){var t=qr(e),r=Bo(e);return[t,r,"n"]}function kT(e){var t=Bt(e),r=Io(e);return[t,r,"is"]}function bT(e){var t=Bt(e),r=ut(e);return[t,r,"str"]}function TT(e){var t=qr(e),r=ut(e);return[t,r,"str"]}function ET(e,t,r){var a=e.l+t,s=Bt(e);s.r=r["!row"];var n=e.read_shift(1),i=[s,n,"b"];if(r.cellFormula){e.l+=2;var o=Nn(e,a-e.l,r);i[3]=ot(o,null,s,r.supbooks,r)}else e.l=a;return i}function _T(e,t,r){var a=e.l+t,s=Bt(e);s.r=r["!row"];var n=e.read_shift(1),i=[s,n,"e"];if(r.cellFormula){e.l+=2;var o=Nn(e,a-e.l,r);i[3]=ot(o,null,s,r.supbooks,r)}else e.l=a;return i}function ST(e,t,r){var a=e.l+t,s=Bt(e);s.r=r["!row"];var n=ct(e),i=[s,n,"n"];if(r.cellFormula){e.l+=2;var o=Nn(e,a-e.l,r);i[3]=ot(o,null,s,r.supbooks,r)}else e.l=a;return i}function AT(e,t,r){var a=e.l+t,s=Bt(e);s.r=r["!row"];var n=ut(e),i=[s,n,"str"];if(r.cellFormula){e.l+=2;var o=Nn(e,a-e.l,r);i[3]=ot(o,null,s,r.supbooks,r)}else e.l=a;return i}var NT=Qr;function CT(e,t){var r=e.l+t,a=Qr(e),s=Lo(e),n=ut(e),i=ut(e),o=ut(e);e.l=r;var l={rfx:a,relId:s,loc:n,display:o};return i&&(l.Tooltip=i),l}function FT(){}function jT(e,t,r){var a=e.l+t,s=Ad(e),n=e.read_shift(1),i=[s];if(i[2]=n,r.cellFormula){var o=O3(e,a-e.l,r);i[1]=o}else e.l=a;return i}function PT(e,t,r){var a=e.l+t,s=Qr(e),n=[s];if(r.cellFormula){var i=L3(e,a-e.l,r);n[1]=i,e.l=a}else e.l=a;return n}var DT=["left","right","top","bottom","header","footer"];function RT(e){var t={};return DT.forEach(function(r){t[r]=ct(e)}),t}function MT(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function OT(){}function IT(){}function LT(e,t,r,a,s,n,i){if(!e)return e;var o=t||{};a||(a={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,x,m,g,y,T,v,R,D,b=[];o.biff=12,o["!row"]=0;var k=0,S=!1,P=[],H={},O=o.supbooks||s.supbooks||[[]];if(O.sharedf=H,O.arrayf=P,O.SheetNames=s.SheetNames||s.Sheets.map(function(de){return de.name}),!o.supbooks&&(o.supbooks=O,s.Names))for(var C=0;C<s.Names.length;++C)O[0][C+1]=s.Names[C];var W=[],q=[],Q=!1;hn[16]={n:"BrtShortReal",f:fh};var ae;if(vr(e,function(U,ue,he){if(!h)switch(he){case 148:u=U;break;case 0:p=U,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),R=st(g=p.r),o["!row"]=p.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=hs(U.hpt)),q[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:U[2]},U[2]){case"n":x.v=U[1];break;case"s":v=Xa[U[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!U[1];break;case"e":x.v=U[1],o.cellText!==!1&&(x.w=Jr[x.v]);break;case"str":x.t="s",x.v=U[1];break;case"is":x.t="s",x.v=U[1].t;break}if((m=i.CellXf[U[0].iStyleRef])&&ch(x,m.numFmtId,null,o,n,i),y=U[0].c==-1?y+1:U[0].c,o.dense?(l[g]||(l[g]=[]),l[g][y]=x):l[Qe(y)+R]=x,o.cellFormula){for(S=!1,k=0;k<P.length;++k){var j=P[k];p.r>=j[0].s.r&&p.r<=j[0].e.r&&y>=j[0].s.c&&y<=j[0].e.c&&(x.F=_e(j[0]),S=!0)}!S&&U.length>3&&(x.f=U[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>y&&(f.s.c=y),f.e.r<p.r&&(f.e.r=p.r),f.e.c<y&&(f.e.c=y),o.cellDates&&m&&x.t=="n"&&ka(ve[m.numFmtId])){var V=Vr(x.v);V&&(x.t="d",x.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}ae&&(ae.type=="XLDAPR"&&(x.D=!0),ae=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;x={t:"z",v:void 0},y=U[0].c==-1?y+1:U[0].c,o.dense?(l[g]||(l[g]=[]),l[g][y]=x):l[Qe(y)+R]=x,f.s.r>p.r&&(f.s.r=p.r),f.s.c>y&&(f.s.c=y),f.e.r<p.r&&(f.e.r=p.r),f.e.c<y&&(f.e.c=y),ae&&(ae.type=="XLDAPR"&&(x.D=!0),ae=void 0);break;case 176:b.push(U);break;case 49:ae=((o.xlmeta||{}).Cell||[])[U-1];break;case 494:var I=a["!id"][U.relId];for(I?(U.Target=I.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=I):U.relId==""&&(U.Target="#"+U.loc),g=U.rfx.s.r;g<=U.rfx.e.r;++g)for(y=U.rfx.s.c;y<=U.rfx.e.c;++y)o.dense?(l[g]||(l[g]=[]),l[g][y]||(l[g][y]={t:"z",v:void 0}),l[g][y].l=U):(T=pe({c:y,r:g}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=U);break;case 426:if(!o.cellFormula)break;P.push(U),D=o.dense?l[g][y]:l[Qe(y)+R],D.f=ot(U[1],f,{r:p.r,c:y},O,o),D.F=_e(U[0]);break;case 427:if(!o.cellFormula)break;H[pe(U[0].s)]=U[1],D=o.dense?l[g][y]:l[Qe(y)+R],D.f=ot(U[1],f,{r:p.r,c:y},O,o);break;case 60:if(!o.cellStyles)break;for(;U.e>=U.s;)W[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},Q||(Q=!0,Wo(U.w/256)),ga(W[U.e+1]);break;case 161:l["!autofilter"]={ref:_e(U)};break;case 476:l["!margins"]=U;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),U.name&&(s.Sheets[r].CodeName=U.name),(U.above||U.left)&&(l["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ue.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+he.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=_e(u||f)),o.sheetRows&&l["!ref"]){var Z=Be(l["!ref"]);o.sheetRows<=+Z.e.r&&(Z.e.r=o.sheetRows-1,Z.e.r>f.e.r&&(Z.e.r=f.e.r),Z.e.r<Z.s.r&&(Z.s.r=Z.e.r),Z.e.c>f.e.c&&(Z.e.c=f.e.c),Z.e.c<Z.s.c&&(Z.s.c=Z.e.c),l["!fullref"]=l["!ref"],l["!ref"]=_e(Z))}return b.length>0&&(l["!merges"]=b),W.length>0&&(l["!cols"]=W),q.length>0&&(l["!rows"]=q),l}function BT(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(n){var i=n.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Ae((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(n){a=n.replace(/<.*?>/g,"")}),[t,s,a]}function VT(e,t,r,a,s,n){var i=n||{"!type":"chart"};if(!e)return n;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=BT(d);f.s.r=f.s.c=0,f.e.c=o,u=Qe(o),h[0].forEach(function(p,x){i[u+st(x)]={t:"n",v:p,z:h[1]},l=x}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=_e(f)),i}function UT(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(lh);return o&&Go(o[0],n,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(n["!rel"]=i[1]),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}function HT(e,t){e.l+=10;var r=ut(e);return{name:r}}function WT(e,t,r,a,s){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i=!1;return vr(e,function(l,u,f){switch(f){case 550:n["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}var uh=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],zT=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],GT=[],$T=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Al(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],s=0;s!=t.length;++s){var n=t[s];if(a[n[0]]==null)a[n[0]]=n[1];else switch(n[2]){case"bool":typeof a[n[0]]=="string"&&(a[n[0]]=je(a[n[0]]));break;case"int":typeof a[n[0]]=="string"&&(a[n[0]]=parseInt(a[n[0]],10));break}}}function Nl(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=je(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function dh(e){Nl(e.WBProps,uh),Nl(e.CalcPr,$T),Al(e.WBView,zT),Al(e.Sheets,GT),ha.date1904=je(e.WBProps.date1904)}var KT="][*?/\\".split("");function XT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return KT.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var YT=/<\w+:workbook/;function qT(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,s="xmlns",n={},i=0;if(e.replace(ht,function(l,u){var f=me(l);switch(ar(f[0])){case"<?xml":break;case"<workbook":l.match(YT)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uh.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=je(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=Fe(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Ae(Fe(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":n={},n.Name=Fe(f.name),f.comment&&(n.Comment=f.comment),f.localSheetId&&(n.Sheet=+f.localSheetId),je(f.hidden||"0")&&(n.Hidden=!0),i=u+l.length;break;case"</definedName>":n.Ref=Ae(Fe(e.slice(i,u))),r.Names.push(n);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),xy.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return dh(r),r}function QT(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pi(e),r.name=ut(e),r}function JT(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?ut(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function ZT(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function eE(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),n=Py(e),i=I3(e,0,r),o=Lo(e);e.l=a;var l={Name:n,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function tE(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],s=!1;t||(t={}),t.biff=12;var n=[],i=[[]];return i.SheetNames=[],i.XTI=[],hn[16]={n:"BrtFRTArchID$",f:ZT},vr(e,function(l,u,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=ot(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,n.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(f),s=!0;break;case 36:a.pop(),s=!1;break;case 37:a.push(f),s=!0;break;case 38:a.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),dh(r),r.Names=n,r.supbooks=i,r}function rE(e,t,r){return t.slice(-4)===".bin"?tE(e,r):qT(e,r)}function aE(e,t,r,a,s,n,i,o){return t.slice(-4)===".bin"?LT(e,a,r,s,n,i,o):Q3(e,a,r,s,n,i,o)}function sE(e,t,r,a,s,n,i,o){return t.slice(-4)===".bin"?WT(e,a,r,s,n):UT(e,a,r,s,n)}function nE(e,t,r,a,s,n,i,o){return t.slice(-4)===".bin"?hb():xb()}function iE(e,t,r,a,s,n,i,o){return t.slice(-4)===".bin"?ub():db()}function oE(e,t,r,a){return t.slice(-4)===".bin"?Nk(e,r,a):bk(e,r,a)}function cE(e,t,r){return Jd(e,r)}function lE(e,t,r){return t.slice(-4)===".bin"?zw(e,r):Hw(e,r)}function fE(e,t,r){return t.slice(-4)===".bin"?cb(e,r):ab(e,r)}function uE(e,t,r){return t.slice(-4)===".bin"?eb(e):Jk(e)}function dE(e,t,r,a){return r.slice(-4)===".bin"?tb(e,t,r,a):void 0}function hE(e,t,r){return t.slice(-4)===".bin"?qk(e,t,r):Qk(e,t,r)}var hh=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,xh=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vt(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var s=e.match(hh),n,i,o,l;if(s)for(l=0;l!=s.length;++l)n=s[l].match(xh),(i=n[1].indexOf(":"))===-1?a[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(i+1),a[o]=n[2].slice(1,n[2].length-1));return a}function xE(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(hh),s,n,i,o;if(a)for(o=0;o!=a.length;++o)s=a[o].match(xh),(n=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(n+1),r[i]=s[2].slice(1,s[2].length-1));return r}var qa;function mE(e,t){var r=qa[e]||Ae(e);return r==="General"?Gr(t):Lt(r,t)}function pE(e,t,r,a){var s=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=je(a);break;case"i2":case"int":s=parseInt(a,10);break;case"r4":case"float":s=parseFloat(a);break;case"date":case"dateTime.tz":s=et(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Ae(t)]=s}function gE(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Jr[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cs(e.v):e.w=Gr(e.v):e.w=mE(t||"General",e.v)}catch(n){if(r.WTF)throw n}try{var a=qa[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&ka(a)){var s=Vr(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(n){if(r.WTF)throw n}}}function vE(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=pk[a.Pattern]||a.Pattern)}e[t.ID]=t}function yE(e,t,r,a,s,n,i,o,l,u){var f="General",d=a.StyleID,h={};u=u||{};var p=[],x=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);n[d]!==void 0&&(n[d].nf&&(f=n[d].nf),n[d].Interior&&p.push(n[d].Interior),!!n[d].Parent);)d=n[d].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=je(e);break;case"String":a.t="s",a.r=qc(Ae(e)),a.v=e.indexOf("<")>-1?Ae(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(et(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),a.v!==a.v?a.v=Ae(e):a.v<60&&(a.v=a.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=Fd[e],u.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=qc(t||e));break}if(gE(a,f,u),u.cellFormula!==!1)if(a.Formula){var m=Ae(a.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),a.f=da(m,s),delete a.Formula,a.ArrayRange=="RC"?a.F=da("RC:RC",s):a.ArrayRange&&(a.F=da(a.ArrayRange,s),l.push([Be(a.F),a.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(a.F=l[x][1]);u.cellStyles&&(p.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),a.s=h),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function wE(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function ti(e,t){var r=t||{};rd();var a=Da(Do(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Fe(a));var s=a.slice(0,1024).toLowerCase(),n=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=at(r);return i.type="string",us.to_workbook(a,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){s.indexOf("<"+Ue)>=0&&(n=!0)}),n)return CE(a,r);qa={"General Number":"General","General Date":ve[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ve[15],"Short Date":ve[14],"Long Time":ve[19],"Medium Time":ve[18],"Short Time":ve[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ve[2],Standard:ve[4],Percent:ve[10],Scientific:ve[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},d=[],h=r.dense?[]:{},p="",x={},m={},g=Vt('<Data ss:Type="String">'),y=0,T=0,v=0,R={s:{r:2e6,c:2e6},e:{r:0,c:0}},D={},b={},k="",S=0,P=[],H={},O={},C=0,W=[],q=[],Q={},ae=[],Z,de=!1,U=[],ue=[],he={},j=0,V=0,I={Sheets:[],WBProps:{date1904:!1}},B={};fs.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=fs.exec(a);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?yE(a.slice(y,o.index),k,g,l[l.length-1][0]=="comment"?Q:x,{c:T,r:v},D,ae[T],m,U,r):(k="",g=Vt(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(q.length>0&&(x.c=q),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][T]=x):h[Qe(T)+st(v)]=x),x.HRef&&(x.l={Target:Ae(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(j=T+(parseInt(x.MergeAcross,10)|0),V=v+(parseInt(x.MergeDown,10)|0),P.push({s:{c:T,r:v},e:{c:j,r:V}})),!r.sheetStubs)x.MergeAcross?T=j+1:++T;else if(x.MergeAcross||x.MergeDown){for(var ie=T;ie<=j;++ie)for(var le=v;le<=V;++le)(ie>T||le>v)&&(r.dense?(h[le]||(h[le]=[]),h[le][ie]={t:"z"}):h[Qe(ie)+st(le)]={t:"z"});T=j+1}else++T;else x=xE(o[0]),x.Index&&(T=+x.Index-1),T<R.s.c&&(R.s.c=T),T>R.e.c&&(R.e.c=T),o[0].slice(-2)==="/>"&&++T,q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<R.s.r&&(R.s.r=v),v>R.e.r&&(R.e.r=v),o[0].slice(-2)==="/>"&&(m=Vt(o[0]),m.Index&&(v=+m.Index-1)),T=0,++v):(m=Vt(o[0]),m.Index&&(v=+m.Index-1),he={},(m.AutoFitHeight=="0"||m.Height)&&(he.hpx=parseInt(m.Height,10),he.hpt=Qd(he.hpx),ue[v]=he),m.Hidden=="1"&&(he.hidden=!0,ue[v]=he));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),R.s.r<=R.e.r&&R.s.c<=R.e.c&&(h["!ref"]=_e(R),r.sheetRows&&r.sheetRows<=R.e.r&&(h["!fullref"]=h["!ref"],R.e.r=r.sheetRows-1,h["!ref"]=_e(R))),P.length&&(h["!merges"]=P),ae.length>0&&(h["!cols"]=ae),ue.length>0&&(h["!rows"]=ue),f[p]=h}else R={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=T=0,l.push([o[3],!1]),u=Vt(o[0]),p=Ae(u.Name),h=r.dense?[]:{},P=[],U=[],ue=[],B={name:p,Hidden:0},I.Sheets.push(B);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ae=[],de=!1}break;case"style":o[1]==="/"?vE(D,b,r):b=Vt(o[0]);break;case"numberformat":b.nf=Ae(Vt(o[0]).Format||"General"),qa[b.nf]&&(b.nf=qa[b.nf]);for(var se=0;se!=392&&ve[se]!=b.nf;++se);if(se==392){for(se=57;se!=392;++se)if(ve[se]==null){Wr(b.nf,se);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(Z=Vt(o[0]),Z.Hidden&&(Z.hidden=!0,delete Z.Hidden),Z.Width&&(Z.wpx=parseInt(Z.Width,10)),!de&&Z.wpx>10){de=!0,gt=Yd;for(var te=0;te<ae.length;++te)ae[te]&&ga(ae[te])}de&&ga(Z),ae[Z.Index-1||ae.length]=Z;for(var Se=0;Se<+Z.Span;++Se)ae[ae.length]=at(Z);break;case"namedrange":if(o[1]==="/")break;I.Names||(I.Names=[]);var M=me(o[0]),Ve={Name:M.Name,Ref:da(M.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(Ve.Sheet=I.Sheets.length-1),I.Names.push(Ve);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=a.slice(S,o.index):S=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;b.Interior=Vt(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?a4(H,J,a.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));wE(Q),q.push(Q)}else l.push([o[3],!1]),u=Vt(o[0]),Q={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ne=Vt(o[0]);h["!autofilter"]={ref:da(Ne.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Rl(a,r);var Ce=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(o[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(a.slice(C,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else C=o.index+o[0].length;break;case"header":h["!margins"]||Ya(h["!margins"]={},"xlml"),isNaN(+me(o[0]).Margin)||(h["!margins"].header=+me(o[0]).Margin);break;case"footer":h["!margins"]||Ya(h["!margins"]={},"xlml"),isNaN(+me(o[0]).Margin)||(h["!margins"].footer=+me(o[0]).Margin);break;case"pagemargins":var be=me(o[0]);h["!margins"]||Ya(h["!margins"]={},"xlml"),isNaN(+be.Top)||(h["!margins"].top=+be.Top),isNaN(+be.Left)||(h["!margins"].left=+be.Left),isNaN(+be.Right)||(h["!margins"].right=+be.Right),isNaN(+be.Bottom)||(h["!margins"].bottom=+be.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?pE(O,J,W,a.slice(C,o.index)):(W=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var oe={};return!r.bookSheets&&!r.bookProps&&(oe.Sheets=f),oe.SheetNames=d,oe.Workbook=I,oe.SSF=at(ve),oe.Props=H,oe.Custprops=O,oe}function Oi(e,t){switch(Xo(t=t||{}),t.type||"base64"){case"base64":return ti(Nt(e),t);case"binary":case"buffer":case"file":return ti(e,t);case"array":return ti(Yr(e),t)}}function kE(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=My(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=Oy(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var bE=[60,1084,2066,2165,2175];function TE(e,t,r,a,s){var n=a,i=[],o=r.slice(r.l,r.l+n);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=n;for(var l=lr(r,r.l),u=Ii[l],f=0;u!=null&&bE.indexOf(l)>-1;)n=lr(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+n),i.push(o),r.l+=4+n,u=Ii[l=lr(r,r.l)];var d=Tr(i);rt(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+a;return t.f(d,d.length,s)}function qt(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ve[a])}catch(n){if(t.WTF)throw n}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Jr[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cs(e.v):e.w=Gr(e.v):e.w=Lt(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(n){if(t.WTF)throw n}if(t.cellDates&&a&&e.t=="n"&&ka(ve[a]||String(a))){var s=Vr(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Hs(e,t,r){return{v:e,ixfe:t,t:r}}function EE(e,t){var r={opts:{}},a={},s=t.dense?[]:{},n={},i={},o=null,l=[],u="",f={},d,h="",p,x,m,g,y={},T=[],v,R,D=[],b=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},S={},P=function(we){return we<8?zr[we]:we<64&&b[we-8]||zr[we]},H=function(we,He,Ft){var Ye=He.XF.data;if(!(!Ye||!Ye.patternType||!Ft||!Ft.cellStyles)){He.s={},He.s.patternType=Ye.patternType;var Dr;(Dr=ds(P(Ye.icvFore)))&&(He.s.fgColor={rgb:Dr}),(Dr=ds(P(Ye.icvBack)))&&(He.s.bgColor={rgb:Dr})}},O=function(we,He,Ft){if(!(he>1)&&!(Ft.sheetRows&&we.r>=Ft.sheetRows)){if(Ft.cellStyles&&He.XF&&He.XF.data&&H(we,He,Ft),delete He.ixfe,delete He.XF,d=we,h=pe(we),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),we.r<i.s.r&&(i.s.r=we.r),we.c<i.s.c&&(i.s.c=we.c),we.r+1>i.e.r&&(i.e.r=we.r+1),we.c+1>i.e.c&&(i.e.c=we.c+1),Ft.cellFormula&&He.f){for(var Ye=0;Ye<T.length;++Ye)if(!(T[Ye][0].s.c>we.c||T[Ye][0].s.r>we.r)&&!(T[Ye][0].e.c<we.c||T[Ye][0].e.r<we.r)){He.F=_e(T[Ye][0]),(T[Ye][0].s.c!=we.c||T[Ye][0].s.r!=we.r)&&delete He.f,He.f&&(He.f=""+ot(T[Ye][1],i,we,U,C));break}}Ft.dense?(s[we.r]||(s[we.r]=[]),s[we.r][we.c]=He):s[h]=He}},C={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var W,q=[],Q=[],ae=[],Z=[],de=!1,U=[];U.SheetNames=C.snames,U.sharedf=C.sharedf,U.arrayf=C.arrayf,U.names=[],U.XTI=[];var ue=0,he=0,j=0,V=[],I=[],B;C.codepage=1200,Gt(1200);for(var J=!1;e.l<e.length-1;){var ie=e.l,le=e.read_shift(2);if(le===0&&ue===10)break;var se=e.l===e.length?0:e.read_shift(2),te=Ii[le];if(te&&te.f){if(t.bookSheets&&ue===133&&le!==133)break;if(ue=le,te.r===2||te.r==12){var Se=e.read_shift(2);if(se-=2,!C.enc&&Se!==le&&((Se&255)<<8|Se>>8)!==le)throw new Error("rt mismatch: "+Se+"!="+le);te.r==12&&(e.l+=10,se-=10)}var M={};if(le===10?M=te.f(e,se,C):M=TE(le,te,e,se,C),he==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(le){case 34:r.opts.Date1904=k.WBProps.date1904=M;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=M,!t.password)throw new Error("File is password-protected");if(M.valid==null)throw new Error("Encryption scheme unsupported");if(!M.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=M;break;case 66:var Ve=Number(M);switch(Ve){case 21010:Ve=1200;break;case 32768:Ve=1e4;break;case 32769:Ve=1252;break}Gt(C.codepage=Ve),J=!0;break;case 317:C.rrtabid=M;break;case 25:C.winlocked=M;break;case 439:r.opts.RefreshAll=M;break;case 12:r.opts.CalcCount=M;break;case 16:r.opts.CalcDelta=M;break;case 17:r.opts.CalcIter=M;break;case 13:r.opts.CalcMode=M;break;case 14:r.opts.CalcPrecision=M;break;case 95:r.opts.CalcSaveRecalc=M;break;case 15:C.CalcRefMode=M;break;case 2211:r.opts.FullCalc=M;break;case 129:M.fDialog&&(s["!type"]="dialog"),M.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),M.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:D.push(M);break;case 430:U.push([M]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(M);break;case 24:case 536:B={Name:M.Name,Ref:ot(M.rgce,i,null,U,C)},M.itab>0&&(B.Sheet=M.itab-1),U.names.push(B),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(M),M.Name=="_xlnm._FilterDatabase"&&M.itab>0&&M.rgce&&M.rgce[0]&&M.rgce[0][0]&&M.rgce[0][0][0]=="PtgArea3d"&&(I[M.itab-1]={ref:_e(M.rgce[0][0][1][2])});break;case 22:C.ExternCount=M;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(M),U.XTI=U.XTI.concat(M);break;case 2196:if(C.biff<8)break;B!=null&&(B.Comment=M[1]);break;case 18:s["!protect"]=M;break;case 19:M!==0&&C.WTF&&console.error("Password verifier: "+M);break;case 133:n[M.pos]=M,C.snames.push(M.name);break;case 10:{if(--he)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=_e(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ne=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=_e(i),i.e.r=Ne}i.e.r++,i.e.c++}q.length>0&&(s["!merges"]=q),Q.length>0&&(s["!objects"]=Q),ae.length>0&&(s["!cols"]=ae),Z.length>0&&(s["!rows"]=Z),k.Sheets.push(S)}u===""?f=s:a[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[le]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[M.BIFFVer]||8),C.biffguess=M.BIFFVer==0,M.BIFFVer==0&&M.dt==4096&&(C.biff=5,J=!0,Gt(C.codepage=28591)),C.biff==8&&M.BIFFVer==0&&M.dt==16&&(C.biff=2),he++)break;if(s=t.dense?[]:{},C.biff<8&&!J&&(J=!0,Gt(C.codepage=t.codepage||1252)),C.biff<5||M.BIFFVer==0&&M.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-se,name:u};n[Ce.pos]=Ce,C.snames.push(u)}else u=(n[ie]||{name:""}).name;M.dt==32&&(s["!type"]="chart"),M.dt==64&&(s["!type"]="macro"),q=[],Q=[],C.arrayf=T=[],ae=[],Z=[],de=!1,S={Hidden:(n[ie]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[M.r]||[])[M.c]:s[pe({c:M.c,r:M.r})])&&++M.c,v={ixfe:M.ixfe,XF:D[M.ixfe]||{},v:M.val,t:"n"},j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:M.c,r:M.r},v,t);break;case 5:case 517:v={ixfe:M.ixfe,XF:D[M.ixfe],v:M.val,t:M.t},j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:M.c,r:M.r},v,t);break;case 638:v={ixfe:M.ixfe,XF:D[M.ixfe],v:M.rknum,t:"n"},j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:M.c,r:M.r},v,t);break;case 189:for(var be=M.c;be<=M.C;++be){var oe=M.rkrec[be-M.c][0];v={ixfe:oe,XF:D[oe],v:M.rkrec[be-M.c][1],t:"n"},j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:be,r:M.r},v,t)}break;case 6:case 518:case 1030:{if(M.val=="String"){o=M;break}if(v=Hs(M.val,M.cell.ixfe,M.tt),v.XF=D[v.ixfe],t.cellFormula){var Ue=M.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var Ct=Ue[0][0][1][0],Xt=Ue[0][0][1][1],nr=pe({r:Ct,c:Xt});y[nr]?v.f=""+ot(M.formula,i,M.cell,U,C):v.F=((t.dense?(s[Ct]||[])[Xt]:s[nr])||{}).F}else v.f=""+ot(M.formula,i,M.cell,U,C)}j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O(M.cell,v,t),o=M}break;case 7:case 519:if(o)o.val=M,v=Hs(M,o.cell.ixfe,"s"),v.XF=D[v.ixfe],t.cellFormula&&(v.f=""+ot(o.formula,i,o.cell,U,C)),j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(M);var Ea=pe(M[0].s);if(p=t.dense?(s[M[0].s.r]||[])[M[0].s.c]:s[Ea],t.cellFormula&&p){if(!o||!Ea||!p)break;p.f=""+ot(M[1],i,M[0],U,C),p.F=_e(M[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[pe(o.cell)]=M[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[pe(o.cell)],(p||{}).f=""+ot(M[0],i,d,U,C)}}break;case 253:v=Hs(l[M.isst].t,M.ixfe,"s"),l[M.isst].h&&(v.h=l[M.isst].h),v.XF=D[v.ixfe],j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:M.c,r:M.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:M.ixfe,XF:D[M.ixfe],t:"z"},j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:M.c,r:M.r},v,t));break;case 190:if(t.sheetStubs)for(var yr=M.c;yr<=M.C;++yr){var Et=M.ixfe[yr-M.c];v={ixfe:Et,XF:D[Et],t:"z"},j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:yr,r:M.r},v,t)}break;case 214:case 516:case 4:v=Hs(M.val,M.ixfe,"s"),v.XF=D[v.ixfe],j>0&&(v.z=V[v.ixfe>>8&63]),qt(v,t,r.opts.Date1904),O({c:M.c,r:M.r},v,t);break;case 0:case 512:he===1&&(i=M);break;case 252:l=M;break;case 1054:if(C.biff==4){V[j++]=M[1];for(var ir=0;ir<j+163&&ve[ir]!=M[1];++ir);ir>=163&&Wr(M[1],j+163)}else Wr(M[1],M[0]);break;case 30:{V[j++]=M;for(var wr=0;wr<j+163&&ve[wr]!=M;++wr);wr>=163&&Wr(M,j+163)}break;case 229:q=q.concat(M);break;case 93:Q[M.cmo[0]]=C.lastobj=M;break;case 438:C.lastobj.TxO=M;break;case 127:C.lastobj.ImData=M;break;case 440:for(g=M[0].s.r;g<=M[0].e.r;++g)for(m=M[0].s.c;m<=M[0].e.c;++m)p=t.dense?(s[g]||[])[m]:s[pe({c:m,r:g})],p&&(p.l=M[1]);break;case 2048:for(g=M[0].s.r;g<=M[0].e.r;++g)for(m=M[0].s.c;m<=M[0].e.c;++m)p=t.dense?(s[g]||[])[m]:s[pe({c:m,r:g})],p&&p.l&&(p.l.Tooltip=M[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;p=t.dense?(s[M[0].r]||[])[M[0].c]:s[pe(M[0])];var _a=Q[M[2]];p||(t.dense?(s[M[0].r]||(s[M[0].r]=[]),p=s[M[0].r][M[0].c]={t:"z"}):p=s[pe(M[0])]={t:"z"},i.e.r=Math.max(i.e.r,M[0].r),i.s.r=Math.min(i.s.r,M[0].r),i.e.c=Math.max(i.e.c,M[0].c),i.s.c=Math.min(i.s.c,M[0].c)),p.c||(p.c=[]),x={a:M[1],t:_a.TxO.t},p.c.push(x)}break;case 2173:$k(D[M.ixfe],M.ext);break;case 125:{if(!C.cellStyles)break;for(;M.e>=M.s;)ae[M.e--]={width:M.w/256,level:M.level||0,hidden:!!(M.flags&1)},de||(de=!0,Wo(M.w/256)),ga(ae[M.e+1])}break;case 520:{var xt={};M.level!=null&&(Z[M.r]=xt,xt.level=M.level),M.hidden&&(Z[M.r]=xt,xt.hidden=!0),M.hpt&&(Z[M.r]=xt,xt.hpt=M.hpt,xt.hpx=hs(M.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Ya(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[le]]=M;break;case 161:s["!margins"]||Ya(s["!margins"]={}),s["!margins"].header=M.header,s["!margins"].footer=M.footer;break;case 574:M.RTL&&(k.Views[0].RTL=!0);break;case 146:b=M;break;case 2198:W=M;break;case 140:R=M;break;case 442:u?S.CodeName=M||S.name:k.WBProps.CodeName=M||"ThisWorkbook";break}}else te||console.error("Missing Info for XLS Record 0x"+le.toString(16)),e.l+=se}return r.SheetNames=rr(n).sort(function(Yt,we){return Number(Yt)-Number(we)}).map(function(Yt){return n[Yt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&I.forEach(function(Yt,we){r.Sheets[r.SheetNames[we]]["!autofilter"]=Yt}),r.Strings=l,r.SSF=at(ve),C.enc&&(r.Encryption=C.enc),W&&(r.Themes=W),r.Metadata={},R!==void 0&&(r.Metadata.Country=R),U.names.length>0&&(k.Names=U.names),r.Workbook=k,r}var Cl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function _E(e,t,r){var a=Ee.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var s=dl(a,Hy,Cl.DSI);for(var n in s)t[n]=s[n]}catch(u){if(r.WTF)throw u}var i=Ee.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=dl(i,Wy,Cl.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Pd(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function mh(e,t){t||(t={}),Xo(t),zu(),t.codepage&&So(t.codepage);var r,a;if(e.FullPaths){if(Ee.find(e,"/encryption"))throw new Error("File is password-protected");r=Ee.find(e,"!CompObj"),a=Ee.find(e,"/Workbook")||Ee.find(e,"/Book")}else{switch(t.type){case"base64":e=zt(Nt(e));break;case"binary":e=zt(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}rt(e,0),a={content:e}}var s,n;if(r&&kE(r),t.bookProps&&!t.bookSheets)s={};else{var i=Te?"buffer":"array";if(a&&a.content)s=EE(a.content,t);else if((n=Ee.find(e,"PerfectOffice_MAIN"))&&n.content)s=Ka.to_workbook(n.content,(t.type=i,t));else if((n=Ee.find(e,"NativeContent_MAIN"))&&n.content)s=Ka.to_workbook(n.content,(t.type=i,t));else throw(n=Ee.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ee.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=fb(e))}var o={};return e.FullPaths&&_E(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var hn={0:{f:iT},1:{f:fT},2:{f:yT},3:{f:xT},4:{f:dT},5:{f:vT},6:{f:bT},7:{f:pT},8:{f:AT},9:{f:ST},10:{f:ET},11:{f:_T},12:{f:uT},13:{f:wT},14:{f:mT},15:{f:hT},16:{f:fh},17:{f:TT},18:{f:gT},19:{f:Io},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:eE},40:{},42:{},43:{f:Ek},44:{f:Tk},45:{f:_k},46:{f:Ak},47:{f:Sk},48:{},49:{f:Ny},50:{},51:{f:Xk},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zd},62:{f:kT},63:{f:Zk},64:{f:OT},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:dt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:MT},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:lT},148:{f:oT,p:16},151:{f:FT},152:{},153:{f:JT},154:{},155:{},156:{f:QT},157:{},158:{},159:{T:1,f:Ww},160:{T:-1},161:{T:1,f:Qr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:NT},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Kk},336:{T:-1},337:{f:Yk,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pi},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Wd},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jT},427:{f:PT},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:RT},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cT},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:CT},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pi},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ob},633:{T:1},634:{T:-1},635:{T:1,f:ib},636:{T:-1},637:{f:Fy},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:HT},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:IT},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ii={6:{f:Zn},10:{f:kr},12:{f:Ke},13:{f:Ke},14:{f:We},15:{f:We},16:{f:ct},17:{f:We},18:{f:We},19:{f:Ke},20:{f:pl},21:{f:pl},23:{f:Wd},24:{f:vl},25:{f:We},26:{},27:{},28:{f:sw},29:{},34:{f:We},35:{f:gl},38:{f:ct},39:{f:ct},40:{f:ct},41:{f:ct},42:{f:We},43:{f:We},47:{f:ck},49:{f:B4},51:{f:Ke},60:{},61:{f:O4},64:{f:We},65:{f:L4},66:{f:Ke},77:{},80:{},81:{},82:{},85:{f:Ke},89:{},90:{},91:{},92:{f:N4},93:{f:iw},94:{},95:{f:We},96:{},97:{},99:{f:We},125:{f:zd},128:{f:Y4},129:{f:C4},130:{f:Ke},131:{f:We},132:{f:We},133:{f:F4},134:{},140:{f:dw},141:{f:Ke},144:{},146:{f:xw},151:{},152:{},153:{},154:{},155:{},156:{f:Ke},157:{},158:{},160:{f:yw},161:{f:pw},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:G4},190:{f:$4},193:{f:kr},197:{},198:{},199:{},200:{},201:{},202:{f:We},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ke},220:{},221:{f:We},222:{},224:{f:X4},225:{f:A4},226:{f:kr},227:{},229:{f:nw},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:j4},253:{f:V4},255:{f:P4},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Id},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:We},353:{f:kr},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Q4},431:{f:We},432:{},433:{},434:{},437:{},438:{f:lw},439:{f:We},440:{f:fw},441:{},442:{f:Ts},443:{},444:{f:Ke},445:{},446:{},448:{f:kr},449:{f:M4,r:2},450:{f:kr},512:{f:xl},513:{f:vw},515:{f:q4},516:{f:U4},517:{f:ml},519:{f:ww},520:{f:D4},523:{},545:{f:yl},549:{f:hl},566:{},574:{f:I4},638:{f:z4},659:{},1048:{},1054:{f:H4},1084:{},1212:{f:tw},2048:{f:uw},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bs},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:kr},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mw,r:12},2173:{f:Gk,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:We,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ew,r:12},2197:{},2198:{f:Bk,r:12},2199:{},2200:{},2201:{},2202:{f:rw,r:12},2203:{f:kr},2204:{},2205:{},2206:{},2207:{},2211:{f:R4},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ke},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:gw},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:hw},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:xl},1:{},2:{f:Ew},3:{f:Tw},4:{f:bw},5:{f:ml},7:{f:_w},8:{},9:{f:Bs},11:{},22:{f:Ke},30:{f:W4},31:{},32:{},33:{f:yl},36:{},37:{f:hl},50:{f:Sw},62:{},52:{},67:{},68:{f:Ke},69:{},86:{},126:{},127:{f:kw},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Aw},223:{},234:{},354:{},421:{},518:{f:Zn},521:{f:Bs},536:{f:vl},547:{f:gl},561:{},579:{},1030:{f:Zn},1033:{f:Bs},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ut(e,t,r,a){var s=t;if(!isNaN(s)){var n=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,n),n>0&&Ed(r)&&e.push(r)}}function Fl(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),i=s.index,o=n&&n.index||e.length,l=qv(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var m=l[i].trim(),g=m.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(g!="<td"&&g!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var T=y[o].trim();if(T.match(/<t[dh]/i)){for(var v=T,R=0;v.charAt(0)=="<"&&(R=v.indexOf(">"))>-1;)v=v.slice(R+1);for(var D=0;D<x.length;++D){var b=x[D];b.s.c==f&&b.s.r<u&&u<=b.e.r&&(f=b.e.c+1,D=-1)}var k=me(T.slice(0,T.indexOf(">")));h=k.colspan?+k.colspan:1,((d=+k.rowspan)>1||h>1)&&x.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var S=k.t||k["data-t"]||"";if(!v.length){f+=h;continue}if(v=ud(v),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!v.length){f+=h;continue}var P={t:"s",v};r.raw||!v.trim().length||S=="s"||(v==="TRUE"?P={t:"b",v:!0}:v==="FALSE"?P={t:"b",v:!1}:isNaN(Kt(v))?isNaN(pa(v).getDate())||(P={t:"d",v:et(v)},r.cellDates||(P={t:"n",v:kt(P.v)}),P.z=r.dateNF||ve[14]):P={t:"n",v:Kt(v)}),r.dense?(a[u]||(a[u]=[]),a[u][f]=P):a[pe({r:u,c:f})]=P,f+=h}}}}return a["!ref"]=_e(p),x.length&&(a["!merges"]=x),a}function SE(e,t,r,a){for(var s=e["!merges"]||[],n=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var f=pe({r,c:i}),d=a.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||Po(d.w||(pr(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),a.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(a.id||"sjs")+"-"+f,n.push(dy("td",h,p))}}var x="<tr>";return x+n.join("")+"</tr>"}var AE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',NE="</body></html>";function CE(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Pr(Fl(r[0],t),t);var a=qo();return r.forEach(function(s,n){Qo(a,Fl(s,t),"Sheet"+(n+1))}),a}function FE(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function jE(e,t){var r=t||{},a=r.header!=null?r.header:AE,s=r.footer!=null?r.footer:NE,n=[a],i=ba(e["!ref"]);r.dense=Array.isArray(e),n.push(FE(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)n.push(SE(e,i,o,r));return n.push("</table>"+s),n.join("")}function ph(e,t,r){var a=r||{},s=0,n=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var i=typeof a.origin=="string"?yt(a.origin):a.origin;s=i.r,n=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(a.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:n}};if(e["!ref"]){var f=ba(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),x=0,m=0,g=0,y=0,T=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&m<l;++x){var R=o[x];if(jl(R)){if(a.display)continue;p[m]={hidden:!0}}var D=R.children;for(g=y=0;g<D.length;++g){var b=D[g];if(!(a.display&&jl(b))){var k=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):ud(b.innerHTML),S=b.getAttribute("data-z")||b.getAttribute("z");for(h=0;h<d.length;++h){var P=d[h];P.s.c==y+n&&P.s.r<m+s&&m+s<=P.e.r&&(y=P.e.c+1-n,h=-1)}v=+b.getAttribute("colspan")||1,((T=+b.getAttribute("rowspan")||1)>1||v>1)&&d.push({s:{r:m+s,c:y+n},e:{r:m+s+(T||1)-1,c:y+n+(v||1)-1}});var H={t:"s",v:k},O=b.getAttribute("data-t")||b.getAttribute("t")||"";k!=null&&(k.length==0?H.t=O||"z":a.raw||k.trim().length==0||O=="s"||(k==="TRUE"?H={t:"b",v:!0}:k==="FALSE"?H={t:"b",v:!1}:isNaN(Kt(k))?isNaN(pa(k).getDate())||(H={t:"d",v:et(k)},a.cellDates||(H={t:"n",v:kt(H.v)}),H.z=a.dateNF||ve[14]):H={t:"n",v:Kt(k)})),H.z===void 0&&S!=null&&(H.z=S);var C="",W=b.getElementsByTagName("A");if(W&&W.length)for(var q=0;q<W.length&&!(W[q].hasAttribute("href")&&(C=W[q].getAttribute("href"),C.charAt(0)!="#"));++q);C&&C.charAt(0)!="#"&&(H.l={Target:C}),a.dense?(e[m+s]||(e[m+s]=[]),e[m+s][y+n]=H):e[pe({c:y+n,r:m+s})]=H,u.e.c<y+n&&(u.e.c=y+n),y+=v}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=_e(u),m>=l&&(e["!fullref"]=_e((u.e.r=o.length-x+m-1+s,u))),e}function gh(e,t){var r=t||{},a=r.dense?[]:{};return ph(a,e,t)}function PE(e,t){return Pr(gh(e,t),t)}function jl(e){var t="",r=DE(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function DE(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function RE(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Ae(t.replace(/<[^>]*>/g,""));return[r]}var Pl={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function vh(e,t){var r=t||{},a=Do(e),s=[],n,i,o={name:""},l="",u=0,f,d,h={},p=[],x=r.dense?[]:{},m,g,y={value:""},T="",v=0,R=[],D=-1,b=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},S=0,P={},H=[],O={},C=0,W=0,q=[],Q=1,ae=1,Z=[],de={Names:[]},U={},ue=["",""],he=[],j={},V="",I=0,B=!1,J=!1,ie=0;for(fs.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=fs.exec(a);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"":m[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=_e(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=_e(k)),H.length&&(x["!merges"]=H),q.length&&(x["!rows"]=q),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=x,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=me(m[0],!1),D=b=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},H=[],q=[],J=!0);break;case"table-row-group":m[1]==="/"?--S:++S;break;case"table-row":case"":if(m[1]==="/"){D+=Q,Q=1;break}if(d=me(m[0],!1),d.?D=d.-1:D==-1&&(D=0),Q=+d["number-rows-repeated"]||1,Q<10)for(ie=0;ie<Q;++ie)S>0&&(q[D+ie]={level:S});b=-1;break;case"covered-table-cell":m[1]!=="/"&&++b,r.sheetStubs&&(r.dense?(x[D]||(x[D]=[]),x[D][b]={t:"z"}):x[pe({r:D,c:b})]={t:"z"}),T="",R=[];break;case"table-cell":case"":if(m[0].charAt(m[0].length-2)==="/")++b,y=me(m[0],!1),ae=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=Sl(Ae(y.formula))),(y.||y["value-type"])=="string"&&(g.t="s",g.v=Ae(y["string-value"]||""),r.dense?(x[D]||(x[D]=[]),x[D][b]=g):x[pe({r:D,c:b})]=g),b+=ae-1;else if(m[1]!=="/"){++b,T="",v=0,R=[],ae=1;var le=Q?D+Q-1:D;if(b>k.e.c&&(k.e.c=b),b<k.s.c&&(k.s.c=b),D<k.s.r&&(k.s.r=D),le>k.e.r&&(k.e.r=le),y=me(m[0],!1),he=[],j={},g={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Ae(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(C=parseInt(y["number-matrix-rows-spanned"],10)||0,W=parseInt(y["number-matrix-columns-spanned"],10)||0,O={s:{r:D,c:b},e:{r:D+C-1,c:b+W-1}},g.F=_e(O),Z.push([O,g.F])),y.formula)g.f=Sl(y.formula);else for(ie=0;ie<Z.length;++ie)D>=Z[ie][0].s.r&&D<=Z[ie][0].e.r&&b>=Z[ie][0].s.c&&b<=Z[ie][0].e.c&&(g.F=Z[ie][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(C=parseInt(y["number-rows-spanned"],10)||0,W=parseInt(y["number-columns-spanned"],10)||0,O={s:{r:D,c:b},e:{r:D+C-1,c:b+W-1}},H.push(O)),y["number-columns-repeated"]&&(ae=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=je(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=et(y["date-value"]),r.cellDates||(g.t="n",g.v=kt(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=Kv(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=_n(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(T=Ae(y["string-value"]),R=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(B=!1,g.t==="s"&&(g.v=T||"",R.length&&(g.R=R),B=v==0),U.Target&&(g.l=U),he.length>0&&(g.c=he,he=[]),T&&r.cellText!==!1&&(g.w=T),B&&(g.t="z",delete g.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=D))for(var se=0;se<Q;++se){if(ae=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(x[D+se]||(x[D+se]=[]),x[D+se][b]=se==0?g:at(g);--ae>0;)x[D+se][b+ae]=at(g);else for(x[pe({r:D+se,c:b})]=g;--ae>0;)x[pe({r:D+se,c:b+ae})]=at(g);k.e.c<=b&&(k.e.c=b)}ae=parseInt(y["number-columns-repeated"]||"1",10),b+=ae-1,ae=0,g={},T="",R=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((n=s.pop())[0]!==m[3])throw"Bad state: "+n}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((n=s.pop())[0]!==m[3])throw"Bad state: "+n;j.t=T,R.length&&(j.R=R),j.a=V,he.push(j)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);V="",I=0,T="",v=0,R=[];break;case"creator":m[1]==="/"?V=a.slice(I,m.index):I=m.index+m[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((n=s.pop())[0]!==m[3])throw"Bad state: "+n}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);T="",v=0,R=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(P[o.name]=l,(n=s.pop())[0]!==m[3])throw"Bad state: "+n}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=me(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=me(m[0],!1),l+=Pl[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=me(m[0],!1),l+=Pl[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=a.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":i=me(m[0],!1),ue=ei(i["cell-range-address"]);var te={Name:i.name,Ref:ue[0]+"!"+ue[1]};J&&(te.Sheet=p.length),de.Names.push(te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var Se=RE(a.slice(v,m.index));T=(T.length>0?T+`
`:"")+Se[0]}else me(m[0],!1),v=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ue=ei(me(m[0])["target-range-address"]),h[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(U=me(m[0],!1),!U.href)break;U.Target=Ae(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(ue=ei(U.Target.slice(1)),U.Target="#"+ue[0]+"!"+ue[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(m)}}var M={Sheets:h,SheetNames:p,Workbook:de};return r.bookSheets&&delete M.Sheets,M}function Dl(e,t){t=t||{},Ot(e,"META-INF/manifest.xml")&&qy($e(e,"META-INF/manifest.xml"),t);var r=At(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=vh(Fe(r),t);return Ot(e,"meta.xml")&&(a.Props=jd($e(e,"meta.xml"))),a}function Rl(e,t){return vh(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function $o(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Li(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Fe(Yr(e))}function Bi(e){var t=e.reduce(function(s,n){return s+n.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(s){r.set(s,a),a+=s.length}),r}function Ml(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ME(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,s=t+13;s>=t;--s)a=a*256+e[s];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function xs(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function Je(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ft(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],s=xs(e,r),n=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(n){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=xs(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(n," for Field ").concat(s," at offset ").concat(a))}var u={data:o,type:n};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Ko(e,t){return e?.map(function(r){return t(r.data)})||[]}function OE(e){for(var t,r=[],a=[0];a[0]<e.length;){var s=xs(e,a),n=ft(e.slice(a[0],a[0]+s));a[0]+=s;var i={id:Je(n[1][0].data),messages:[]};n[2].forEach(function(o){var l=ft(o.data),u=Je(l[3][0].data);i.messages.push({meta:l,data:e.slice(a[0],a[0]+u)}),a[0]+=u}),(t=n[3])!=null&&t[0]&&(i.merge=Je(n[3][0].data)>>>0>0),r.push(i)}return r}function IE(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=xs(t,r),s=[];r[0]<t.length;){var n=t[r[0]]&3;if(n==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(n==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,n==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Bi(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var f=Bi(s);if(f.length!=a)throw new Error("Unexpected length: ".concat(f.length," != ").concat(a));return f}function LE(e){for(var t=[],r=0;r<e.length;){var a=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(IE(a,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Bi(t)}function BE(e,t,r,a){var s=$o(e),n=s.getUint32(4,!0),i=(a>1?12:8)+Ml(n&(a>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);n&512&&(o=s.getUint32(i,!0),i+=4),i+=Ml(n&(a>1?12288:4096))*4,n&16&&(l=s.getUint32(i,!0),i+=4),n&32&&(u=s.getFloat64(i,!0),i+=8),n&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function VE(e,t,r){var a=$o(e),s=a.getUint32(8,!0),n=12,i=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);s&1&&(l=ME(e,n),n+=16),s&2&&(u=a.getFloat64(n,!0),n+=8),s&4&&(f.setTime(f.getTime()+a.getFloat64(n,!0)*1e3),n+=8),s&8&&(o=a.getUint32(n,!0),n+=4),s&16&&(i=a.getUint32(n,!0),n+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function UE(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return BE(e,t,r,e[0]);case 5:return VE(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Sr(e){var t=ft(e);return xs(t[1][0].data)}function Ol(e,t){var r=ft(t.data),a=Je(r[1][0].data),s=r[3],n=[];return(s||[]).forEach(function(i){var o=ft(i.data),l=Je(o[1][0].data)>>>0;switch(a){case 1:n[l]=Li(o[3][0].data);break;case 8:{var u=e[Sr(o[9][0].data)][0],f=ft(u.data),d=e[Sr(f[1][0].data)][0],h=Je(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=ft(d.data);n[l]=p[3].map(function(x){return Li(x.data)}).join("")}break}}),n}function HE(e,t){var r,a,s,n,i,o,l,u,f,d,h,p,x,m,g=ft(e),y=Je(g[1][0].data)>>>0,T=Je(g[2][0].data)>>>0,v=((a=(r=g[8])==null?void 0:r[0])==null?void 0:a.data)&&Je(g[8][0].data)>0||!1,R,D;if((n=(s=g[7])==null?void 0:s[0])!=null&&n.data&&t!=0)R=(o=(i=g[7])==null?void 0:i[0])==null?void 0:o.data,D=(u=(l=g[6])==null?void 0:l[0])==null?void 0:u.data;else if((d=(f=g[4])==null?void 0:f[0])!=null&&d.data&&t!=1)R=(p=(h=g[4])==null?void 0:h[0])==null?void 0:p.data,D=(m=(x=g[3])==null?void 0:x[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var b=v?4:1,k=$o(R),S=[],P=0;P<R.length/2;++P){var H=k.getUint16(P*2,!0);H<65535&&S.push([P,H])}if(S.length!=T)throw"Expected ".concat(T," cells, found ").concat(S.length);var O=[];for(P=0;P<S.length-1;++P)O[S[P][0]]=D.subarray(S[P][1]*b,S[P+1][1]*b);return S.length>=1&&(O[S[S.length-1][0]]=D.subarray(S[S.length-1][1]*b)),{R:y,cells:O}}function WE(e,t){var r,a=ft(t.data),s=(r=a?.[7])!=null&&r[0]?Je(a[7][0].data)>>>0>0?1:0:-1,n=Ko(a[5],function(i){return HE(i,s)});return{nrows:Je(a[4][0].data)>>>0,data:n.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function zE(e,t,r){var a,s=ft(t.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(Je(s[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(n.e.c=(Je(s[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=_e(n);var i=ft(s[4][0].data),o=Ol(e,e[Sr(i[4][0].data)][0]),l=(a=i[17])!=null&&a[0]?Ol(e,e[Sr(i[17][0].data)][0]):[],u=ft(i[3][0].data),f=0;u[1].forEach(function(d){var h=ft(d.data),p=e[Sr(h[2][0].data)][0],x=Je(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var m=WE(e,p);m.data.forEach(function(g,y){g.forEach(function(T,v){var R=pe({r:f+y,c:v}),D=UE(T,o,l);D&&(r[R]=D)})}),f+=m.nrows})}function GE(e,t){var r=ft(t.data),a={"!ref":"A1"},s=e[Sr(r[2][0].data)],n=Je(s[0].meta[1][0].data);if(n!=6001)throw new Error("6000 unexpected reference to ".concat(n));return zE(e,s[0],a),a}function $E(e,t){var r,a=ft(t.data),s={name:(r=a[1])!=null&&r[0]?Li(a[1][0].data):"",sheets:[]},n=Ko(a[2],Sr);return n.forEach(function(i){e[i].forEach(function(o){var l=Je(o.meta[1][0].data);l==6e3&&s.sheets.push(GE(e,o))})}),s}function KE(e,t){var r=qo(),a=ft(t.data),s=Ko(a[1],Sr);if(s.forEach(function(n){e[n].forEach(function(i){var o=Je(i.meta[1][0].data);if(o==2){var l=$E(e,i);l.sheets.forEach(function(u,f){Qo(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ri(e){var t,r,a,s,n={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=LE(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=OE(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){n[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(a=(r=(t=n?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:s[0].data)&&Je(n[1][0].meta[1][0].data)==1&&n[1][0];if(o||i.forEach(function(l){n[l].forEach(function(u){var f=Je(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return KE(n,o)}function XE(e){return function(r){for(var a=0;a!=e.length;++a){var s=e[a];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Xo(e){XE([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function YE(e){return oa.WS.indexOf(e)>-1?"sheet":e==oa.CS?"chart":e==oa.DS?"dialog":e==oa.MS?"macro":e&&e.length?e:"sheet"}function qE(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,YE(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function QE(e,t,r,a,s,n,i,o,l,u,f,d){try{n[a]=Ga(At(e,r,!0),t);var h=$e(e,t),p;switch(o){case"sheet":p=aE(h,t,s,l,n[a],u,f,d);break;case"chart":if(p=sE(h,t,s,l,n[a],u,f,d),!p||!p["!drawel"])break;var x=Ma(p["!drawel"].Target,t),m=Di(x),g=rb(At(e,x,!0),Ga(At(e,m,!0),x)),y=Ma(g,x),T=Di(y);p=VT(At(e,y,!0),y,l,Ga(At(e,T,!0),y),u,p);break;case"macro":p=nE(h,t,s,l,n[a],u,f,d);break;case"dialog":p=iE(h,t,s,l,n[a],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[a]=p;var v=[];n&&n[a]&&rr(n[a]).forEach(function(R){var D="";if(n[a][R].Type==oa.CMNT){D=Ma(n[a][R].Target,t);var b=fE($e(e,D,!0),D,l);if(!b||!b.length)return;kl(p,b,!1)}n[a][R].Type==oa.TCMNT&&(D=Ma(n[a][R].Target,t),v=v.concat(sb($e(e,D,!0),l)))}),v&&v.length&&kl(p,v,!0,l.people||[])}catch(R){if(l.WTF)throw R}}function Dt(e){return e.charAt(0)=="/"?e.slice(1):e}function JE(e,t){if(rd(),t=t||{},Xo(t),Ot(e,"META-INF/manifest.xml")||Ot(e,"objectdata.xml"))return Dl(e,t);if(Ot(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ri<"u"){if(e.FileIndex)return ri(e);var r=Ee.utils.cfb_new();return Xc(e).forEach(function(q){Zv(r,q,Jv(e,q))}),ri(r)}throw new Error("Unsupported NUMBERS file")}if(!Ot(e,"[Content_Types].xml"))throw Ot(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ot(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=Xc(e),s=Xy(At(e,"[Content_Types].xml")),n=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",$e(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!$e(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),n=!0}s.workbooks[0].slice(-3)=="bin"&&(n=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Xa=[],s.sst)try{Xa=lE($e(e,Dt(s.sst)),s.sst,t)}catch(q){if(t.WTF)throw q}t.cellStyles&&s.themes.length&&(l=cE(At(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=oE($e(e,Dt(s.style)),s.style,l,t))}s.links.map(function(q){try{var Q=Ga(At(e,Di(Dt(q))),q);return dE($e(e,Dt(q)),Q,q,t)}catch{}});var f=rE($e(e,Dt(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&(h=$e(e,Dt(s.coreprops[0]),!0),h&&(d=jd(h)),s.extprops.length!==0&&(h=$e(e,Dt(s.extprops[0]),!0),h&&Zy(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=At(e,Dt(s.custprops[0]),!0),h&&(p=t4(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(Q){return Q.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(x.Props=d,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var m={};t.bookDeps&&s.calcchain&&(m=uE($e(e,Dt(s.calcchain)),s.calcchain));var g=0,y={},T,v;{var R=f.Sheets;d.Worksheets=R.length,d.SheetNames=[];for(var D=0;D!=R.length;++D)d.SheetNames[D]=R[D].name}var b=n?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),S=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Ot(e,S)||(S="xl/_rels/workbook."+b+".rels");var P=Ga(At(e,S,!0),S.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=hE($e(e,Dt(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=nb($e(e,Dt(s.people[0])),t)),P&&(P=qE(P,f.Sheets));var H=$e(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=d.Worksheets;++g){var O="sheet";if(P&&P[g]?(T="xl/"+P[g][1].replace(/[\/]?xl\//,""),Ot(e,T)||(T=P[g][1]),Ot(e,T)||(T=S.replace(/_rels\/.*$/,"")+P[g][1]),O=P[g][2]):(T="xl/worksheets/sheet"+(g+1-H)+"."+b,T=T.replace(/sheet0\./,"sheet.")),v=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(d.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,W=0;W!=t.sheets.length;++W)typeof t.sheets[W]=="number"&&t.sheets[W]==g&&(C=1),typeof t.sheets[W]=="string"&&t.sheets[W].toLowerCase()==d.SheetNames[g].toLowerCase()&&(C=1);if(!C)continue e}}QE(e,T,v,d.SheetNames[g],g,y,i,O,t,f,l,u)}return x={Directory:s,Workbook:f,Props:d,Custprops:p,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:Xa,Styles:u,Themes:l,SSF:at(ve)},t&&t.bookFiles&&(e.files?(x.keys=a,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(q,Q){q=q.replace(/^Root Entry[\/]/,""),x.keys.push(q),x.files[q]=e.FileIndex[Q]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=$e(e,Dt(s.vba[0]),!0):s.defaults&&s.defaults.bin===lb&&(x.vbaraw=$e(e,"xl/vbaProject.bin",!0))),x}function ZE(e,t){var r=t||{},a="Workbook",s=Ee.find(e,a);try{if(a="/!DataSpaces/Version",s=Ee.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(Gw(s.content),a="/!DataSpaces/DataSpaceMap",s=Ee.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var n=Kw(s.content);if(n.length!==1||n[0].comps.length!==1||n[0].comps[0].t!==0||n[0].name!=="StrongEncryptionDataSpace"||n[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ee.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var i=Xw(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ee.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);qw(s.content)}catch{}if(a="/EncryptionInfo",s=Ee.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=Qw(s.content);if(a="/EncryptedPackage",s=Ee.find(e,a),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Yo(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Nt(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function e5(e,t){return Ee.find(e,"EncryptedPackage")?ZE(e,t):mh(e,t)}function t5(e,t){var r,a=e,s=t||{};return s.type||(s.type=Te&&Buffer.isBuffer(e)?"buffer":"base64"),r=cd(a,s),JE(r,s)}function yh(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Oi(e.slice(r),t);default:break e}return us.to_workbook(e,t)}function r5(e,t){var r="",a=Yo(e,t);switch(t.type){case"base64":r=Nt(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$r(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Fe(r)),t.type="binary",yh(r,t)}function a5(e,t){var r=e;return t.type=="base64"&&(r=Nt(r)),r=os.utils.decode(1200,r.slice(2),"str"),t.type="binary",yh(r,t)}function s5(e){return e.match(/[^\x00-\x7F]/)?Oa(e):e}function ai(e,t,r,a){return a?(r.type="string",us.to_workbook(e,r)):us.to_workbook(t,r)}function xn(e,t){zu();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return xn(new Uint8Array(e),(r=at(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,s=[0,0,0,0],n=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ha={},r.dateNF&&(ha.dateNF=r.dateNF),r.type||(r.type=Te&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Te?"buffer":"binary",a=Gv(e),typeof Uint8Array<"u"&&!Te&&(r.type="array")),r.type=="string"&&(n=!0,r.type="binary",r.codepage=65001,a=s5(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=at(r),r.type="array",xn(Ao(a),r)}switch((s=Yo(a,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return e5(Ee.read(a,r),r);break;case 9:if(s[1]<=8)return mh(a,r);break;case 60:return Oi(a,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Pw(a,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return Fw.to_workbook(a,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?t5(a,r):ai(e,a,r,n);case 239:return s[3]===60?Oi(a,r):ai(e,a,r,n);case 255:if(s[1]===254)return a5(a,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Ka.to_workbook(a,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Ka.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return wl.to_workbook(a,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return lk.to_workbook(a,r);break;case 10:case 13:case 32:return r5(a,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Nw.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?wl.to_workbook(a,r):ai(e,a,r,n)}function n5(e,t,r,a,s,n,i,o){var l=st(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[a[p]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;n[p]!=null&&(h[n[p]]=u);continue}var m=x.v;switch(x.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(n[p]!=null){if(m==null)if(x.t=="e"&&m===null)h[n[p]]=null;else if(u!==void 0)h[n[p]]=u;else if(f&&m===null)h[n[p]]=null;else continue;else h[n[p]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?m:pr(x,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function Vi(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,s=1,n=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?a=1:u.header==="A"?a=2:Array.isArray(u.header)?a=3:u.header==null&&(a=0),typeof f){case"string":l=Be(f);break;case"number":l=Be(e["!ref"]),l.s.r=f;break;default:l=f}a>0&&(s=0);var d=st(l.s.r),h=[],p=[],x=0,m=0,g=Array.isArray(e),y=l.s.r,T=0,v={};g&&!e[y]&&(e[y]=[]);var R=u.skipHidden&&e["!cols"]||[],D=u.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(R[T]||{}).hidden)switch(h[T]=Qe(T),r=g?e[y][T]:e[h[T]+d],a){case 1:n[T]=T-l.s.c;break;case 2:n[T]=h[T];break;case 3:n[T]=u.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=pr(r,null,u),m=v[i]||0,!m)v[i]=1;else{do o=i+"_"+m++;while(v[o]);v[i]=m,v[o]=1}n[T]=o}for(y=l.s.r+s;y<=l.e.r;++y)if(!(D[y]||{}).hidden){var b=n5(e,l,y,h,a,n,g,u);(b.isempty===!1||(a===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=b.row)}return p.length=x,p}var Il=/"/g;function i5(e,t,r,a,s,n,i,o){for(var l=!0,u=[],f="",d=st(r),h=t.s.c;h<=t.e.c;++h)if(a[h]){var p=o.dense?(e[r]||[])[h]:e[a[h]+d];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:pr(p,null,o));for(var x=0,m=0;x!==f.length;++x)if((m=f.charCodeAt(x))===s||m===n||m===34||o.forceQuotes){f='"'+f.replace(Il,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Il,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(i)}function wh(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var s=Be(e["!ref"]),n=a.FS!==void 0?a.FS:",",i=n.charCodeAt(0),o=a.RS!==void 0?a.RS:`
`,l=o.charCodeAt(0),u=new RegExp((n=="|"?"\\|":n)+"+$"),f="",d=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],p=a.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(d[x]=Qe(x));for(var m=0,g=s.s.r;g<=s.e.r;++g)(p[g]||{}).hidden||(f=i5(e,s,g,d,i,l,n,a),f!=null&&(a.strip&&(f=f.replace(u,"")),(f||a.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete a.dense,r.join("")}function o5(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=wh(e,t);return r}function c5(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var s=Be(e["!ref"]),n="",i=[],o,l=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Qe(o);for(var f=s.s.r;f<=s.e.r;++f)for(n=st(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+n,r=u?(e[f]||[])[o]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}l[l.length]=t+"="+a}return l}function kh(e,t,r){var a=r||{},s=+!a.skipHeader,n=e||{},i=0,o=0;if(n&&a.origin!=null)if(typeof a.origin=="number")i=a.origin;else{var l=typeof a.origin=="string"?yt(a.origin):a.origin;i=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(n["!ref"]){var d=Be(n["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var h=a.header||[],p=0;t.forEach(function(m,g){rr(m).forEach(function(y){(p=h.indexOf(y))==-1&&(h[p=h.length]=y);var T=m[y],v="z",R="",D=pe({c:o+p,r:i+g+s});u=ms(n,D),T&&typeof T=="object"&&!(T instanceof Date)?n[D]=T:(typeof T=="number"?v="n":typeof T=="boolean"?v="b":typeof T=="string"?v="s":T instanceof Date?(v="d",a.cellDates||(v="n",T=kt(T)),R=a.dateNF||ve[14]):T===null&&a.nullError&&(v="e",T=0),u?(u.t=v,u.v=T,delete u.w,delete u.R,R&&(u.z=R)):n[D]=u={t:v,v:T},R&&(u.z=R))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var x=st(i);if(s)for(p=0;p<h.length;++p)n[Qe(p+o)+x]={t:"s",v:h[p]};return n["!ref"]=_e(f),n}function l5(e,t){return kh(null,e,t)}function ms(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=yt(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ms(e,pe(t)):ms(e,pe({r:t,c:r||0}))}function f5(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function qo(){return{SheetNames:[],Sheets:{}}}function Qo(e,t,r,a){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var n=r.match(/(^.*?)(\d+)$/);s=n&&+n[2]||0;var i=n&&n[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(XT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function u5(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=f5(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function d5(e,t){return e.z=t,e}function bh(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function h5(e,t,r){return bh(e,"#"+t,r)}function x5(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function m5(e,t,r,a){for(var s=typeof t!="string"?t:Be(t),n=typeof t=="string"?t:_e(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=ms(e,i,o);l.t="n",l.F=n,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,a&&(l.D=!0))}return e}var Th={encode_col:Qe,encode_row:st,encode_cell:pe,encode_range:_e,decode_col:Oo,decode_row:Mo,split_cell:Ay,decode_cell:yt,decode_range:ba,format_cell:pr,sheet_add_aoa:Sd,sheet_add_json:kh,sheet_add_dom:ph,aoa_to_sheet:Ta,json_to_sheet:l5,table_to_sheet:gh,table_to_book:PE,sheet_to_csv:wh,sheet_to_txt:o5,sheet_to_json:Vi,sheet_to_html:jE,sheet_to_formulae:c5,sheet_to_row_object_array:Vi,sheet_get_cell:ms,book_new:qo,book_append_sheet:Qo,book_set_sheet_visibility:u5,cell_set_number_format:d5,cell_set_hyperlink:bh,cell_set_internal_link:h5,cell_add_comment:x5,sheet_set_array_formula:m5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const p5=({isOpen:e,onClose:t,selectedColumns:r,onImport:a,selectedClass:s,title:n})=>{const[i,o]=L.useState([]),[l,u]=L.useState(!1),[f,d]=L.useState(""),[h,p]=L.useState(null),[x,m]=L.useState(!1),[g,y]=L.useState(!1),[T,v]=L.useState(null);L.useEffect(()=>{if(e){m(!0);const O=setTimeout(()=>y(!0),10);return()=>clearTimeout(O)}else{y(!1);const O=setTimeout(()=>m(!1),300);return()=>clearTimeout(O)}},[e]);const R=O=>{const C=O.target.files?.[0];C&&(d(""),p(null),v(C),D(C))},D=O=>{const C=new FileReader;C.onload=W=>{try{const q=new Uint8Array(W.target.result),Q=xn(q,{type:"array"}),ae=Q.Sheets[Q.SheetNames[0]],Z=Th.sheet_to_json(ae,{header:1,raw:!1});if(Z.length<2){d("The file is empty or has no data");return}const de=Z[0],U=Z.slice(1).filter(j=>j.some(V=>V!==void 0&&V!=="")),ue=r.map(j=>de.findIndex(V=>V&&j&&V.toString().toLowerCase()===j.toLowerCase())),he=U.map(j=>{const V={};return ue.forEach((I,B)=>{I>=0&&I<j.length?(V[r[B]]=j[I],V.class=s):V[r[B]]=""}),V});p({headers:r,rows:he}),o(he)}catch(q){console.error("Error processing file:",q),d("Invalid file format. Please upload a valid Excel file.")}},C.readAsArrayBuffer(O)},b=async()=>{if(!h){d("No data to import");return}if(!s){d("Please select a class first");return}try{u(!0),await a({...h,class:s}),t()}catch(O){console.error("Import error:",O),d(O.message||"Failed to import data. Please try again.")}finally{u(!1)}},k=()=>{v(null),p(null),d("")},S={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.15,ease:[.4,0,.2,1]}},exit:{opacity:0,transition:{duration:.1,ease:[.4,0,.2,1]}}},P={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.2,ease:[.4,0,.2,1],when:"beforeChildren",staggerChildren:.03}},exit:{opacity:0,y:10,transition:{duration:.15,ease:[.4,0,.2,1]}}},H={hidden:{opacity:0,y:5},visible:{opacity:1,y:0,transition:{duration:.2,ease:[.4,0,.2,1]}}};if(!x)return null;if(e)return c.jsx(mr,{children:c.jsxs(ke.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",initial:"hidden",animate:"visible",exit:"exit",variants:S,children:[c.jsx(ke.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t,variants:S}),c.jsx(ke.div,{className:"relative z-10 w-full max-w-5xl max-h-[90vh] bg-white dark:bg-gray-800 rounded-xl shadow-2xl overflow-hidden",variants:P,onClick:O=>O.stopPropagation(),children:c.jsxs("div",{className:"p-6 max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{children:[c.jsx(ke.h3,{className:"text-xl font-semibold text-gray-900 dark:text-white",variants:H,custom:0,children:"Import Students from Excel"}),c.jsx(ke.p,{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",variants:H,custom:.1,children:"Upload an Excel file with student data"})]}),c.jsxs(ke.button,{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",whileHover:{scale:1.1},whileTap:{scale:.95},variants:H,custom:.1,children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx(is,{className:"h-6 w-6"})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2.5 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:c.jsx(Fi,{className:"w-7 h-7 text-blue-600 dark:text-blue-400"})}),c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[n," - ",s]})]}),c.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 pl-1",children:["Upload an Excel file with ",n.toLowerCase()," data. Supported formats: .xlsx, .xls, .csv"]})]}),c.jsx("div",{className:"flex-1 overflow-y-auto p-1 space-y-4",children:c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 p-3 rounded-lg border border-blue-200 dark:border-blue-800/50",children:[c.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2",children:"Required Columns:"}),c.jsx("div",{className:"flex flex-wrap gap-1.5",children:r.map((O,C)=>c.jsx("span",{className:"inline-flex items-center px-2.5 py-1 bg-blue-100 dark:bg-blue-800/50 text-blue-800 dark:text-blue-200 rounded-full text-xs font-medium",children:O},C))})]})}),c.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800/50",children:[c.jsx("input",{id:"file-upload",type:"file",className:"hidden",accept:".xlsx, .xls, .csv",onChange:R}),c.jsxs("div",{className:"flex flex-col items-center gap-4 w-full",children:[c.jsxs("button",{type:"button",onClick:()=>document.getElementById("file-upload")?.click(),className:"relative w-full max-w-md px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-medium rounded-lg shadow-md hover:shadow-lg transition-all duration-200 transform hover:-translate-y-0.5 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 focus:ring-offset-white dark:focus:ring-offset-gray-800 flex items-center justify-center gap-2 group",children:[c.jsx(ns,{className:"w-5 h-5 transition-transform duration-200 group-hover:scale-110"}),c.jsx("span",{className:"text-sm sm:text-base font-medium",children:T?"Change Excel File":"Upload Excel File"}),c.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-3/4 h-1 bg-blue-400/30 rounded-full",children:c.jsx("div",{className:"h-full bg-white/50 rounded-full animate-pulse"})})]}),T&&c.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[c.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 dark:bg-green-900/20 text-green-700 dark:text-green-300 text-sm font-medium rounded-full border border-green-200 dark:border-green-800",children:[c.jsx(Fi,{className:"w-4 h-4"}),c.jsx("span",{className:"truncate max-w-[200px] sm:max-w-xs",children:T.name}),c.jsxs("span",{className:"text-xs text-green-600 dark:text-green-400",children:[(T.size/1024).toFixed(1)," KB"]})]}),c.jsx("button",{type:"button",onClick:k,className:"p-1.5 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-colors duration-200",title:"Remove file",children:c.jsx(is,{className:"w-4 h-4"})})]})]}),T&&c.jsxs("div",{className:"mt-6 text-center space-y-1",children:[c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Drag and drop your file here, or click to browse"}),c.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Supported formats: .xlsx, .xls, .csv (Max 5MB)"})]})]}),f&&c.jsxs("div",{className:"mt-2 p-4 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800/50 flex items-start space-x-2",children:[c.jsx(En,{className:"flex-shrink-0 h-5 w-5 mt-0.5 text-red-500"}),c.jsx("span",{children:f})]}),h&&c.jsxs("div",{className:"mt-4 overflow-hidden border rounded-lg shadow-sm dark:border-gray-700 transition-all duration-300 hover:shadow-md flex-1 flex flex-col",children:[c.jsx("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:["Preview (",h.rows.length," rows)"]}),c.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:[c.jsx(Ru,{className:"mr-1 h-3 w-3"}),h.rows.length," rows ready"]})]})}),c.jsx("div",{className:"flex-1 overflow-auto max-h-96",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0",children:c.jsx("tr",{children:h.headers.map((O,C)=>c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:O},C))})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:h.rows.map((O,C)=>c.jsx("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:h.headers.map((W,q)=>c.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300 whitespace-nowrap",children:O[W]||"-"},q))},C))})]})}),c.jsx("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-t dark:border-gray-700 flex justify-end",children:c.jsx("button",{type:"button",onClick:b,disabled:!h||l,className:`relative px-6 py-2 text-sm font-medium text-white bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border border-transparent rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all duration-200 ${!h||l?"opacity-70 cursor-not-allowed":"hover:shadow-md transform hover:-translate-y-0.5"}`,children:l?c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Importing..."]}):c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsx(ns,{className:"w-4 h-4"}),"Import Data"]})})})]})]})})]})})};function g5({isOpen:e,onClose:t,onUpload:r}){const[a,s]=L.useState([]),[n,i]=L.useState(!1),[o,l]=L.useState(null),u=L.useCallback(x=>{const g=Array.from(x.target.files).map(y=>{const T=URL.createObjectURL(y),v=y.name.match(/^(\d+)/),R=v?v[1]:null;return{file:y,url:T,roll:R,matched:null}});s(g)},[]),f=async x=>{if(x.preventDefault(),!(a.length===0||!r))try{i(!0),l(null);const m=new FormData;a.forEach(g=>{m.append("photos",g.file)}),await r(m),a.forEach(g=>{URL.revokeObjectURL(g.url)}),s([]),t()}catch(m){l(m.message||"Failed to upload photos. Please try again.")}finally{i(!1)}},d={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.15,ease:[.4,0,.2,1]}},exit:{opacity:0,transition:{duration:.1,ease:[.4,0,.2,1]}}},h={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.2,ease:[.4,0,.2,1],when:"beforeChildren",staggerChildren:.05}},exit:{opacity:0,y:10,transition:{duration:.15,ease:[.4,0,.2,1]}}},p={hidden:{opacity:0,y:5},visible:{opacity:1,y:0,transition:{duration:.2,ease:[.4,0,.2,1]}}};return c.jsx(mr,{children:e&&c.jsx(c.Fragment,{children:c.jsxs(ke.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",initial:"hidden",animate:"visible",exit:"exit",children:[c.jsx(ke.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t,variants:d}),c.jsx(ke.div,{className:"relative z-10 w-full max-w-2xl bg-white dark:bg-gray-800 rounded-xl shadow-2xl overflow-hidden",variants:h,onClick:x=>x.stopPropagation(),children:c.jsxs("div",{className:"p-6 max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-start justify-between mb-6 pb-6 border-b border-gray-100 dark:border-gray-700",children:[c.jsxs("div",{className:"space-y-1",children:[c.jsx(ke.h2,{className:"text-2xl font-bold text-gray-900 dark:text-white",variants:p,custom:0,children:"Upload Student Photos"}),c.jsx(ke.p,{className:"text-sm text-gray-500 dark:text-gray-400",variants:p,custom:.1,children:"Quickly upload multiple student profile pictures at once"})]}),c.jsxs(ke.button,{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",whileHover:{scale:1.1},whileTap:{scale:.95},variants:p,custom:.1,children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),c.jsxs("form",{onSubmit:f,className:"space-y-6",children:[c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select Photos"}),c.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[a.length," selected"]})]}),c.jsx("div",{className:"flex items-center gap-3",children:c.jsxs("label",{className:"flex-1 cursor-pointer group",children:[c.jsxs("div",{className:"flex flex-col items-center justify-center w-full px-4 py-10 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl hover:border-blue-400 dark:hover:border-blue-500 bg-white dark:bg-gray-800/50 transition-all duration-200 group-hover:shadow-sm group-hover:ring-1 group-hover:ring-blue-100 dark:group-hover:ring-blue-900/50",children:[c.jsx("div",{className:"p-3 mb-3 rounded-full bg-blue-50 dark:bg-blue-900/30 text-blue-500 dark:text-blue-400 transition-colors group-hover:bg-blue-100 dark:group-hover:bg-blue-900/50",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})})}),c.jsxs("p",{className:"text-sm text-center text-gray-600 dark:text-gray-300",children:[c.jsx("span",{className:"font-medium text-blue-600 hover:text-blue-500 dark:text-blue-400 dark:hover:text-blue-300 transition-colors",children:"Click to upload"})," ","or drag and drop"]}),c.jsx("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"JPG, PNG (max 5MB each)"}),c.jsx("p",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded-full",children:"Tip: Name files with roll numbers (e.g., 101.jpg)"})]}),c.jsx("input",{type:"file",className:"hidden",accept:"image/*",multiple:!0,onChange:u,disabled:n})]})})]}),o&&c.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-100 dark:bg-red-900/30 dark:text-red-400 rounded-md",children:o}),a.length>0&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.length," ",a.length===1?"Photo":"Photos"," Ready to Upload"]}),c.jsx("button",{type:"button",onClick:()=>s([]),className:"text-xs text-red-500 hover:text-red-600 dark:text-red-400 dark:hover:text-red-300 transition-colors",children:"Clear all"})]}),c.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700",children:c.jsx("div",{className:"max-h-64 overflow-auto p-2 bg-gray-50 dark:bg-gray-800/30",children:c.jsx("div",{className:"grid grid-cols-1 gap-2",children:a.map((x,m)=>c.jsxs("div",{className:"group flex items-center gap-3 p-2 rounded-lg hover:bg-white dark:hover:bg-gray-800/70 transition-colors border border-transparent hover:border-gray-200 dark:hover:border-gray-700",children:[c.jsx("div",{className:"relative h-14 w-14 flex-shrink-0 overflow-hidden rounded-md bg-gray-100 dark:bg-gray-700",children:c.jsx("img",{src:x.url,alt:x.file.name,className:"h-full w-full object-cover"})}),c.jsxs("div",{className:"min-w-0 flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-gray-100 truncate",children:x.file.name}),c.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[c.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${x.roll?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"}`,children:x.roll?`Roll: ${x.roll}`:"No roll number"}),c.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(x.file.size/1024).toFixed(1)," KB"]})]})]}),c.jsx("button",{type:"button",onClick:g=>{g.stopPropagation();const y=[...a];y.splice(m,1),s(y)},className:"p-1 text-gray-400 hover:text-red-500 dark:text-gray-500 dark:hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100","aria-label":"Remove photo",children:c.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},m))})})})]}),c.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100 dark:border-gray-700 mt-6",children:[c.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.length>0?c.jsxs("span",{className:"inline-flex items-center",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-green-500 mr-2"}),a.length," ",a.length===1?"photo":"photos"," ready"]}):c.jsx("span",{children:"No photos selected"})}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2.5 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:n,children:"Cancel"}),c.jsx("button",{type:"submit",className:"px-6 py-2.5 text-sm font-medium text-white bg-blue-600 rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",disabled:n||a.length===0,children:n?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):c.jsxs(c.Fragment,{children:[c.jsx("svg",{className:"w-4 h-4 mr-2 -ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),a.length>0?`Upload ${a.length} ${a.length===1?"Photo":"Photos"}`:"Upload"]})})]})]})]})]})})]})})})}function v5(){const[e,t]=L.useState(null),[r,a]=L.useState([]),[s,n]=L.useState(!1),[i,o]=L.useState(null),[l,u]=L.useState(!1),[f,d]=L.useState(!1),[h,p]=L.useState(null),[x,m]=L.useState(!1),[g,y]=L.useState(!1),[T,v]=L.useState(!1),[R,D]=L.useState([]);L.useEffect(()=>{const O=typeof window<"u"?window.localStorage.getItem("ui.selectedClass"):null;O&&t(O)},[]);const b=L.useCallback(async O=>{try{n(!0),o(null);const W=O.rows.map(q=>{const Q={};return O.headers.forEach((ae,Z)=>{const de=ae.trim();ae&&q[de]!==void 0&&q[de]!==""&&(Q[de]=q[de])}),{studentName:Q["Student Name"],class:e,session:"2025",roll:Q.Roll,fatherName:Q["Father Name"],className:e,mobileNumberNumber:Q["Mobile Number"],address:Q.Address,dob:Q["Date of Birth"]}}).filter(q=>q.studentName&&q.roll);if(W.length===0)throw new Error("No valid student records found in the file");return await uv(W),await fa(e),alert(`Successfully imported ${W.length} students`),!0}catch(C){return console.error("Error importing students:",C),o(C.message||"Failed to process the Excel file. Please check the format."),!1}finally{n(!1)}},[e]);L.useEffect(()=>{(async()=>{if(e){n(!0),o(null);try{const C=await fa(e);C.sort((W,q)=>W.roll-q.roll),a(Array.isArray(C)?C:[])}catch{o("Failed to load students")}finally{n(!1)}}})()},[e]);const k=async()=>{if(e){n(!0),o(null);try{const O=await fa(e);a(Array.isArray(O)?O:[])}catch{o("Failed to load students")}finally{n(!1)}}},S=O=>{p(O),d(!0)},P=O=>{const C=[];return O.fatherName&&C.push(c.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg border border-gray-100 dark:border-gray-600/30",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-sm font-medium text-gray-500 dark:text-gray-300",children:"Father"}),c.jsx("span",{className:"text-gray-700 dark:text-gray-100 font-medium",children:O.fatherName})]})},"father")),O.dob&&C.push(c.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg border border-gray-100 dark:border-gray-600/30",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-sm font-medium text-gray-500 dark:text-gray-300",children:"DOB"}),c.jsx("span",{className:"text-gray-700 dark:text-gray-100 font-medium",children:new Date(O.dob).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]})},"dob")),O.address&&C.push(c.jsx("div",{className:"bg-gray-50 dark:bg-gray-700/50 p-3 rounded-lg border border-gray-100 dark:border-gray-600/30",children:c.jsxs("div",{className:"flex items-start",children:[c.jsxs("span",{className:"w-20 text-sm font-medium text-gray-500 dark:text-gray-300 flex-shrink-0",children:[c.jsxs("svg",{className:"w-4 h-4 inline-block mr-1 -mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Address"]}),c.jsx("p",{className:"text-sm text-gray-700 dark:text-gray-200 line-clamp-2",children:O.address})]})},"address")),O.mobileNumber&&C.push(c.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg border border-blue-100 dark:border-blue-800/50",children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-20 text-sm font-medium text-blue-600 dark:text-blue-400",children:"Contact"}),c.jsxs("a",{href:`tel:${O.mobileNumber}`,className:"text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:underline transition-colors flex items-center font-medium",children:[c.jsx("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),c.jsx("span",{className:"truncate text-base",children:O.mobileNumber})]})]})},"contact")),C},H=async O=>{if(e){y(!0);try{await dv(e,O),v(!1),D([]),await k()}catch(C){console.error("Error uploading photos:",C),o("Failed to upload photos")}finally{y(!1)}}};return c.jsxs("div",{className:"p-2 ",children:[c.jsxs("div",{className:"flex flex-col space-y-4",children:[c.jsxs("div",{className:"flex md:flex-row flex-col space-y-2 justify-between items-center  mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Students"}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsxs("button",{onClick:()=>m(!0),className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",children:[c.jsx(p2,{className:"mr-2"}),"Import Excel"]}),c.jsxs("button",{onClick:()=>v(!0),className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-lg hover:bg-purple-700 transition-colors focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2",children:[c.jsx(v2,{className:"mr-2"}),"Upload Photos"]}),c.jsxs("button",{onClick:()=>u(!0),className:"flex items-center px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-lg hover:bg-indigo-700 transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",children:[c.jsx(T2,{className:"mr-2"}),"Add Student"]})]})]}),c.jsx(Hu,{selected:e,onSelect:t}),e?s?c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Loading students..."}):i?c.jsx("p",{className:"text-sm text-red-600",children:i}):c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6 p-4",children:r.length>0?r.map(O=>c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-100 dark:border-gray-700 hover:border-blue-100 dark:hover:border-blue-900 overflow-hidden group",children:[c.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 p-5 text-white",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"relative",children:c.jsxs("div",{className:"h-16 w-16 bg-white/20 rounded-full flex items-center justify-center text-white font-bold text-2xl shadow-md overflow-hidden",children:[O.photoUrl||O.photo?c.jsx("img",{src:O.photoUrl||O.photo,alt:O.studentName,className:"w-full h-full object-cover",onError:C=>{C.target.style.display="none",C.target.nextElementSibling.style.display="flex"}}):null,c.jsx("div",{className:`absolute inset-0 flex items-center justify-center ${O.photoUrl||O.photo?"hidden":"flex"}`,children:(()=>{const C=O.studentName?.split(" ")||[],W=C[0]?.charAt(0)||"S",q=C.length>1?C[C.length-1].charAt(0):"";return`${W}${q}`.toUpperCase()})()})]})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"font-bold text-lg truncate mb-1.5",children:O.studentName||"N/A"}),c.jsxs("div",{className:"flex flex-wrap items-center gap-2.5",children:[c.jsxs("span",{className:"bg-blue-500/90 text-white px-3 py-1.5 rounded-lg text-sm font-semibold shadow-sm",children:["Roll: ",O.roll||"N/A"]}),c.jsx("span",{className:"bg-indigo-500/90 text-white px-3 py-1.5 rounded-lg text-sm font-semibold shadow-sm",children:O.class||"N/A"}),O.session&&c.jsx("span",{className:"bg-purple-500/90 text-white px-3 py-1.5 rounded-lg text-sm font-semibold shadow-sm",children:O.session})]})]})]})}),c.jsxs("div",{className:"p-5",children:[c.jsx("div",{className:"space-y-3.5",children:P(O)}),c.jsx("div",{className:"mt-5 pt-4 border-t border-gray-100 dark:border-gray-700 flex justify-end",children:c.jsxs("button",{onClick:()=>S(O),className:"flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm",children:[c.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Student"]})})]})]},O._id||O.roll)):c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["No students found for ",e,"."]})}):c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Select a class to view students."})]}),c.jsx(hv,{isOpen:l,cls:e,onClose:()=>u(!1),onSubmit:async O=>{try{y(!0);const C=await fv({...O,cls:e});a(W=>[...W,C]),u(!1)}catch(C){console.error("Error creating student:",C),o(C.message||"Failed to add student")}finally{y(!1)}}}),c.jsx(p5,{isOpen:x,onClose:()=>m(!1),selectedClass:e,title:"Import Students from Excel",selectedColumns:["Roll","Student Name","Father Name","Address","Date of Birth"],onImport:b}),c.jsx(g5,{isOpen:T,onClose:()=>{v(!1),D([])},onUpload:H}),h&&c.jsx(xv,{isOpen:f,onClose:()=>{d(!1),p(null)},student:h,onSubmit:async O=>{try{y(!0);const C=await lv(h._id,O);a(W=>W.map(q=>q._id===C._id?C:q)),d(!1),p(null)}catch(C){console.error("Error updating student:",C),o(C.message||"Failed to update student")}finally{y(!1)}}})]})}const y5=({isOpen:e,onClose:t,selectedExam:r,selectedColumns:a,onImport:s,selectedClass:n,title:i})=>{const[o,l]=L.useState([]),[u,f]=L.useState(!1),[d,h]=L.useState(""),[p,x]=L.useState(null),[m,g]=L.useState(!1),[y,T]=L.useState(!1),[v,R]=L.useState(null);L.useEffect(()=>{if(e){g(!0);const C=setTimeout(()=>T(!0),10);return()=>clearTimeout(C)}else{T(!1);const C=setTimeout(()=>g(!1),300);return()=>clearTimeout(C)}},[e]);const D=C=>{const W=C.target.files?.[0];W&&(h(""),x(null),R(W),b(W))},b=C=>{const W=new FileReader;W.onload=q=>{try{const Q=new Uint8Array(q.target.result),ae=xn(Q,{type:"array"}),Z=ae.Sheets[ae.SheetNames[0]],de=Th.sheet_to_json(Z,{header:1,raw:!1});if(de.length<2){h("The file is empty or has no data");return}const U=de[0],ue=de.slice(1).filter(V=>V.some(I=>I!==void 0&&I!=="")),he=a.map(V=>U.findIndex(I=>I&&V&&I.toString().toLowerCase()===V.toLowerCase())),j=ue.map(V=>{const I={};return he.forEach((B,J)=>{B>=0&&B<V.length?(I[a[J]]=V[B],I.class=n):I[a[J]]=""}),I});x({headers:a,rows:j}),l(j)}catch(Q){console.error("Error processing file:",Q),h("Invalid file format. Please upload a valid Excel file.")}},W.readAsArrayBuffer(C)},k=async()=>{if(!p){h("No data to import");return}if(!n){h("Please select a class first");return}try{f(!0),await s({...p,class:n}),t()}catch(C){console.error("Import error:",C),h(C.message||"Failed to import data. Please try again.")}finally{f(!1)}},S=()=>{R(null),x(null),h("")};if(!m)return null;const P={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.15}}},H={hidden:{scale:.95,opacity:0},visible:{scale:1,opacity:1,transition:{type:"spring",damping:20,stiffness:300}},exit:{scale:.95,opacity:0,transition:{duration:.15}}},O={hidden:{y:10,opacity:0},visible:C=>({y:0,opacity:1,transition:{delay:C*.05,duration:.3}})};if(!m)return null;if(e)return c.jsx(mr,{children:c.jsxs(ke.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4 overflow-y-auto",initial:"hidden",animate:"visible",exit:"exit",variants:P,children:[c.jsx(ke.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm",onClick:t,variants:P}),c.jsx(ke.div,{className:"relative z-10 w-full max-w-5xl max-h-[70vh] bg-white dark:bg-gray-800 rounded-xl shadow-2xl overflow-hidden",variants:H,onClick:C=>C.stopPropagation(),children:c.jsxs("div",{className:"p-6 max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200 dark:border-gray-700",children:[c.jsxs("div",{children:[c.jsxs(ke.h3,{className:"text-xl font-semibold text-gray-900 dark:text-white",variants:O,custom:0,children:["Import ",i," from Excel"]}),c.jsxs(ke.p,{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",variants:O,custom:.1,children:["Upload an Excel file with ",i.toLowerCase()," data"]})]}),c.jsxs(ke.button,{type:"button",onClick:t,className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300",whileHover:{scale:1.1},whileTap:{scale:.95},variants:O,custom:.1,children:[c.jsx("span",{className:"sr-only",children:"Close"}),c.jsx(is,{className:"h-6 w-6"})]})]}),c.jsxs("div",{className:"space-y-1",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2.5 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:c.jsx(Fi,{className:"w-7 h-7 text-blue-600 dark:text-blue-400"})}),c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[i," - ",n]}),c.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-lime-100 text-lime-800 dark:bg-lime-900/30 dark:text-lime-300",children:r})]}),c.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 pl-1",children:["Upload an Excel file with ",i.toLowerCase()," data. Supported formats: .xlsx, .xls, .csv"]})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-1 space-y-4",children:[c.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/10 p-3 rounded-lg border border-blue-200 dark:border-blue-800/50",children:[c.jsx("h3",{className:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-1",children:"Required Columns:"}),c.jsx("div",{className:"flex flex-wrap gap-1.5 text-sm",children:a.map((C,W)=>c.jsx("span",{className:"inline-flex items-center px-2.5 py-1 bg-blue-100 dark:bg-blue-800/50 text-blue-800 dark:text-blue-200 rounded-full text-xs font-medium",children:C},W))})]}),c.jsxs("div",{className:"flex flex-col items-center justify-center py-8 px-4 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800/50",children:[c.jsx("input",{id:"file-upload",type:"file",className:"hidden",accept:".xlsx, .xls, .csv",onChange:D}),c.jsxs("div",{className:"flex flex-col items-center gap-3",children:[c.jsxs("div",{className:"flex gap-10 items-center",children:[c.jsxs("button",{type:"button",variant:"outline",onClick:()=>document.getElementById("file-upload")?.click(),children:[c.jsx(ns,{className:"mr-2 h-4 w-4"}),v?"Change File":"Browse Files"]}),v&&c.jsxs("button",{type:"button",variant:"ghost",onClick:S,className:"text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20",children:[c.jsx(is,{className:"mr-2 h-4 w-4"}),"Remove"]})]}),v&&c.jsxs("div",{className:"text-center",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 truncate max-w-xs",children:[v.name," (",(v.size/1024).toFixed(1)," KB)"]}),c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[p?.rows?.length||0," records found"]})]})]})]}),d&&c.jsxs("div",{className:"mt-2 p-4 text-sm text-red-700 dark:text-red-300 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800/50 flex items-start space-x-2",children:[c.jsx(En,{className:"flex-shrink-0 h-5 w-5 mt-0.5 text-red-500"}),c.jsx("span",{children:d})]}),p&&c.jsxs("div",{className:"mt-4 overflow-hidden border rounded-lg shadow-sm dark:border-gray-700 transition-all duration-300 hover:shadow-md flex-1 flex flex-col",children:[c.jsx("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-b dark:border-gray-700",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-200",children:["Preview (",p.rows.length," rows)"]}),c.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",children:[c.jsx(Ru,{className:"mr-1 h-3 w-3"}),p.rows.length," rows ready"]})]})}),c.jsx("div",{className:"flex-1 overflow-auto max-h-96",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 sticky top-0",children:c.jsx("tr",{children:p.headers.map((C,W)=>c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:C},W))})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:p.rows.map((C,W)=>c.jsx("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/30 transition-colors",children:p.headers.map((q,Q)=>c.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 dark:text-gray-300 whitespace-nowrap",children:C[q]||"-"},Q))},W))})]})}),c.jsx("div",{className:"px-4 py-3 bg-gray-50 dark:bg-gray-800 border-t dark:border-gray-700 flex justify-end",children:c.jsx("button",{type:"button",onClick:k,disabled:!p||u,className:`relative px-6 py-2 text-sm font-medium text-white bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 border border-transparent rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-all duration-200 ${!p||u?"opacity-70 cursor-not-allowed":"hover:shadow-md transform hover:-translate-y-0.5"}`,children:u?c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Importing..."]}):c.jsxs("span",{className:"flex items-center justify-center gap-2",children:[c.jsx(ns,{className:"w-4 h-4"}),"Import Data"]})})})]})]})]})})]})})};function w5({isOpen:e,onClose:t,student:r,examName:a,subjects:s=[],initialMarks:n={},onSubmit:i}){const[o,l]=L.useState({}),[u,f]=L.useState(!1),d={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.2}},exit:{opacity:0,transition:{duration:.2}}},h={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.3,ease:"easeOut"}},exit:{y:20,opacity:0,transition:{duration:.2,ease:"easeIn"}}};L.useEffect(()=>{e&&r&&l(n||{})},[e,r,n]);const p=(m,g)=>{l(y=>({...y,[m]:g}))},x=async m=>{if(m.preventDefault(),!!i)try{f(!0),await i(o),t()}catch(g){console.error("Error saving marks:",g)}finally{f(!1)}};return c.jsx(mr,{children:e&&r&&c.jsxs(ke.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4",initial:"hidden",animate:"visible",exit:"exit",variants:d,children:[c.jsx(ke.div,{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:t,"aria-hidden":"true",variants:d}),c.jsx(ke.div,{className:"relative z-10 w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden",variants:h,onClick:m=>m.stopPropagation(),children:c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b border-gray-100 dark:border-gray-700",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Edit Marks - ",a]}),c.jsxs("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:["Update marks for ",r.studentName," (Roll: ",r.roll,")"]})]}),c.jsx("button",{onClick:t,className:"p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors","aria-label":"Close",children:c.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),c.jsxs("form",{onSubmit:x,className:"space-y-6",children:[c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 max-h-[60vh] overflow-y-auto pr-2 -mr-2",children:s.map((m,g)=>c.jsxs(ke.div,{className:"space-y-1.5",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1+g*.03},children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:m}),c.jsxs("div",{className:"relative",children:[c.jsx("input",{type:"text",value:o[m]||"",onChange:y=>p(m,y.target.value),className:"w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white px-4 py-2.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter marks"}),c.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:c.jsx("span",{className:"text-gray-500 text-sm",children:"/100"})})]})]},m))}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-100 dark:border-gray-700",children:[c.jsx(ke.button,{type:"button",onClick:t,whileHover:{scale:1.02},whileTap:{scale:.98},className:"px-5 py-2.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-gray-200 dark:hover:bg-gray-600 transition-all duration-200",disabled:u,children:"Cancel"}),c.jsx(ke.button,{type:"submit",whileHover:{scale:1.02},whileTap:{scale:.98},className:"px-5 py-2.5 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-lg shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 flex items-center",disabled:u,children:u?c.jsxs(c.Fragment,{children:[c.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]})]})})]})})}function k5(){const[e,t]=L.useState(null),[r,a]=L.useState([]),[s,n]=L.useState(!1),[i,o]=L.useState(null),[l,u]=L.useState([]),[f,d]=L.useState({}),[h,p]=L.useState([]),[x,m]=L.useState(""),[g,y]=L.useState(!1),[T,v]=L.useState(null),[R,D]=L.useState({}),[b,k]=L.useState(!1),[S,P]=L.useState(!1),[H,O]=L.useState(!1);L.useRef(null);const C=L.useCallback(async W=>{if(!(!e||!x))try{y(!0),o(null);const q=W.rows.map(ae=>{const Z={};return W.headers.forEach(de=>{de!=="Roll"&&de!=="Student Name"&&de!=="class"&&(Z[de]=ae[de])}),{studentName:ae["Student Name"],roll:ae.Roll,marks:{[x]:Z}}});console.log(q),await Rc(e,x,q);const Q=await fa(e);return a(Array.isArray(Q)?Q:[]),!0}catch(q){return console.error("Error importing marks:",q),o(q.message||"Failed to import marks"),!1}finally{y(!1)}},[e,x]);return L.useEffect(()=>{const W=typeof window<"u"?window.localStorage.getItem("ui.selectedClass"):null;W&&t(W)},[]),L.useEffect(()=>{if(e)try{window.localStorage.setItem("ui.selectedClass",e)}catch{}},[e]),L.useEffect(()=>{(async()=>{if(e){n(!0),o(null);try{console.log("Fetching students for class:",e,"exam:",x);const q=await fa(e,x);console.log("Received students data:",q);const Q=await Vu(e);q&&q.length>0&&(console.log("First student data:",q[0]),console.log("Does first student have rank?","rank"in q[0])),a(Array.isArray(q)?q:[]),u(Q.terms||[]),p(Q.subjects),!x&&Array.isArray(Q?.terms)&&Q.terms.length&&(m(Q.terms[0]),d(Q.fullMarks)),d(Q?.fullMarks)}catch{o("Failed to load students/config")}finally{n(!1)}}})()},[e,x]),c.jsxs("div",{className:"space-y-4 p-4",children:[c.jsxs("div",{className:"flex flex-col space-y-4",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Marks Management"}),e&&x&&c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e," - ",x]})]}),c.jsx("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:c.jsxs("button",{onClick:()=>P(!0),disabled:!e||s,className:`flex items-center gap-2 px-4 py-2.5 text-sm font-medium rounded-lg shadow-sm transition-all ${e&&!s?"bg-green-600 text-white hover:bg-green-700 hover:shadow-md transform hover:-translate-y-0.5":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:e?"":"Please select a class first",children:[c.jsx(ns,{className:"text-base"}),"Import Marks"]})})]}),c.jsx("div",{className:"flex flex-col md:flex-row gap-4",children:c.jsxs("div",{className:"w-full",children:[c.jsx(Hu,{selected:e,onSelect:t}),c.jsxs("div",{className:"mt-4",children:[c.jsx("h3",{className:"text-sm font-medium mb-2 dark:text-white",children:"Select Exam:"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:l.length>0?l.map(W=>c.jsx("button",{onClick:()=>m(W),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${x===W?"bg-indigo-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-100 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:W},W)):c.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"No exams configured. Configure in Configuration panel."})})]})]})}),c.jsx("div",{className:"mt-4",children:e?s?c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Loading students"}):i?c.jsx("p",{className:"text-sm text-red-600",children:i}):c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 p-2",children:r.length>0?[...r].sort((W,q)=>W.roll!==q.roll?W.roll-q.roll:W.studentName.localeCompare(q.studentName)).map(W=>{const q=W.marks?.[x]||{},Q=f?.[x]||100,ae=Object.values(q).reduce((U,ue)=>U+(Number(ue)||0),0),Z=h.length*Q,de=Z>0?Math.round(ae/Z*100):0;return c.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 border border-gray-100 dark:border-gray-700 overflow-hidden group cursor-pointer",onClick:()=>{v(W),D(q),k(!0)},children:[c.jsx("div",{className:" bg-gradient-to-r from-indigo-600 to-purple-600 p-4 text-white",children:c.jsxs("div",{className:"grid grid-cols-[2fr_0.5fr_1.5fr] w-full  justify-between",children:[c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"font-bold text-lg truncate",children:W.studentName}),c.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[c.jsxs("span",{className:"bg-white/20 px-2.5 py-0.5 rounded-full text-xs font-medium",children:["Roll: ",W.roll||"N/A"]}),c.jsx("span",{className:"bg-white/20 px-2.5 py-0.5 rounded-full text-xs font-medium",children:W.class})]})]}),c.jsx("div",{children:W.rank&&c.jsx("span",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white text-base font-extrabold rounded-full h-8 w-8 flex items-center justify-center shadow-xl ring-2 ring-white dark:ring-white/80 z-10 transform hover:scale-125 transition-all duration-200",children:W.rank})}),c.jsx("div",{className:"flex flex-col items-center",children:c.jsxs("div",{className:"relative",children:[c.jsxs("div",{className:"text-2xl font-bold",children:[ae,c.jsxs("span",{className:"text-sm font-normal",children:["/",h.length*(f[x]||100)]})]}),c.jsx("div",{className:"text-xs opacity-80",children:W.rank?`Rank ${W.rank} of ${W.totalStudents||"--"}`:"Total Marks"})]})})]})}),c.jsx("div",{className:"p-4",children:c.jsx("div",{className:"grid grid-cols-2 gap-3",children:h.map(U=>{const ue=q[U],he=ue==="AB",j=he?0:Number(ue)||0,V=f?.[x]||100,I=he?0:Math.round(j/V*100),B=he?"from-gray-400 to-gray-500":I>=80?"from-green-500 to-emerald-600":I>=40?"from-amber-400 to-amber-500":"from-red-400 to-red-500";return c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-2.5 transition-all hover:shadow-sm",children:[c.jsxs("div",{className:"flex justify-between items-start mb-1",children:[c.jsx("span",{className:"text-xs font-medium text-gray-600 dark:text-gray-300 truncate",children:U}),c.jsxs("span",{className:"text-sm font-semibold text-gray-800 dark:text-white",children:[he?"Absent":j||"--",c.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["/",V]})]})]}),c.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-1.5",children:c.jsx("div",{className:`h-full rounded-full bg-gradient-to-r ${B}`,style:{width:`${Math.min(I,100)}%`}})}),c.jsx("div",{className:"text-right mt-0.5",children:c.jsx("span",{className:`text-xs font-medium ${he?"text-gray-500":I>=80?"text-green-600":I>=40?"text-amber-600":"text-red-600"}`,children:he?"Absent":`${I}%`})})]},U)})})}),c.jsxs("div",{className:"px-4 py-2.5 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-100 dark:border-gray-700",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("svg",{className:"w-4 h-4 mr-1 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),c.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Performance"})]}),c.jsx("div",{className:"flex items-center",children:c.jsxs("span",{className:`text-sm font-semibold ${de>=80?"text-green-600 dark:text-green-400":de>=40?"text-amber-600 dark:text-amber-400":"text-red-600 dark:text-red-400"}`,children:[de,"%"]})})]}),c.jsxs("button",{onClick:U=>{U.stopPropagation(),v(W),D(q),k(!0)},className:"mt-2 w-full py-1.5 px-3 text-sm font-medium rounded-md bg-indigo-100 text-indigo-700 hover:bg-indigo-200 dark:bg-indigo-900/30 dark:text-indigo-300 dark:hover:bg-indigo-800/50 transition-colors flex items-center justify-center gap-1.5",children:[c.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit Marks"]})]})]},W._id)}):c.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["No students found for ",e,"."]})}):c.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"Select a class to manage marks."})})]}),S&&c.jsx(y5,{isOpen:S,onClose:()=>P(!1),selectedClass:e,selectedExam:x,title:"Import Marks from Excel",selectedColumns:["Roll","Student Name",...h],onImport:C}),c.jsx(w5,{isOpen:b,onClose:()=>k(!1),student:T,examName:x,subjects:h,initialMarks:R,onSubmit:async W=>{if(!(!T||!e||!x))try{y(!0);const q={studentName:T.studentName,roll:T.roll,marks:{[x]:W}};await Rc(e,x,[q]);const Q=await fa(e,x);return a(Array.isArray(Q)?Q:[]),!0}catch(q){return console.error("Error updating marks:",q),o(q.message||"Failed to update marks"),!1}finally{y(!1)}}})]})}function b5({selectedClass:e,initialData:t,onSave:r,onClose:a}){const[s,n]=L.useState(t?.exams||["First Summative Evaluation","Second Summative Evaluation","Third Summative Evaluation"]),[i,o]=L.useState(t?.subjects||[]),[l,u]=L.useState(()=>({"First Summative Evaluation":100,"Second Summative Evaluation":100,"Third Summative Evaluation":100,...t?.fullMarks||{}})),[f,d]=L.useState(t?.openDays||0),[h,p]=L.useState("");L.useEffect(()=>{n(t?.exams||["First Summative Evaluation","Second Summative Evaluation","Third Summative Evaluation"]),o(t?.subjects||[]),u(D=>({"First Summative Evaluation":100,"Second Summative Evaluation":100,"Third Summative Evaluation":100,...t?.fullMarks||{}})),d(t?.openDays||0)},[e,t]);const x=()=>{const D={class:e,exams:s,subjects:i,fullMarks:l,openDays:Number(f)||0};r?.(D)},m=(D,b)=>{u(k=>({...k,[D]:Number(b)||0}))},g=(D,b)=>{const k=[...s],S=k[D];k[D]=b;const P={...l};S in P&&(P[b]=P[S],delete P[S]),n(k),u(P)},y=()=>{const D=`Exam ${s.length+1}`;n([...s,D]),u(b=>({...b,[D]:100}))},T=D=>{const b=s[D],k=s.filter((P,H)=>H!==D),S={...l};delete S[b],n(k),u(S)},v=()=>{h.trim()&&(o([...i,h.trim()]),p(""))},R=D=>{const b=[...i];b.splice(D,1),o(b)};return c.jsxs("div",{className:"w-full sm:min-w-[90vw] md:min-w-[32rem] max-w-4xl mx-2 sm:mx-auto bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 p-4 sm:p-6 rounded-xl shadow-xl transition-all duration-300 transform hover:shadow-2xl",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:[e,"  Configuration"]}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[c.jsx("button",{onClick:x,className:"px-3 sm:px-4 py-2 text-sm rounded-md bg-gradient-to-r from-indigo-600 to-indigo-700 text-white hover:from-indigo-700 hover:to-indigo-800 transition-all duration-300 transform hover:scale-105 shadow-md hover:shadow-lg w-full sm:w-auto",children:"Save Configuration"}),c.jsx("button",{onClick:a,className:"px-3 sm:px-4 py-2 text-sm rounded-md bg-gradient-to-r from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 dark:from-gray-700 dark:to-gray-600 dark:hover:from-gray-600 dark:hover:to-gray-500 text-gray-800 dark:text-gray-100 transition-all duration-300 transform hover:scale-105 shadow-md w-full sm:w-auto",children:"Close"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mt-4 sm:mt-6",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h4",{className:"text-base font-medium text-gray-900 dark:text-white",children:"Exams & Full Marks"}),c.jsx("button",{onClick:y,className:"px-3 py-1 text-xs rounded-md bg-gradient-to-r from-green-100 to-green-50 text-green-700 dark:from-green-900/30 dark:to-green-800/10 dark:text-green-300 hover:from-green-200 hover:to-green-100 dark:hover:from-green-800/50 dark:hover:to-green-700/30 transition-all duration-300 transform hover:scale-105 shadow-sm",children:"+ Add Exam"})]}),c.jsx("div",{className:"space-y-3",children:s.map((D,b)=>c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"text",value:D,onChange:k=>g(b,k.target.value),className:"min-w-0 flex-1 px-3 py-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200 truncate w-full"}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",value:l[D]||"",onChange:k=>m(D,k.target.value),className:"w-24 px-2 py-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-center focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200",min:"1",step:"1"}),c.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400 whitespace-nowrap",children:"marks"}),c.jsx("button",{onClick:()=>T(b),className:"p-1 text-gray-400 hover:text-red-500 transition-all duration-200 transform hover:scale-110",title:"Remove exam",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},b))})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"text-base font-medium text-gray-900 dark:text-white",children:"Subjects"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[c.jsx("input",{type:"text",value:h,onChange:D=>p(D.target.value),placeholder:"Enter subject name",className:"flex-1 px-3 py-2 text-sm rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-full",onKeyPress:D=>D.key==="Enter"&&v()}),c.jsx("button",{onClick:v,className:"px-3 py-2 text-sm rounded-md bg-gradient-to-r from-green-100 to-green-50 text-green-700 dark:from-green-900/30 dark:to-green-800/10 dark:text-green-300 hover:from-green-200 hover:to-green-100 dark:hover:from-green-800/50 dark:hover:to-green-700/30 transition-all duration-300 transform hover:scale-105 shadow-sm w-full sm:w-auto",children:"Add Subject"})]}),c.jsxs("div",{className:"mt-3",children:[c.jsxs("h5",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Current Subjects (",i.length,")"]}),i.length>0?c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:i.map((D,b)=>c.jsxs("div",{className:"flex items-center justify-between p-2 bg-white dark:bg-gray-700 rounded-md border border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-650 transition-colors duration-200 transform hover:-translate-y-0.5 hover:shadow-sm",children:[c.jsx("span",{className:"text-sm text-gray-800 dark:text-gray-200 truncate",children:D}),c.jsx("button",{onClick:()=>R(b),className:"text-gray-400 hover:text-red-500 transition-all duration-200 transform hover:scale-110","aria-label":`Remove ${D}`,children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},b))}):c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No subjects added yet"})]})]})]}),c.jsxs("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-700",children:[c.jsx("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-3",children:"Classes Information"}),c.jsx("div",{className:"flex items-center gap-4",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:"openDays",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Number of Classes Taken"}),c.jsx("input",{type:"number",id:"openDays",value:f,onChange:D=>d(Number(D.target.value)||0),min:"0",step:"1",className:"w-16 sm:w-20 px-2 py-1 text-sm text-center rounded-md border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all duration-200"})]})})]})]})}function T5(){const[e,t]=L.useState(null),[r,a]=L.useState(null),[s,n]=L.useState(null),[i,o]=L.useState(!1),[l,u]=L.useState(!1),[f,d]=L.useState({}),[h,p]=L.useState(!1),[x,m]=L.useState(null),[g,y]=L.useState(!1),T=async()=>{p(!0),m(null);try{const k=await Uu(la);d(k||{})}catch(k){console.error("Failed to load config statuses",k),d({}),m(k?.message||"Failed to load"),cr.error(`Failed to load configuration statuses: ${k?.message||""}`)}finally{p(!1)}};L.useEffect(()=>{T()},[]);const v=()=>{y(!0),setTimeout(()=>{t(null),a(null),y(!1)},200)},R=async(k,S)=>{t(k),a(S),o(!0);try{const P=await Vu(k);n(P||{})}catch(P){console.error("Failed to load class config",P),n({})}finally{o(!1)}},D=async k=>{if(e){u(!0);try{await saveClassConfig(e,k),v(),await T(),cr.success("Configuration saved")}catch(S){console.error("Failed to save class config",S),cr.error(`Save failed: ${S?.message||""}`)}finally{u(!1)}}},b=k=>c.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-white/60 dark:bg-gray-800/60 p-5 animate-pulse space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"h-6 w-24 bg-gray-200 dark:bg-gray-700 rounded"}),c.jsx("div",{className:"h-5 w-20 bg-gray-200 dark:bg-gray-700 rounded-full"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsx("div",{className:"h-16 bg-gray-100 dark:bg-gray-700/50 rounded-lg"}),c.jsx("div",{className:"h-16 bg-gray-100 dark:bg-gray-700/50 rounded-lg"}),c.jsx("div",{className:"h-16 bg-gray-100 dark:bg-gray-700/50 rounded-lg"})]}),c.jsx("div",{className:"pt-2",children:c.jsx("div",{className:"h-10 w-full bg-gray-200 dark:bg-gray-700 rounded-lg"})})]},`s-${k}`);return c.jsxs("div",{className:"space-y-5",children:[c.jsxs("div",{className:"w-full",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Class Configuration"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Manage exams, subjects, and academic settings for each class"})]}),c.jsx("div",{className:"flex items-center gap-2",children:c.jsx("button",{onClick:T,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",title:"Refresh",children:c.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})})]}),c.jsx("div",{className:"mt-4 border-t border-gray-200 dark:border-gray-700 pt-4",children:c.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm",children:[c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 mr-2"}),c.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Configured"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-500 mr-2"}),c.jsx("span",{className:"text-gray-600 dark:text-gray-300",children:"Needs Setup"})]})]})})]}),x&&c.jsxs("div",{className:"text-sm text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-300 border border-red-200 dark:border-red-800 rounded-md px-3 py-2",children:["Failed to load statuses: ",String(x)]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-6 py-2",children:h?Array.from({length:la.length}).map((k,S)=>b(S)):la.map(k=>{const S=f[k]||{},P=!!S.configured;return c.jsxs("div",{className:"bg-white dark:bg-gray-800 ring-gray-200 dark:ring-gray-700 rounded-xl border border-gray-200 dark:border-gray-700 p-6 space-y-5 hover:shadow-md transition-all duration-200 hover:-translate-y-0.5 w-full",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:k}),c.jsx("span",{className:`text-xs font-medium px-2.5 py-1 rounded-full h-fit ${P?"bg-emerald-100 text-emerald-800 dark:bg-emerald-900/30 dark:text-emerald-300":"bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300"}`,children:P?" Configured":"Needs Setup"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 rounded-lg p-3 space-y-2",children:[c.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-1.5",children:[c.jsx("svg",{className:"w-4 h-4 text-indigo-600 dark:text-indigo-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),c.jsx("span",{children:"Exams & Full Marks"})]}),c.jsx("div",{className:"space-y-2",children:S.exams&&S.exams.length>0?S.exams.map((O,C)=>c.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 dark:bg-gray-700/30 rounded-md",children:[c.jsx("div",{className:"flex-1 min-w-0",children:c.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-200 truncate",children:O})}),c.jsx("div",{className:"ml-2 flex-shrink-0",children:c.jsxs("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",children:[S.fullMarks?.[O]||"N/A"," marks"]})})]},C)):c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 p-2",children:"No exams configured"})})]}),c.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700/30 rounded-lg p-3 space-y-2",children:[c.jsxs("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center gap-1.5",children:[c.jsx("svg",{className:"w-4 h-4 text-purple-600 dark:text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),c.jsx("span",{children:"Subjects"})]}),S.subjects&&S.subjects.length>0?c.jsx("div",{className:"grid grid-cols-2 gap-2",children:S.subjects.map(O=>c.jsx("span",{className:"px-3 py-1.5 text-xs font-medium bg-white dark:bg-gray-600 rounded-md border border-gray-200 dark:border-gray-600 text-gray-700 dark:text-gray-200 truncate text-center",children:O},O))}):c.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"No subjects added"})]})]}),c.jsx("div",{className:"pt-2",children:c.jsxs("button",{onClick:()=>R(k,"exams"),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 text-sm font-medium rounded-lg bg-gradient-to-r from-indigo-600 to-purple-600 text-white hover:from-indigo-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-all duration-200","aria-label":`Configure ${k}`,children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),P?"Edit Configuration":"Setup Configuration"]})})]},k)})}),(e&&r||g)&&c.jsx("div",{children:c.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[c.jsx("div",{className:`absolute inset-0 bg-transparent backdrop-blur-sm transition-opacity duration-200 ${g?"opacity-0":"opacity-100"}`,onClick:v}),c.jsxs("div",{className:`relative z-10 w-full max-w-3xl bg-white dark:bg-gray-800 rounded-xl ring-1 ring-gray-200 dark:ring-gray-700 p-4 md:p-6 transform transition-all duration-200 ease-out ${g?"opacity-0 scale-95 translate-y-2":"opacity-100 scale-100 translate-y-0"}`,children:[c.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:i?c.jsx("div",{className:"py-10 flex items-center justify-center text-sm text-gray-500 dark:text-gray-400",children:"Loading..."}):c.jsx(b5,{selectedClass:e,section:r,initialData:s,onSave:D,onClose:v})}),l&&c.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-gray-900/50 backdrop-blur-sm flex items-center justify-center rounded-xl",children:c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-indigo-600"})})]})]})})]})}const E5=()=>{const[e,t]=L.useState([]),[r,a]=L.useState([]),[s,n]=L.useState(!0),[i,o]=L.useState(!0),[l,u]=L.useState({}),[f,d]=L.useState({}),[h,p]=L.useState({}),[x,m]=L.useState(null),{theme:g}=vn(),y={hidden:{opacity:0,y:20},visible:b=>({opacity:1,y:0,transition:{delay:b*.1,duration:.3}})};L.useEffect(()=>{v(),T()},[]);const T=async()=>{try{o(!0);const{data:b}=await Pe.get("/configs"),k=[...new Set(b.items?.map(S=>S.class).filter(Boolean)||[])];a(k)}catch(b){console.error("Error fetching available classes:",b)}finally{o(!1)}},v=async()=>{try{n(!0);const{data:b}=await Pe.get("/results");console.log("Results data:",b),t(b.items||[])}catch(b){console.error("Error fetching results status:",b)}finally{n(!1)}},R=async(b,k)=>{if(!l[b])try{u(P=>({...P,[b]:!0}));const S=h[b]||"";await Pe.post("/results",{term:b,isPublished:!k,adminPassword:S,publishedAt:new Date().toISOString()}),await v()}catch(S){console.error("Error updating publish status:",S),S.response?.data?.message}finally{u(S=>({...S,[b]:!1})),p(S=>({...S,[b]:""})),d(S=>({...S,[b]:!1}))}},D=(b,k)=>{k.target.tagName==="BUTTON"||k.target.tagName==="INPUT"||k.target.closest("button, input")||m(x===b?null:b)};return s||i?c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"flex flex-col items-center gap-4",children:[c.jsx("div",{className:"w-10 h-10 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin"}),c.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Loading results..."})]})}):c.jsxs("div",{className:"p-4 md:p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Result Publication"}),c.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Publish or unpublish results for each term. Published results will be visible to students."})]}),r.length===0?c.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border-l-4 border-yellow-400 dark:border-yellow-500 p-4 rounded-r-lg",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-yellow-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:"No classes found"}),c.jsx("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:"Please add classes and configure results before publishing."})]})]})}):c.jsx("div",{className:"space-y-4",children:e.map((b,k)=>c.jsxs(ke.div,{custom:k,initial:"hidden",animate:"visible",variants:y,className:`bg-white dark:bg-gray-800 rounded-xl shadow-sm overflow-hidden border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow ${x===b.term?"ring-2 ring-indigo-500/20":""}`,onClick:S=>D(b.term,S),children:[c.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:b.term}),c.jsx("div",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${b.isPublished?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-200":"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-200"}`,children:b.isPublished?"Published":"Not Published"})]}),c.jsxs("div",{className:"mt-2 flex flex-wrap gap-4 text-sm",children:[c.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[c.jsx(Du,{className:"mr-1.5 h-4 w-4 text-gray-400"}),c.jsxs("span",{children:["Last Updated: ",b.stats?.lastUpdated?_5(b.stats.lastUpdated):"N/A"]})]}),b.stats&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[c.jsx(_c,{className:"mr-1.5 h-4 w-4 text-green-500"}),c.jsxs("span",{children:[b.stats.updated||0," Updated"]})]}),c.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[c.jsx(Fc,{className:"mr-1.5 h-4 w-4 text-yellow-500"}),c.jsxs("span",{children:[b.stats.pendingUpdates||0," Pending"]})]}),c.jsxs("div",{className:"flex items-center text-gray-600 dark:text-gray-300",children:[c.jsx("span",{className:"inline-block w-2 h-2 rounded-full bg-blue-500 mr-1.5"}),c.jsxs("span",{children:[b.stats.totalStudents||0," Total"]})]})]})]})]}),c.jsx("button",{className:"ml-4 p-1.5 rounded-full text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700",onClick:S=>{S.stopPropagation(),m(x===b.term?null:b.term)},children:x===b.term?c.jsx(Ou,{className:"h-5 w-5"}):c.jsx(Mu,{className:"h-5 w-5"})})]})}),c.jsx(mr,{children:x===b.term&&c.jsx(ke.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"overflow-hidden",children:c.jsxs("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-700/30",children:[b.stats&&c.jsxs("div",{className:"mt-4 mb-6",children:[c.jsxs("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-300 mb-1",children:[c.jsxs("span",{children:["Progress: ",b.stats.updated||0," / ",b.stats.totalStudents||0]}),c.jsxs("span",{children:[b.stats.completionPercentage||0,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:c.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out",style:{width:`${b.stats.completionPercentage||0}%`}})})]}),b.stats?.perClass&&Object.keys(b.stats.perClass).length>0&&c.jsxs("div",{className:"mt-6",children:[c.jsx("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-3",children:"Class-wise Status"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[c.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800",children:c.jsxs("tr",{children:[c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Class"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Updated"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Pending"}),c.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Total"})]})}),c.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:Object.entries(b.stats.perClass).map(([S,P])=>c.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white",children:S}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 dark:text-green-400",children:P.updated}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-yellow-600 dark:text-yellow-400",children:P.pending}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-300",children:P.total})]},S))})]})})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("div",{className:"relative group",children:[c.jsx("div",{className:"absolute -inset-0.5 bg-gradient-to-r from-indigo-500 to-purple-600 rounded-lg opacity-0 group-hover:opacity-100 blur transition duration-300"}),c.jsxs("div",{className:"relative bg-white dark:bg-gray-800 rounded-lg overflow-hidden border border-gray-200 dark:border-gray-700",children:[c.jsx("div",{className:"flex items-center px-4 py-3",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("label",{htmlFor:`password-${b.term}`,className:"block text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-1",children:"Admin Authentication Required"}),c.jsxs("div",{className:"relative mt-1",children:[c.jsx("input",{type:f[b.term]?"text":"password",id:`password-${b.term}`,className:"block w-full pr-10 py-2 border-0 bg-transparent text-gray-900 dark:text-white placeholder-gray-400 focus:ring-0 sm:text-sm",placeholder:"",value:h[b.term]||"",onChange:S=>p(P=>({...P,[b.term]:S.target.value})),onClick:S=>S.stopPropagation(),autoComplete:"current-password"}),c.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3",children:c.jsx("button",{type:"button",className:"text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400 focus:outline-none",onClick:S=>{S.stopPropagation(),d(P=>({...P,[b.term]:!P[b.term]}))},"aria-label":f[b.term]?"Hide password":"Show password",children:f[b.term]?c.jsx(Iu,{className:"h-5 w-5"}):c.jsx(Lu,{className:"h-5 w-5"})})})]})]})}),c.jsx("div",{className:"px-4 py-2 bg-gray-50 dark:bg-gray-700/50 text-xs text-gray-500 dark:text-gray-400",children:"Administrator privileges required to publish/unpublish results"})]})]})}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("button",{type:"button",onClick:S=>{S.stopPropagation(),R(b.term,b.isPublished)},disabled:l[b.term]||!b.isPublished&&b.stats?.pendingUpdates!==0,className:`w-full flex justify-center items-center py-2.5 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white ${b.isPublished?"bg-red-600 hover:bg-red-700 dark:bg-red-700 dark:hover:bg-red-600 focus:ring-red-500":b.stats?.pendingUpdates===0?"bg-indigo-600 hover:bg-indigo-700 dark:bg-indigo-700 dark:hover:bg-indigo-600 focus:ring-indigo-500":"bg-gray-400 cursor-not-allowed dark:bg-gray-600"} focus:outline-none focus:ring-2 focus:ring-offset-2 dark:focus:ring-offset-gray-800 transition-colors`,children:l[b.term]?c.jsxs(c.Fragment,{children:[c.jsx(b2,{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white"}),"Processing..."]}):b.isPublished?c.jsxs(c.Fragment,{children:[c.jsx(Fc,{className:"-ml-0.5 mr-2 h-4 w-4"}),"Unpublish Results"]}):c.jsxs(c.Fragment,{children:[c.jsx(_c,{className:"-ml-0.5 mr-2 h-4 w-4"}),"Publish Results"]})}),b.publishedAt&&c.jsx("div",{className:"text-center",children:c.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last ",b.isPublished?"published":"unpublished",": ",b.publishedAt?new Date(b.publishedAt).toLocaleString():"Never"]})})]})]})})})]},b.term))})]})},_5=e=>{if(console.log("Formatting date:",e),!e)return"N/A";try{const t=new Date(e);return isNaN(t.getTime())?(console.error("Invalid date string:",e),"N/A"):t.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}catch(t){return console.error("Error formatting date:",t,"Input:",e),"N/A"}},S5=()=>{const{user:e,loading:t}=yn(),r=mn();return t?c.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-indigo-500"})}):e?c.jsx(Ll,{}):c.jsx(si,{to:"/login",state:{from:r.pathname},replace:!0})},A5=()=>{const{theme:e}=vn();return c.jsx("div",{className:`min-h-screen ${e==="dark"?"dark":""}`,children:c.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:c.jsxs(zh,{children:[c.jsx(jt,{index:!0,element:c.jsx(O2,{})}),c.jsx(jt,{path:"/login",element:c.jsx(V2,{})}),c.jsx(jt,{path:"/results",element:c.jsx(jc,{}),children:c.jsx(jt,{path:"term/:term",element:c.jsx(jc,{})})}),c.jsxs(jt,{element:c.jsx(S5,{}),children:[c.jsxs(jt,{path:"/dashboard",element:c.jsx(cv,{children:c.jsx(Ll,{})}),children:[c.jsx(jt,{path:"students",element:c.jsx(v5,{})}),c.jsx(jt,{path:"marks",element:c.jsx(k5,{})}),c.jsx(jt,{path:"config",element:c.jsx(T5,{})}),c.jsx(jt,{path:"results-publish",element:c.jsx(E5,{})})]}),c.jsx(jt,{path:"*",element:c.jsx(si,{to:"/dashboard",replace:!0})})]}),c.jsx(jt,{path:"*",element:c.jsx(si,{to:"/",replace:!0})})]})})})},N5=()=>c.jsx($l,{children:c.jsx(Ax,{children:c.jsx(A5,{})})}),C5=new Tx;Zh.createRoot(document.getElementById("root")).render(c.jsx(fr.StrictMode,{children:c.jsx(_x,{client:C5,children:c.jsxs(Gh,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[c.jsx($l,{children:c.jsx(N5,{})}),c.jsx(Xh,{position:"top-right",autoClose:3e3})]})})}));
//# sourceMappingURL=index-BcMaksMS.js.map
